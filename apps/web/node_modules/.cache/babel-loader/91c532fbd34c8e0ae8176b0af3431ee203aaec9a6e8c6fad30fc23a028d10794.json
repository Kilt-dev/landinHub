{"ast":null,"code":"var _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport { v4 as uuidv4 } from 'uuid';\nimport { useCallback } from 'react';\nimport { getResponsiveValues, syncElementBetweenModes, initializeResponsiveData, autoScaleStyles, autoScaleSize, autoScalePosition, autoScaleComponentData } from './responsiveSync.js';\n\n/**\r\n * Render a single element to HTML\r\n * @param {Object} element - Element object\r\n * @param {boolean} isChild - Whether this is a child element\r\n * @param {string} viewMode - Current view mode (desktop, tablet, mobile)\r\n * @returns {string} - HTML string\r\n */\nconst renderElementHTML = (element, isChild = false, viewMode = 'desktop') => {\n  var _element$responsiveSt, _componentData$icon;\n  // Skip rendering if element is not visible in the current view mode\n  if (element.visible === false) return '';\n  const {\n    id,\n    type,\n    componentData = {},\n    styles = {},\n    size = {},\n    position = {}\n  } = getResponsiveValues(element, viewMode);\n  const responsiveStyles = ((_element$responsiveSt = element.responsiveStyles) === null || _element$responsiveSt === void 0 ? void 0 : _element$responsiveSt[viewMode]) || {};\n  const combinedStyles = {\n    ...styles,\n    ...responsiveStyles\n  };\n\n  // Convert styles object to inline CSS\n  const inlineStyles = Object.entries(combinedStyles).filter(([key]) => !key.startsWith(':') && !key.startsWith('@')).map(([key, value]) => {\n    const kebabKey = key.replace(/[A-Z]/g, m => `-${m.toLowerCase()}`);\n    return `${kebabKey}:${value}`;\n  }).join(';');\n\n  // Base attributes\n  const baseAttrs = `\n        id=\"${id}\"\n        data-element-id=\"${id}\"\n        data-type=\"${type}\"\n        class=\"lpb-element lpb-${type}\"\n    `;\n\n  // Position styles for child elements\n  const positionStyles = isChild ? `\n        position: absolute;\n        left: ${position.x || 0}px;\n        top: ${position.y || 0}px;\n        width: ${size.width || 200}px;\n        height: ${size.height || 50}px;\n    ` : '';\n\n  // Render based on type\n  switch (type) {\n    case 'section':\n      return renderSectionHTML(element, viewMode);\n    case 'button':\n      return `\n                <button \n                    ${baseAttrs}\n                    style=\"${inlineStyles}; ${positionStyles}\"\n                >\n                    ${componentData.content || 'Button'}\n                </button>\n            `;\n    case 'heading':\n      const HeadingTag = componentData.level || 'h2';\n      return `\n                <${HeadingTag} \n                    ${baseAttrs}\n                    style=\"${inlineStyles}; ${positionStyles}\"\n                >\n                    ${componentData.content || 'Heading'}\n                </${HeadingTag}>\n            `;\n    case 'paragraph':\n      return `\n                <p \n                    ${baseAttrs}\n                    style=\"${inlineStyles}; ${positionStyles}\"\n                >\n                    ${componentData.content || 'Paragraph'}\n                </p>\n            `;\n    case 'image':\n      return `\n                <img \n                    ${baseAttrs}\n                    src=\"${componentData.src || componentData.imageUrl || 'https://via.placeholder.com/150'}\"\n                    alt=\"${componentData.alt || 'Image'}\"\n                    style=\"${inlineStyles}; ${positionStyles}\"\n                />\n            `;\n    case 'icon':\n      const isSvg = (_componentData$icon = componentData.icon) === null || _componentData$icon === void 0 ? void 0 : _componentData$icon.startsWith('<svg');\n      return `\n                <div \n                    ${baseAttrs}\n                    style=\"${inlineStyles}; ${positionStyles}\"\n                    title=\"${componentData.title || ''}\"\n                >\n                    ${componentData.imageUrl ? `<img src=\"${componentData.imageUrl}\" alt=\"${componentData.title || 'Icon'}\" style=\"width:100%;height:100%;object-fit:contain;\" />` : isSvg ? componentData.icon : componentData.icon ? `<i class=\"${componentData.icon}\"></i>` : 'üì¶'}\n                </div>\n            `;\n    case 'gallery':\n      return renderGalleryHTML(element, isChild, viewMode);\n    default:\n      return `\n                <div \n                    ${baseAttrs}\n                    style=\"${inlineStyles}; ${positionStyles}\"\n                >\n                    ${componentData.content || type}\n                </div>\n            `;\n  }\n};\n\n/**\r\n * Render gallery element\r\n * @param {Object} element - Gallery element\r\n * @param {boolean} isChild - Whether this is a child element\r\n * @param {string} viewMode - Current view mode\r\n * @returns {string} - HTML string\r\n */\nconst renderGalleryHTML = (element, isChild, viewMode = 'desktop') => {\n  var _element$responsiveSt2;\n  if (element.visible === false) return '';\n  const {\n    id,\n    componentData = {},\n    styles = {},\n    size = {},\n    position = {}\n  } = getResponsiveValues(element, viewMode);\n  const responsiveStyles = ((_element$responsiveSt2 = element.responsiveStyles) === null || _element$responsiveSt2 === void 0 ? void 0 : _element$responsiveSt2[viewMode]) || {};\n  const combinedStyles = {\n    ...styles,\n    ...responsiveStyles\n  };\n  const positionStyles = isChild ? `\n        position: absolute;\n        left: ${position.x || 0}px;\n        top: ${position.y || 0}px;\n    ` : '';\n  const images = componentData.images || [];\n  return `\n        <div \n            id=\"${id}\"\n            data-element-id=\"${id}\"\n            data-type=\"gallery\"\n            class=\"lpb-element lpb-gallery\"\n            style=\"${positionStyles} width: ${size.width || 380}px; height: ${size.height || 300}px;\"\n        >\n            <div style=\"\n                display: ${combinedStyles.display || 'grid'};\n                grid-template-columns: ${combinedStyles.gridTemplateColumns || 'repeat(auto-fill, minmax(150px, 1fr))'};\n                gap: ${combinedStyles.gap || '10px'};\n                width: 100%;\n                height: 100%;\n            \">\n                ${images.map((imageUrl, index) => `\n                    <div style=\"\n                        position: relative;\n                        overflow: hidden;\n                        border-radius: ${combinedStyles.borderRadius || '8px'};\n                        aspect-ratio: 1 / 1;\n                    \">\n                        <img\n                            src=\"${imageUrl || 'https://via.placeholder.com/150'}\"\n                            alt=\"Gallery ${index + 1}\"\n                            style=\"\n                                width: 100%;\n                                height: 100%;\n                                object-fit: ${combinedStyles.objectFit || 'cover'};\n                                object-position: ${combinedStyles.objectPosition || 'center'};\n                            \"\n                            loading=\"lazy\"\n                        />\n                    </div>\n                `).join('')}\n                ${images.length === 0 ? `\n                    <div style=\"\n                        display: flex;\n                        flex-direction: column;\n                        align-items: center;\n                        justify-content: center;\n                        color: #9ca3af;\n                        text-align: center;\n                        grid-column: 1 / -1;\n                    \">\n                        <i class=\"fas fa-image\" style=\"font-size: 48px; margin-bottom: 8px;\"></i>\n                        <p>Empty gallery</p>\n                    </div>\n                ` : ''}\n            </div>\n        </div>\n    `;\n};\n\n/**\r\n * Render section with children\r\n * @param {Object} section - Section element\r\n * @param {string} viewMode - Current view mode\r\n * @returns {string} - HTML string\r\n */\nconst renderSectionHTML = (section, viewMode = 'desktop') => {\n  var _section$responsiveSt;\n  if (section.visible === false) return '';\n  const {\n    id,\n    componentData = {},\n    styles = {},\n    size = {},\n    position = {},\n    children = []\n  } = getResponsiveValues(section, viewMode);\n  const responsiveStyles = ((_section$responsiveSt = section.responsiveStyles) === null || _section$responsiveSt === void 0 ? void 0 : _section$responsiveSt[viewMode]) || {};\n  const combinedStyles = {\n    ...styles,\n    ...responsiveStyles\n  };\n\n  // Render children\n  const childrenHTML = children.filter(child => child.visible !== false).map(child => renderElementHTML(child, true, viewMode)).join('\\n');\n  return `\n        <section \n            id=\"${id}\"\n            data-element-id=\"${id}\"\n            class=\"lpb-section ladi-section\"\n            style=\"\n                position: absolute;\n                top: ${position.y || 0}px;\n                left: 50%;\n                transform: translateX(-50%);\n                width: ${viewMode === 'desktop' ? '1200px' : viewMode === 'tablet' ? '768px' : '375px'};\n                height: ${size.height || 400}px;\n            \"\n        >\n            <!-- Background -->\n            <div class=\"ladi-section-background\" style=\"\n                position: absolute;\n                inset: 0;\n                z-index: 0;\n                background-color: ${componentData.backgroundColor || combinedStyles.backgroundColor || 'transparent'};\n                background-image: ${componentData.backgroundImage ? `url(${componentData.backgroundImage})` : 'none'};\n                background-size: cover;\n                background-position: center;\n            \"></div>\n            \n            <!-- Overlay -->\n            <div class=\"ladi-overlay\" style=\"\n                position: absolute;\n                inset: 0;\n                z-index: 0;\n                background-color: ${componentData.overlayColor || 'transparent'};\n                opacity: ${componentData.overlayOpacity || 0};\n            \"></div>\n            \n            <!-- Container -->\n            <div class=\"ladi-container\" style=\"\n                position: relative;\n                z-index: 1;\n                padding: ${componentData.padding || combinedStyles.padding || '20px'};\n                width: 100%;\n                height: 100%;\n            \">\n                ${childrenHTML}\n            </div>\n        </section>\n    `;\n};\n\n/**\r\n * Render all popups to HTML\r\n * @param {Array} popups - Array of popup elements\r\n * @param {string} viewMode - Current view mode\r\n * @returns {string} - HTML string\r\n */\nconst renderPopupsHTML = (popups, viewMode = 'desktop') => {\n  return popups.filter(popup => popup.visible !== false).map(popup => {\n    var _popup$responsiveStyl;\n    const {\n      id,\n      componentData = {},\n      styles = {},\n      size = {},\n      children = []\n    } = getResponsiveValues(popup, viewMode);\n    const responsiveStyles = ((_popup$responsiveStyl = popup.responsiveStyles) === null || _popup$responsiveStyl === void 0 ? void 0 : _popup$responsiveStyl[viewMode]) || {};\n    const combinedStyles = {\n      ...styles,\n      ...responsiveStyles\n    };\n\n    // Render children content\n    const childrenHTML = children.filter(child => child.visible !== false).map(child => renderElementHTML(child, true, viewMode)).join('');\n    return `\n                <div \n                    id=\"${id}\" \n                    class=\"lpb-popup\" \n                    data-element-id=\"${id}\"\n                    style=\"display:none;\"\n                >\n                    <!-- Overlay -->\n                    <div \n                        class=\"lpb-popup-overlay\" \n                        onclick=\"LPB.popups.close('${id}')\"\n                    ></div>\n                    \n                    <!-- Popup Container -->\n                    <div \n                        class=\"lpb-popup-container\"\n                        style=\"\n                            width: ${size.width || 600}px;\n                            max-width: 90vw;\n                            min-height: ${size.height || 400}px;\n                            background: ${combinedStyles.background || componentData.background || 'rgba(255, 255, 255, 0.95)'};\n                            border-radius: ${combinedStyles.borderRadius || componentData.borderRadius || '12px'};\n                            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.25);\n                        \"\n                    >\n                        <!-- Header -->\n                        <div class=\"lpb-popup-header\">\n                            <h3 style=\"margin:0; font-size:16px; font-weight:600; color:#111827;\">\n                                ${componentData.title || 'Popup Title'}\n                            </h3>\n                            <button \n                                class=\"lpb-popup-close\" \n                                onclick=\"LPB.popups.close('${id}')\"\n                                aria-label=\"Close popup\"\n                            >\n                                ‚úï\n                            </button>\n                        </div>\n                        \n                        <!-- Body -->\n                        <div class=\"lpb-popup-body\" style=\"padding: ${componentData.padding || '20px'};\">\n                            ${childrenHTML || `<p style=\"color:#6b7280;\">${componentData.content || 'Popup content'}</p>`}\n                        </div>\n                    </div>\n                </div>\n            `;\n  }).join('\\n');\n};\n\n/**\r\n * Generate CSS from pageData with responsive support\r\n * @param {Object} pageData - Page data\r\n * @returns {string} - CSS string\r\n */\nconst generateCSS = pageData => {\n  let css = `\n        * {\n            box-sizing: border-box;\n        }\n        \n        body {\n            margin: 0;\n            padding: 0;\n        }\n        \n        .lpb-element {\n            transition: all 0.3s ease;\n        }\n        \n        .lpb-popup {\n            position: fixed;\n            inset: 0;\n            z-index: 9999;\n            display: none;\n            align-items: center;\n            justify-content: center;\n        }\n        \n        .lpb-popup.lpb-popup-active {\n            display: flex;\n        }\n        \n        .lpb-popup-overlay {\n            position: absolute;\n            inset: 0;\n            background: rgba(0, 0, 0, 0.5);\n            cursor: pointer;\n        }\n        \n        .lpb-popup-container {\n            position: relative;\n            z-index: 1;\n            background: white;\n            border-radius: 12px;\n            max-height: 90vh;\n            overflow-y: auto;\n            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);\n        }\n        \n        .lpb-popup-header {\n            display: flex;\n            justify-content: space-between;\n            align-items: center;\n            padding: 16px 20px;\n            border-bottom: 1px solid #e5e7eb;\n            background: linear-gradient(to bottom, #f9fafb, #ffffff);\n        }\n        \n        .lpb-popup-close {\n            width: 28px;\n            height: 28px;\n            border: none;\n            background: transparent;\n            cursor: pointer;\n            border-radius: 6px;\n            display: flex;\n            align-items: center;\n            justify-content: center;\n            transition: all 0.15s ease;\n            color: #6b7280;\n            font-size: 18px;\n            font-weight: bold;\n        }\n        \n        .lpb-popup-close:hover {\n            background: #f3f4f6;\n            color: #111827;\n        }\n        \n        .lpb-popup-body {\n            padding: 20px;\n        }\n        \n        .lpb-spinner {\n            border: 3px solid #f3f3f3;\n            border-top: 3px solid #3b82f6;\n            border-radius: 50%;\n            width: 40px;\n            height: 40px;\n            animation: spin 1s linear infinite;\n            margin: 0 auto;\n        }\n        \n        @keyframes spin {\n            0% { transform: rotate(0deg); }\n            100% { transform: rotate(360deg); }\n        }\n    `;\n\n  // Generate CSS for each element\n  pageData.elements.filter(el => el.visible !== false).forEach(element => {\n    const generateStylesForMode = viewMode => {\n      var _element$responsiveSt3;\n      const {\n        id,\n        styles = {},\n        size = {},\n        position = {}\n      } = getResponsiveValues(element, viewMode);\n      const responsiveStyles = ((_element$responsiveSt3 = element.responsiveStyles) === null || _element$responsiveSt3 === void 0 ? void 0 : _element$responsiveSt3[viewMode]) || {};\n      const combinedStyles = {\n        ...styles,\n        ...responsiveStyles\n      };\n      const styleString = Object.entries(combinedStyles).filter(([key]) => !key.startsWith(':') && !key.startsWith('@')).map(([key, value]) => {\n        const cssKey = key.replace(/([A-Z])/g, '-$1').toLowerCase();\n        return `${cssKey}: ${value};`;\n      }).join(' ');\n      return `\n                    #${id} {\n                        position: absolute;\n                        left: ${position.x || 0}px;\n                        top: ${position.y || 0}px;\n                        width: ${size.width || (element.type === 'section' ? 1200 : 200)}px;\n                        height: ${size.height || (element.type === 'section' ? 400 : 50)}px;\n                        z-index: ${position.z || 1};\n                        ${styleString}\n                    }\n                    ${combinedStyles[':hover'] ? `\n                        #${id}:hover {\n                            ${Object.entries(combinedStyles[':hover']).map(([key, value]) => `${key.replace(/([A-Z])/g, '-$1').toLowerCase()}: ${value};`).join(' ')}\n                        }\n                    ` : ''}\n                    ${combinedStyles['@keyframes'] ? `\n                        @keyframes ${id}-keyframes {\n                            ${Object.entries(combinedStyles['@keyframes']).map(([key, value]) => `${key} { ${Object.entries(value).map(([k, v]) => `${k.replace(/([A-Z])/g, '-$1').toLowerCase()}: ${v};`).join(' ')} }`).join(' ')}\n                        }\n                    ` : ''}\n                `;\n    };\n\n    // Default desktop styles\n    css += generateStylesForMode('desktop');\n\n    // Tablet media query\n    css += `\n                @media (max-width: 768px) {\n                    ${generateStylesForMode('tablet')}\n                    .lpb-section {\n                        width: 100% !important;\n                    }\n                    .lpb-popup-container {\n                        width: 90% !important;\n                        max-width: 90vw !important;\n                    }\n                }\n            `;\n\n    // Mobile media query\n    css += `\n                @media (max-width: 375px) {\n                    ${generateStylesForMode('mobile')}\n                    .lpb-section {\n                        width: 100% !important;\n                    }\n                    .lpb-popup-container {\n                        width: 90% !important;\n                        max-width: 90vw !important;\n                    }\n                }\n            `;\n  });\n  return css;\n};\n\n/**\r\n * Extract all events from pageData elements\r\n * @param {Object} pageData - Page data object\r\n * @returns {Array} - Array of event configs\r\n */\nconst extractEvents = pageData => {\n  const events = [];\n  const processElement = (element, parentId = null) => {\n    var _element$componentDat;\n    const elementId = element.id;\n\n    // Only include events for visible elements\n    if (element.visible === false) return;\n\n    // Check element events\n    if ((_element$componentDat = element.componentData) !== null && _element$componentDat !== void 0 && _element$componentDat.events) {\n      events.push({\n        elementId: elementId,\n        events: element.componentData.events,\n        type: element.type,\n        parentId: parentId\n      });\n    }\n\n    // Check children events\n    if (Array.isArray(element.children)) {\n      element.children.forEach(child => {\n        var _child$componentData;\n        if (child.visible !== false && (_child$componentData = child.componentData) !== null && _child$componentData !== void 0 && _child$componentData.events) {\n          events.push({\n            elementId: child.id,\n            events: child.componentData.events,\n            type: child.type,\n            parentId: elementId\n          });\n        }\n\n        // Recursive for nested children\n        if (Array.isArray(child.children)) {\n          processElement(child, child.id);\n        }\n      });\n    }\n  };\n  pageData.elements.forEach(element => {\n    processElement(element);\n  });\n  return events;\n};\n\n/**\r\n * Generate runtime script to handle events in static HTML\r\n * @param {Array} events - List of events from pageData\r\n * @param {Array} popups - List of popup elements\r\n * @returns {string} - JavaScript code\r\n */\nconst generateEventRuntime = (events, popups) => {\n  return `\n    // Landing Page Builder Runtime v1.1\n    (function() {\n        'use strict';\n        \n        window.LPB = window.LPB || {};\n        \n        // ========== POPUP MANAGER ==========\n        LPB.popups = {\n            active: new Set(),\n            \n            open: function(popupId, data) {\n                const popup = document.getElementById(popupId);\n                if (!popup) {\n                    console.error('[LPB] Popup not found:', popupId);\n                    return;\n                }\n                \n                // Update content if data exists\n                if (data && data.html) {\n                    const content = popup.querySelector('.lpb-popup-body');\n                    if (content) content.innerHTML = data.html;\n                }\n                \n                // Show popup\n                popup.classList.add('lpb-popup-active');\n                document.body.style.overflow = 'hidden';\n                this.active.add(popupId);\n                \n                // Analytics tracking\n                if (window.gtag) {\n                    gtag('event', 'popup_open', {\n                        event_category: 'Engagement',\n                        event_label: popupId\n                    });\n                }\n            },\n            \n            close: function(popupId) {\n                const popup = document.getElementById(popupId);\n                if (popup) {\n                    popup.classList.remove('lpb-popup-active');\n                    this.active.delete(popupId);\n                    \n                    // Restore scroll if no popups remain\n                    if (this.active.size === 0) {\n                        document.body.style.overflow = '';\n                    }\n                }\n            },\n            \n            closeAll: function() {\n                this.active.forEach(id => this.close(id));\n            }\n        };\n        \n        // ========== API MANAGER ==========\n        LPB.api = {\n            cache: new Map(),\n            \n            getCacheKey: function(endpoint, params) {\n                return endpoint + JSON.stringify(params || {});\n            },\n            \n            fetch: async function(endpoint, options = {}) {\n                const cacheKey = this.getCacheKey(endpoint, options.params);\n                \n                // Check cache\n                if (this.cache.has(cacheKey)) {\n                    const cached = this.cache.get(cacheKey);\n                    const now = Date.now();\n                    const TTL = options.ttl || 5 * 60 * 1000; // 5 minutes default\n                    \n                    if (now - cached.timestamp < TTL) {\n                        console.log('[LPB] Cache hit:', endpoint);\n                        return cached.data;\n                    }\n                }\n                \n                // Fetch new data\n                try {\n                    console.log('[LPB] Fetching:', endpoint);\n                    const response = await fetch(endpoint, {\n                        method: options.method || 'GET',\n                        headers: {\n                            'Content-Type': 'application/json',\n                            ...options.headers\n                        },\n                        body: options.data ? JSON.stringify(options.data) : undefined\n                    });\n                    \n                    if (!response.ok) {\n                        throw new Error(\\`HTTP \\${response.status}: \\${response.statusText}\\`);\n                    }\n                    \n                    const data = await response.json();\n                    \n                    // Cache result\n                    this.cache.set(cacheKey, {\n                        data: data,\n                        timestamp: Date.now()\n                    });\n                    \n                    return data;\n                } catch (error) {\n                    console.error('[LPB] API Error:', error);\n                    throw error;\n                }\n            },\n            \n            clearCache: function(endpoint) {\n                if (endpoint) {\n                    for (let key of this.cache.keys()) {\n                        if (key.startsWith(endpoint)) {\n                            this.cache.delete(key);\n                        }\n                    }\n                } else {\n                    this.cache.clear();\n                }\n            }\n        };\n        \n        // ========== EVENT HANDLER ==========\n        LPB.handleEvent = async function(config) {\n            const { type } = config;\n            \n            try {\n                switch(type) {\n                    case 'openPopup':\n                        if (!config.popupId) {\n                            console.error('[LPB] Missing popupId');\n                            return;\n                        }\n                        this.popups.open(config.popupId, config.data);\n                        break;\n                        \n                    case 'closePopup':\n                        const targetPopupId = config.popupId || config.elementId;\n                        if (!targetPopupId) {\n                            console.error('[LPB] Missing popupId');\n                            return;\n                        }\n                        this.popups.close(targetPopupId);\n                        break;\n                        \n                    case 'triggerApi':\n                        if (!config.apiUrl) {\n                            console.error('[LPB] Missing apiUrl');\n                            return;\n                        }\n                        const data = await this.api.fetch(config.apiUrl, {\n                            method: config.method || 'GET',\n                            params: config.params,\n                            data: config.data\n                        });\n                        \n                        // Update target if specified\n                        if (config.updateTarget) {\n                            const target = document.getElementById(config.updateTarget);\n                            if (target && data.html) {\n                                target.innerHTML = data.html;\n                            }\n                        }\n                        break;\n                        \n                    case 'both':\n                        // Open popup immediately with loading\n                        this.popups.open(config.popupId, { \n                            html: '<div style=\"text-align:center;padding:40px;\"><div class=\"lpb-spinner\"></div><p>ƒêang t·∫£i...</p></div>' \n                        });\n                        \n                        // Fetch API in background\n                        const apiData = await this.api.fetch(config.apiUrl, {\n                            method: config.method || 'GET',\n                            params: config.params\n                        });\n                        \n                        // Update popup content\n                        this.popups.open(config.popupId, { html: apiData.html || JSON.stringify(apiData) });\n                        break;\n                        \n                    case 'navigate':\n                        if (!config.url) {\n                            console.error('[LPB] Missing url');\n                            return;\n                        }\n                        if (config.newTab) {\n                            window.open(config.url, '_blank');\n                        } else {\n                            window.location.href = config.url;\n                        }\n                        break;\n                        \n                    case 'scrollToSection':\n                        if (!config.sectionId) {\n                            console.error('[LPB] Missing sectionId');\n                            return;\n                        }\n                        const section = document.querySelector(\\`[data-element-id=\"\\${config.sectionId}\"]\\`);\n                        if (section) {\n                            section.scrollIntoView({ \n                                behavior: config.smooth !== false ? 'smooth' : 'auto',\n                                block: 'start'\n                            });\n                        } else {\n                            console.error('[LPB] Section not found:', config.sectionId);\n                        }\n                        break;\n                        \n                    case 'submitForm':\n                        if (!config.apiUrl) {\n                            console.error('[LPB] Missing apiUrl');\n                            return;\n                        }\n                        console.log('[LPB] Form submit to:', config.apiUrl);\n                        break;\n                        \n                    default:\n                        console.warn('[LPB] Unknown event type:', type);\n                }\n            } catch (error) {\n                console.error('[LPB] Event handling error:', error);\n                alert('C√≥ l·ªói x·∫£y ra: ' + error.message);\n            }\n        };\n        \n        // ========== AUTO-BIND EVENTS ==========\n        const eventsConfig = ${JSON.stringify(events)};\n        \n        function bindEvents() {\n            console.log('[LPB] Initializing events...', eventsConfig.length);\n            \n            eventsConfig.forEach(config => {\n                const element = document.getElementById(config.elementId);\n                if (!element) {\n                    // Silently skip instead of logging warning\n                    return;\n                }\n                \n                // Bind onClick\n                if (config.events.onClick && config.events.onClick.type !== 'none') {\n                    element.addEventListener('click', function(e) {\n                        e.preventDefault();\n                        e.stopPropagation();\n                        LPB.handleEvent(config.events.onClick);\n                    });\n                    \n                    element.style.cursor = 'pointer';\n                }\n                \n                // Bind hover prefetch\n                if (config.events.onClick?.params?.apiConfig?.preload) {\n                    element.addEventListener('mouseenter', function() {\n                        LPB.api.fetch(\n                            config.events.onClick.params.apiConfig.endpoint,\n                            config.events.onClick.params.apiConfig\n                        ).catch(() => {}); // Silent prefetch\n                    }, { once: true });\n                }\n                \n                // Bind onHover effects\n                if (config.events.onHover) {\n                    const hoverClass = config.events.onHover.className;\n                    if (hoverClass) {\n                        element.addEventListener('mouseenter', function() {\n                            this.classList.add(hoverClass);\n                        });\n                        element.addEventListener('mouseleave', function() {\n                            this.classList.remove(hoverClass);\n                        });\n                    }\n                }\n            });\n            \n            console.log('[LPB] Events initialized!');\n        }\n        \n        // Try binding events immediately\n        bindEvents();\n        \n        // Fallback: Bind events on DOMContentLoaded for iframe compatibility\n        if (document.readyState === 'loading') {\n            document.addEventListener('DOMContentLoaded', bindEvents);\n        }\n        \n        // ========== ESC TO CLOSE POPUP ==========\n        document.addEventListener('keydown', function(e) {\n            if (e.key === 'Escape') {\n                LPB.popups.closeAll();\n            }\n        });\n        \n        console.log('[LPB] Runtime loaded');\n    })();\n    `;\n};\n\n/**\r\n * Render entire pageData to static HTML with embedded runtime\r\n * @param {Object} pageData - Page data\r\n * @returns {string} - Complete HTML document\r\n */\nexport const renderStaticHTML = pageData => {\n  var _initializedPageData$, _initializedPageData$2, _initializedPageData$3, _initializedPageData$4;\n  // Initialize responsive data\n  const initializedPageData = initializeResponsiveData(pageData);\n\n  // Extract components\n  const popups = initializedPageData.elements.filter(el => el.type === 'popup' && el.visible !== false);\n  const sections = initializedPageData.elements.filter(el => el.type === 'section' && el.visible !== false);\n  const standaloneElements = initializedPageData.elements.filter(el => el.type !== 'section' && el.type !== 'popup' && el.visible !== false);\n\n  // Generate HTML parts\n  const sectionsHTML = sections.map(section => renderSectionHTML(section, 'desktop')).join('\\n');\n  const popupsHTML = renderPopupsHTML(popups, 'desktop');\n  const standaloneHTML = standaloneElements.map(element => renderElementHTML(element, false, 'desktop')).join('\\n');\n  const cssContent = generateCSS(initializedPageData);\n  const events = extractEvents(initializedPageData);\n  const runtimeScript = generateEventRuntime(events, popups);\n\n  // Embed pageData as JSON\n  const embeddedPageData = JSON.stringify(initializedPageData, null, 2);\n  return `\n        <!DOCTYPE html>\n        <html lang=\"vi\">\n        <head>\n            <meta charset=\"UTF-8\">\n            <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n            <meta name=\"description\" content=\"${((_initializedPageData$ = initializedPageData.meta) === null || _initializedPageData$ === void 0 ? void 0 : _initializedPageData$.description) || 'Landing page generated by LandingHub'}\">\n            <title>${((_initializedPageData$2 = initializedPageData.meta) === null || _initializedPageData$2 === void 0 ? void 0 : _initializedPageData$2.title) || 'Landing Page'}</title>\n            \n            <!-- Font Awesome -->\n            <link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css\" crossorigin=\"anonymous\" referrerpolicy=\"no-referrer\" />\n            \n            <!-- Styles -->\n            <style>\n                ${cssContent}\n            </style>\n        </head>\n        <body style=\"margin: 0; padding: 0; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;\">\n            <!-- Canvas -->\n            <div id=\"lpb-canvas\" style=\"\n                position: relative;\n                min-height: 100vh;\n                background: ${((_initializedPageData$3 = initializedPageData.canvas) === null || _initializedPageData$3 === void 0 ? void 0 : _initializedPageData$3.background) || '#ffffff'};\n            \">\n                ${sectionsHTML}\n                ${standaloneHTML}\n            </div>\n            \n            <!-- Popups -->\n            ${popupsHTML}\n            \n            <!-- Embedded Page Data -->\n            <script type=\"application/json\" id=\"lpb-page-data\">\n                ${embeddedPageData}\n            </script>\n            \n            <!-- Runtime Script -->\n            <script>\n                ${runtimeScript}\n            </script>\n            \n            <!-- Google Analytics (optional) -->\n            ${(_initializedPageData$4 = initializedPageData.analytics) !== null && _initializedPageData$4 !== void 0 && _initializedPageData$4.googleAnalyticsId ? `\n            <script async src=\"https://www.googletagmanager.com/gtag/js?id=${initializedPageData.analytics.googleAnalyticsId}\"></script>\n            <script>\n                window.dataLayer = window.dataLayer || [];\n                function gtag(){dataLayer.push(arguments);}\n                gtag('js', new Date());\n                gtag('config', '${initializedPageData.analytics.googleAnalyticsId}');\n            </script>\n            ` : ''}\n        </body>\n        </html>\n    `;\n};\n\n/**\r\n * Parse HTML string into pageData structure\r\n * @param {string} htmlString - HTML content from S3\r\n * @returns {Object} pageData with structure { canvas, elements, meta }\r\n */\nexport const parseHTMLToPageData = htmlString => {\n  const pageData = {\n    canvas: {\n      width: 1200,\n      height: 'auto',\n      background: '#ffffff'\n    },\n    elements: [],\n    meta: {\n      title: 'Untitled',\n      description: '',\n      keywords: [],\n      created_at: new Date().toISOString(),\n      updated_at: new Date().toISOString()\n    },\n    analytics: {}\n  };\n  try {\n    const parser = new DOMParser();\n    const doc = parser.parseFromString(htmlString, 'text/html');\n\n    // Parse meta\n    const titleEl = doc.querySelector('title');\n    if (titleEl) {\n      pageData.meta.title = titleEl.textContent.trim() || 'Untitled';\n    }\n    const descEl = doc.querySelector('meta[name=\"description\"]');\n    if (descEl) {\n      pageData.meta.description = descEl.getAttribute('content') || '';\n    }\n    const keywordsEl = doc.querySelector('meta[name=\"keywords\"]');\n    if (keywordsEl) {\n      var _keywordsEl$getAttrib;\n      pageData.meta.keywords = ((_keywordsEl$getAttrib = keywordsEl.getAttribute('content')) === null || _keywordsEl$getAttrib === void 0 ? void 0 : _keywordsEl$getAttrib.split(',').map(k => k.trim())) || [];\n    }\n    const analyticsScript = doc.querySelector('script[src*=\"googletagmanager\"]');\n    if (analyticsScript) {\n      const gaId = analyticsScript.src.match(/id=([A-Za-z0-9-_]+)/);\n      if (gaId) {\n        pageData.analytics.googleAnalyticsId = gaId[1];\n      }\n    }\n\n    // Try parsing embedded pageData (priority)\n    const pageDataScript = doc.querySelector('script[type=\"application/json\"][id=\"lpb-page-data\"]');\n    if (pageDataScript) {\n      try {\n        const embeddedData = JSON.parse(pageDataScript.textContent || pageDataScript.innerHTML);\n        console.log('‚úÖ Found embedded pageData in <script id=\"lpb-page-data\">');\n\n        // Validate and normalize embedded pageData\n        if (embeddedData.canvas && Array.isArray(embeddedData.elements) && embeddedData.meta) {\n          pageData.canvas = {\n            width: embeddedData.canvas.width || 1200,\n            height: embeddedData.canvas.height || 'auto',\n            background: embeddedData.canvas.background || '#ffffff'\n          };\n          pageData.elements = normalizeElements(embeddedData.elements);\n          pageData.meta = {\n            title: embeddedData.meta.title || pageData.meta.title,\n            description: embeddedData.meta.description || pageData.meta.description,\n            keywords: embeddedData.meta.keywords || pageData.meta.keywords,\n            created_at: embeddedData.meta.created_at || pageData.meta.created_at,\n            updated_at: embeddedData.meta.updated_at || pageData.meta.updated_at\n          };\n          pageData.analytics = embeddedData.analytics || pageData.analytics;\n          return initializeResponsiveData(pageData); // Ensure responsive data\n        } else {\n          console.warn('‚ö†Ô∏è Embedded pageData kh√¥ng h·ª£p l·ªá, fallback parse HTML');\n        }\n      } catch (parseError) {\n        console.warn('‚ö†Ô∏è Failed to parse embedded pageData JSON:', parseError.message);\n      }\n    }\n\n    // Fallback: Parse HTML structure\n    console.log('üîç Parsing HTML structure...');\n\n    // Parse canvas from #lpb-canvas\n    const canvasEl = doc.getElementById('lpb-canvas');\n    if (canvasEl) {\n      const canvasStyle = canvasEl.style;\n      pageData.canvas = {\n        width: parseInt(canvasStyle.width) || 1200,\n        height: canvasStyle.height || 'auto',\n        background: canvasStyle.background || canvasStyle.backgroundColor || '#ffffff',\n        minHeight: canvasStyle.minHeight || '100vh'\n      };\n    }\n\n    // Parse sections\n    const sections = doc.querySelectorAll('section.lpb-section, section.ladi-section, section[data-element-id]');\n    sections.forEach((sectionEl, index) => {\n      const section = parseSectionElement(sectionEl, index);\n      if (section) {\n        pageData.elements.push(syncElementBetweenModes(section, 'desktop'));\n      }\n    });\n\n    // Parse popups\n    const popups = doc.querySelectorAll('div.lpb-popup, div[data-type=\"popup\"]');\n    popups.forEach((popupEl, index) => {\n      const popup = parsePopupElement(popupEl, index);\n      if (popup) {\n        pageData.elements.push(syncElementBetweenModes(popup, 'desktop'));\n      }\n    });\n\n    // Parse standalone elements\n    const standaloneElements = doc.querySelectorAll('div.lpb-element:not(section):not(.lpb-popup):not(.lpb-child-element), [data-element-id]:not(.lpb-section):not(.lpb-popup)');\n    standaloneElements.forEach((el, index) => {\n      if (!el.closest('section.lpb-section, div.lpb-popup')) {\n        const element = parseStandaloneElement(el, index);\n        if (element) {\n          pageData.elements.push(syncElementBetweenModes(element, 'desktop'));\n        }\n      }\n    });\n\n    // Parse events from runtime script\n    const runtimeScripts = doc.querySelectorAll('script');\n    runtimeScripts.forEach(script => {\n      const content = script.textContent || script.innerHTML;\n      const eventsConfig = extractEventsFromScript(content);\n      if (eventsConfig.length > 0) {\n        mapEventsToElements(pageData.elements, eventsConfig);\n      }\n    });\n\n    // Parse animations and keyframes from <style>\n    const styleElements = doc.querySelectorAll('style');\n    styleElements.forEach(styleEl => {\n      const cssContent = styleEl.textContent || styleEl.innerHTML;\n      const animations = extractAnimationsFromCSS(cssContent);\n      mapAnimationsToElements(pageData.elements, animations);\n    });\n\n    // Calculate canvas height based on elements\n    const maxHeight = Math.max(...pageData.elements.filter(el => el.visible !== false).map(el => {\n      var _el$position, _el$position$desktop, _el$size, _el$size$desktop;\n      const elTop = ((_el$position = el.position) === null || _el$position === void 0 ? void 0 : (_el$position$desktop = _el$position.desktop) === null || _el$position$desktop === void 0 ? void 0 : _el$position$desktop.y) || 0;\n      const elHeight = ((_el$size = el.size) === null || _el$size === void 0 ? void 0 : (_el$size$desktop = _el$size.desktop) === null || _el$size$desktop === void 0 ? void 0 : _el$size$desktop.height) || 400;\n      return elTop + elHeight;\n    }), 1648);\n    pageData.canvas.height = maxHeight;\n    console.log('‚úÖ HTML parsed successfully:', {\n      elementsCount: pageData.elements.length,\n      sections: pageData.elements.filter(el => el.type === 'section').length,\n      popups: pageData.elements.filter(el => el.type === 'popup').length,\n      standalone: pageData.elements.filter(el => el.type !== 'section' && el.type !== 'popup').length\n    });\n    return initializeResponsiveData(pageData);\n  } catch (error) {\n    console.error('‚ùå parseHTMLToPageData error:', error);\n    return pageData; // Fallback default pageData\n  }\n};\n\n/**\r\n * Handle saving pageData to server\r\n * @param {Object} params - Parameters including pageId, navigate, pageData, setIsSaving, toast, api\r\n * @returns {Function} - Callback function for saving\r\n */\nexport const handleSave = params => {\n  _s();\n  const {\n    pageId,\n    navigate,\n    pageData,\n    setIsSaving,\n    toast,\n    api\n  } = params;\n  return useCallback(async () => {\n    if (!pageId) {\n      toast.error('Kh√¥ng t√¨m th·∫•y ID trang.');\n      return;\n    }\n    setIsSaving(true); // Show DogLoader during save\n    try {\n      // Initialize and sync responsive data\n      const initializedPageData = initializeResponsiveData(pageData);\n      const syncedPageData = {\n        ...initializedPageData,\n        elements: initializedPageData.elements.map(element => syncElementBetweenModes(element, 'desktop'))\n      };\n      const htmlContent = renderStaticHTML(syncedPageData);\n      const response = await api.put(`/api/pages/${pageId}`, {\n        html: htmlContent,\n        pageData: syncedPageData\n      });\n      if (response.data.success) {\n        toast.success(`L∆∞u trang th√†nh c√¥ng! (${syncedPageData.elements.length} ph·∫ßn t·ª≠)`);\n        if (!response.data.page.screenshot_url) {\n          toast.warn('·∫¢nh ch·ª•p m√†n h√¨nh ch∆∞a ƒë∆∞·ª£c t·∫°o. ƒêang th·ª≠ t·∫°o l·∫°i...');\n          try {\n            await api.get(`/api/pages/regenerate-screenshots`);\n            toast.success('ƒê√£ y√™u c·∫ßu t·∫°o l·∫°i ·∫£nh ch·ª•p m√†n h√¨nh!');\n          } catch (err) {\n            var _err$response, _err$response$data;\n            console.error('Error regenerating screenshots:', err);\n            toast.error('Kh√¥ng th·ªÉ t·∫°o l·∫°i ·∫£nh ch·ª•p m√†n h√¨nh: ' + (((_err$response = err.response) === null || _err$response === void 0 ? void 0 : (_err$response$data = _err$response.data) === null || _err$response$data === void 0 ? void 0 : _err$response$data.error) || err.message));\n          }\n        }\n        // Navigate back to page list to refresh\n        navigate('/pages');\n      }\n    } catch (error) {\n      var _error$response, _error$response$data, _error$response2;\n      console.error('L·ªói khi l∆∞u trang:', error);\n      toast.error('L·ªói khi l∆∞u trang: ' + (((_error$response = error.response) === null || _error$response === void 0 ? void 0 : (_error$response$data = _error$response.data) === null || _error$response$data === void 0 ? void 0 : _error$response$data.error) || error.message));\n      if (((_error$response2 = error.response) === null || _error$response2 === void 0 ? void 0 : _error$response2.status) === 401) {\n        localStorage.removeItem('token');\n        navigate('/auth');\n      }\n    } finally {\n      setIsSaving(false); // Hide DogLoader\n    }\n  }, [pageId, navigate, pageData, setIsSaving, toast, api]);\n};\n\n/**\r\n * Handle preview of pageData\r\n * @param {Object} params - Parameters including pageData, setPreviewHtml, setShowPreview\r\n * @returns {Function} - Callback function for preview\r\n */\n_s(handleSave, \"epj4qY15NHsef74wNqHIp5fdZmg=\");\nexport const handlePreview = params => {\n  _s2();\n  const {\n    pageData,\n    setPreviewHtml,\n    setShowPreview\n  } = params;\n  return useCallback(() => {\n    try {\n      // Initialize responsive data\n      const initializedPageData = initializeResponsiveData(pageData);\n      // Filter out invalid or missing elements\n      const validPageData = {\n        ...initializedPageData,\n        elements: initializedPageData.elements.filter(el => el.id && el.type && el.visible !== false)\n      };\n      const htmlContent = renderStaticHTML(validPageData);\n      setPreviewHtml(htmlContent);\n      setShowPreview(true);\n    } catch (error) {\n      var _params$toast;\n      console.error('L·ªói khi t·∫°o preview:', error);\n      (_params$toast = params.toast) === null || _params$toast === void 0 ? void 0 : _params$toast.error('L·ªói khi t·∫°o preview: ' + (error.message || 'Kh√¥ng x√°c ƒë·ªãnh'));\n    }\n  }, [pageData, setPreviewHtml, setShowPreview, params.toast]);\n};\n\n/**\r\n * Normalize elements to ensure valid structure\r\n * @param {Array} elements - Array of elements\r\n * @returns {Array} Normalized elements\r\n */\n_s2(handlePreview, \"epj4qY15NHsef74wNqHIp5fdZmg=\");\nconst normalizeElements = elements => {\n  return elements.filter(el => el.id && el.type) // Ensure elements have id and type\n  .map(el => {\n    var _el$position2, _el$position3, _el$position4, _el$position5, _el$position6, _el$size2, _el$size3, _el$size4, _el$responsiveStyles, _el$responsiveStyles2, _el$responsiveStyles3;\n    return {\n      id: el.id || `element-${Date.now()}-${Math.random().toString(36).slice(2)}`,\n      type: el.type || 'section',\n      componentData: el.componentData || {},\n      position: {\n        desktop: ((_el$position2 = el.position) === null || _el$position2 === void 0 ? void 0 : _el$position2.desktop) || {\n          x: 0,\n          y: 0,\n          z: 1\n        },\n        tablet: ((_el$position3 = el.position) === null || _el$position3 === void 0 ? void 0 : _el$position3.tablet) || ((_el$position4 = el.position) === null || _el$position4 === void 0 ? void 0 : _el$position4.desktop) || {\n          x: 0,\n          y: 0,\n          z: 1\n        },\n        mobile: ((_el$position5 = el.position) === null || _el$position5 === void 0 ? void 0 : _el$position5.mobile) || ((_el$position6 = el.position) === null || _el$position6 === void 0 ? void 0 : _el$position6.desktop) || {\n          x: 0,\n          y: 0,\n          z: 1\n        }\n      },\n      size: {\n        desktop: ((_el$size2 = el.size) === null || _el$size2 === void 0 ? void 0 : _el$size2.desktop) || el.size || {\n          width: el.type === 'popup' ? 600 : 1200,\n          height: 400\n        },\n        tablet: ((_el$size3 = el.size) === null || _el$size3 === void 0 ? void 0 : _el$size3.tablet) || autoScaleSize(el, 'desktop', 'tablet'),\n        mobile: ((_el$size4 = el.size) === null || _el$size4 === void 0 ? void 0 : _el$size4.mobile) || autoScaleSize(el, 'desktop', 'mobile')\n      },\n      styles: el.styles || {},\n      responsiveStyles: {\n        desktop: ((_el$responsiveStyles = el.responsiveStyles) === null || _el$responsiveStyles === void 0 ? void 0 : _el$responsiveStyles.desktop) || {},\n        tablet: ((_el$responsiveStyles2 = el.responsiveStyles) === null || _el$responsiveStyles2 === void 0 ? void 0 : _el$responsiveStyles2.tablet) || autoScaleStyles(el.styles, 'desktop', 'tablet'),\n        mobile: ((_el$responsiveStyles3 = el.responsiveStyles) === null || _el$responsiveStyles3 === void 0 ? void 0 : _el$responsiveStyles3.mobile) || autoScaleStyles(el.styles, 'desktop', 'mobile')\n      },\n      children: Array.isArray(el.children) ? normalizeElements(el.children) : [],\n      visible: el.visible !== false,\n      locked: !!el.locked\n    };\n  });\n};\n\n/**\r\n * Parse section element from HTML\r\n * @param {HTMLElement} sectionEl - Section element\r\n * @param {number} index - Index of section\r\n * @returns {Object|null} Section object\r\n */\nconst parseSectionElement = (sectionEl, index) => {\n  var _style$top, _style$width, _style$height;\n  const id = sectionEl.id || sectionEl.getAttribute('data-element-id') || `section-${Date.now()}-${index}`;\n  const style = sectionEl.style;\n  const topMatch = ((_style$top = style.top) === null || _style$top === void 0 ? void 0 : _style$top.match(/(\\d+)px/)) || ['0'];\n  const top = parseInt(topMatch[1]) || 0;\n  const widthMatch = ((_style$width = style.width) === null || _style$width === void 0 ? void 0 : _style$width.match(/(\\d+)px/)) || ['1200'];\n  const heightMatch = ((_style$height = style.height) === null || _style$height === void 0 ? void 0 : _style$height.match(/(\\d+)px/)) || ['400'];\n  const width = parseInt(widthMatch[1]) || 1200;\n  const height = parseInt(heightMatch[1]) || 400;\n  const bgEl = sectionEl.querySelector('.ladi-section-background');\n  const overlayEl = sectionEl.querySelector('.ladi-overlay');\n  const containerEl = sectionEl.querySelector('.ladi-container');\n  const componentData = {\n    structure: sectionEl.classList.contains('ladi-section') ? 'ladi-standard' : 'standard'\n  };\n  if (bgEl) {\n    var _bgStyle$backgroundIm;\n    const bgStyle = bgEl.style;\n    componentData.backgroundColor = bgStyle.backgroundColor || 'transparent';\n    const bgImageMatch = (_bgStyle$backgroundIm = bgStyle.backgroundImage) === null || _bgStyle$backgroundIm === void 0 ? void 0 : _bgStyle$backgroundIm.match(/url\\(['\"]?(.+?)['\"]?\\)/);\n    if (bgImageMatch) {\n      componentData.backgroundImage = bgImageMatch[1];\n      componentData.backgroundType = 'image';\n    } else if (componentData.backgroundColor !== 'transparent') {\n      componentData.backgroundType = 'color';\n    }\n    componentData.backgroundPosition = bgStyle.backgroundPosition || 'center';\n    componentData.backgroundSize = bgStyle.backgroundSize || 'cover';\n  }\n  if (overlayEl) {\n    componentData.overlayColor = overlayEl.style.backgroundColor || 'transparent';\n    componentData.overlayOpacity = parseFloat(overlayEl.style.opacity) || 0;\n  }\n  const styles = parseInlineStyles(style, sectionEl);\n  if (containerEl) {\n    componentData.padding = containerEl.style.padding || '20px';\n  }\n  const children = [];\n  if (containerEl) {\n    const childElements = containerEl.querySelectorAll('.lpb-element[data-element-id], .lpb-child-element');\n    childElements.forEach(childEl => {\n      if (childEl.closest('.ladi-container') === containerEl) {\n        const child = parseChildElement(childEl, id);\n        if (child) {\n          children.push(child);\n        }\n      }\n    });\n  }\n  return {\n    id,\n    type: 'section',\n    componentData,\n    position: {\n      desktop: {\n        x: 0,\n        y: top,\n        z: parseInt(style.zIndex) || index + 1\n      },\n      tablet: autoScalePosition({\n        position: {\n          desktop: {\n            x: 0,\n            y: top,\n            z: parseInt(style.zIndex) || index + 1\n          }\n        }\n      }, 'desktop', 'tablet', {\n        width,\n        height\n      }),\n      mobile: autoScalePosition({\n        position: {\n          desktop: {\n            x: 0,\n            y: top,\n            z: parseInt(style.zIndex) || index + 1\n          }\n        }\n      }, 'desktop', 'mobile', {\n        width,\n        height\n      })\n    },\n    size: {\n      desktop: {\n        width,\n        height\n      },\n      tablet: autoScaleSize({\n        size: {\n          desktop: {\n            width,\n            height\n          }\n        }\n      }, 'desktop', 'tablet'),\n      mobile: autoScaleSize({\n        size: {\n          desktop: {\n            width,\n            height\n          }\n        }\n      }, 'desktop', 'mobile')\n    },\n    styles,\n    responsiveStyles: {\n      desktop: {},\n      tablet: autoScaleStyles(styles, 'desktop', 'tablet'),\n      mobile: autoScaleStyles(styles, 'desktop', 'mobile')\n    },\n    children,\n    visible: style.display !== 'none',\n    locked: sectionEl.classList.contains('lpb-element-locked')\n  };\n};\n\n/**\r\n * Parse popup element from HTML\r\n * @param {HTMLElement} popupEl - Popup element\r\n * @param {number} index - Index of popup\r\n * @returns {Object|null} Popup object\r\n */\nconst parsePopupElement = (popupEl, index) => {\n  var _containerEl$style$wi, _containerEl$style$mi;\n  const id = popupEl.id || popupEl.getAttribute('data-element-id') || `popup-${Date.now()}-${index}`;\n  const containerEl = popupEl.querySelector('.lpb-popup-container');\n  if (!containerEl) return null;\n  const widthMatch = ((_containerEl$style$wi = containerEl.style.width) === null || _containerEl$style$wi === void 0 ? void 0 : _containerEl$style$wi.match(/(\\d+)px/)) || ['600'];\n  const minHeightMatch = ((_containerEl$style$mi = containerEl.style.minHeight) === null || _containerEl$style$mi === void 0 ? void 0 : _containerEl$style$mi.match(/(\\d+)px/)) || ['400'];\n  const width = parseInt(widthMatch[1]) || 600;\n  const height = parseInt(minHeightMatch[1]) || 400;\n  const headerEl = popupEl.querySelector('.lpb-popup-header h3');\n  const bodyEl = popupEl.querySelector('.lpb-popup-body');\n  const componentData = {\n    title: (headerEl === null || headerEl === void 0 ? void 0 : headerEl.textContent.trim()) || 'Popup',\n    background: containerEl.style.background || 'rgba(255, 255, 255, 0.95)',\n    borderRadius: containerEl.style.borderRadius || '12px',\n    padding: (bodyEl === null || bodyEl === void 0 ? void 0 : bodyEl.style.padding) || '20px'\n  };\n  const styles = parseInlineStyles(containerEl.style, popupEl);\n  const children = [];\n  if (bodyEl) {\n    const childElements = bodyEl.querySelectorAll('.lpb-element[data-element-id], .lpb-child-element');\n    childElements.forEach(childEl => {\n      if (childEl.closest('.lpb-popup-body') === bodyEl) {\n        const child = parseChildElement(childEl, id);\n        if (child) {\n          children.push(child);\n        }\n      }\n    });\n  }\n  return {\n    id,\n    type: 'popup',\n    componentData,\n    position: {\n      desktop: {\n        x: 0,\n        y: 0,\n        z: parseInt(containerEl.style.zIndex) || 1001\n      },\n      tablet: {\n        x: 0,\n        y: 0,\n        z: parseInt(containerEl.style.zIndex) || 1001\n      },\n      mobile: {\n        x: 0,\n        y: 0,\n        z: parseInt(containerEl.style.zIndex) || 1001\n      }\n    },\n    size: {\n      desktop: {\n        width,\n        height\n      },\n      tablet: autoScaleSize({\n        size: {\n          desktop: {\n            width,\n            height\n          }\n        }\n      }, 'desktop', 'tablet'),\n      mobile: autoScaleSize({\n        size: {\n          desktop: {\n            width,\n            height\n          }\n        }\n      }, 'desktop', 'mobile')\n    },\n    styles,\n    responsiveStyles: {\n      desktop: {},\n      tablet: autoScaleStyles(styles, 'desktop', 'tablet'),\n      mobile: autoScaleStyles(styles, 'desktop', 'mobile')\n    },\n    children,\n    visible: popupEl.classList.contains('lpb-popup-active') || popupEl.style.display !== 'none',\n    locked: popupEl.classList.contains('lpb-element-locked')\n  };\n};\n\n/**\r\n * Parse standalone element from HTML\r\n * @param {HTMLElement} element - Standalone element\r\n * @param {number} index - Index of element\r\n * @returns {Object|null} Element object\r\n */\nconst parseStandaloneElement = (element, index) => {\n  var _style$left, _style$top2, _style$width2, _style$height2;\n  const id = element.id || element.getAttribute('data-element-id') || `element-${Date.now()}-${index}`;\n  const type = element.getAttribute('data-type') || inferTypeFromElement(element);\n  const style = element.style;\n  const leftMatch = ((_style$left = style.left) === null || _style$left === void 0 ? void 0 : _style$left.match(/(\\d+)px/)) || ['0'];\n  const topMatch = ((_style$top2 = style.top) === null || _style$top2 === void 0 ? void 0 : _style$top2.match(/(\\d+)px/)) || ['0'];\n  const widthMatch = ((_style$width2 = style.width) === null || _style$width2 === void 0 ? void 0 : _style$width2.match(/(\\d+)px/)) || [type === 'gallery' ? '380' : '200'];\n  const heightMatch = ((_style$height2 = style.height) === null || _style$height2 === void 0 ? void 0 : _style$height2.match(/(\\d+)px/)) || [type === 'gallery' ? '300' : '50'];\n  const left = parseInt(leftMatch[1]) || 0;\n  const top = parseInt(topMatch[1]) || 0;\n  const width = parseInt(widthMatch[1]) || (type === 'gallery' ? 380 : type === 'icon' ? 50 : 200);\n  const height = parseInt(heightMatch[1]) || (type === 'gallery' ? 300 : type === 'icon' ? 50 : 50);\n  const styles = parseInlineStyles(style, element);\n  const componentData = parseComponentData(element, type);\n  return {\n    id,\n    type,\n    componentData,\n    position: {\n      desktop: {\n        x: left,\n        y: top,\n        z: parseInt(style.zIndex) || index + 1\n      },\n      tablet: autoScalePosition({\n        position: {\n          desktop: {\n            x: left,\n            y: top,\n            z: parseInt(style.zIndex) || index + 1\n          }\n        }\n      }, 'desktop', 'tablet', {\n        width,\n        height\n      }),\n      mobile: autoScalePosition({\n        position: {\n          desktop: {\n            x: left,\n            y: top,\n            z: parseInt(style.zIndex) || index + 1\n          }\n        }\n      }, 'desktop', 'mobile', {\n        width,\n        height\n      })\n    },\n    size: {\n      desktop: {\n        width,\n        height\n      },\n      tablet: autoScaleSize({\n        size: {\n          desktop: {\n            width,\n            height\n          }\n        }\n      }, 'desktop', 'tablet'),\n      mobile: autoScaleSize({\n        size: {\n          desktop: {\n            width,\n            height\n          }\n        }\n      }, 'desktop', 'mobile')\n    },\n    styles,\n    responsiveStyles: {\n      desktop: {},\n      tablet: autoScaleStyles(styles, 'desktop', 'tablet'),\n      mobile: autoScaleStyles(styles, 'desktop', 'mobile')\n    },\n    children: [],\n    visible: style.display !== 'none',\n    locked: element.classList.contains('lpb-element-locked')\n  };\n};\n\n/**\r\n * Parse child element from HTML\r\n * @param {HTMLElement} element - Child element\r\n * @param {string} parentId - ID of parent (section/popup)\r\n * @returns {Object|null} Child element object\r\n */\nconst parseChildElement = (element, parentId) => {\n  var _style$left2, _style$top3, _style$width3, _style$height3;\n  const id = element.id || element.getAttribute('data-element-id') || `child-${Date.now()}-${Math.random().toString(36).slice(2)}`;\n  const type = element.getAttribute('data-type') || inferTypeFromElement(element);\n  const style = element.style;\n  const leftMatch = ((_style$left2 = style.left) === null || _style$left2 === void 0 ? void 0 : _style$left2.match(/(\\d+)px/)) || ['0'];\n  const topMatch = ((_style$top3 = style.top) === null || _style$top3 === void 0 ? void 0 : _style$top3.match(/(\\d+)px/)) || ['0'];\n  const widthMatch = ((_style$width3 = style.width) === null || _style$width3 === void 0 ? void 0 : _style$width3.match(/(\\d+)px/)) || [type === 'gallery' ? '380' : '200'];\n  const heightMatch = ((_style$height3 = style.height) === null || _style$height3 === void 0 ? void 0 : _style$height3.match(/(\\d+)px/)) || [type === 'gallery' ? '300' : '50'];\n  const left = parseInt(leftMatch[1]) || 0;\n  const top = parseInt(topMatch[1]) || 0;\n  const width = parseInt(widthMatch[1]) || (type === 'gallery' ? 380 : type === 'icon' ? 50 : 200);\n  const height = parseInt(heightMatch[1]) || (type === 'gallery' ? 300 : type === 'icon' ? 50 : 50);\n  const styles = parseInlineStyles(style, element);\n  const componentData = parseComponentData(element, type);\n  return {\n    id,\n    type,\n    componentData,\n    position: {\n      desktop: {\n        x: left,\n        y: top,\n        z: parseInt(style.zIndex) || 10\n      },\n      tablet: autoScalePosition({\n        position: {\n          desktop: {\n            x: left,\n            y: top,\n            z: parseInt(style.zIndex) || 10\n          }\n        }\n      }, 'desktop', 'tablet', {\n        width,\n        height\n      }),\n      mobile: autoScalePosition({\n        position: {\n          desktop: {\n            x: left,\n            y: top,\n            z: parseInt(style.zIndex) || 10\n          }\n        }\n      }, 'desktop', 'mobile', {\n        width,\n        height\n      })\n    },\n    size: {\n      desktop: {\n        width,\n        height\n      },\n      tablet: autoScaleSize({\n        size: {\n          desktop: {\n            width,\n            height\n          }\n        }\n      }, 'desktop', 'tablet'),\n      mobile: autoScaleSize({\n        size: {\n          desktop: {\n            width,\n            height\n          }\n        }\n      }, 'desktop', 'mobile')\n    },\n    styles,\n    responsiveStyles: {\n      desktop: {},\n      tablet: autoScaleStyles(styles, 'desktop', 'tablet'),\n      mobile: autoScaleStyles(styles, 'desktop', 'mobile')\n    },\n    children: [],\n    visible: style.display !== 'none',\n    locked: element.classList.contains('lpb-element-locked'),\n    parentId\n  };\n};\n\n/**\r\n * Parse componentData based on type\r\n * @param {HTMLElement} element - Element\r\n * @param {string} type - Type of element\r\n * @returns {Object} componentData\r\n */\nconst parseComponentData = (element, type) => {\n  const componentData = {};\n  switch (type) {\n    case 'button':\n      componentData.content = element.textContent.trim() || 'Button';\n      componentData.background = element.style.background || element.style.backgroundColor;\n      componentData.color = element.style.color;\n      componentData.borderRadius = element.style.borderRadius;\n      componentData.border = element.style.border;\n      componentData.fontSize = element.style.fontSize;\n      componentData.fontWeight = element.style.fontWeight;\n      break;\n    case 'heading':\n      componentData.content = element.textContent.trim() || 'Heading';\n      componentData.level = element.tagName.toLowerCase();\n      componentData.fontSize = element.style.fontSize;\n      componentData.color = element.style.color;\n      componentData.fontWeight = element.style.fontWeight;\n      componentData.textAlign = element.style.textAlign;\n      break;\n    case 'paragraph':\n      componentData.content = element.textContent.trim() || 'Paragraph';\n      componentData.fontSize = element.style.fontSize;\n      componentData.color = element.style.color;\n      componentData.fontWeight = element.style.fontWeight;\n      componentData.lineHeight = element.style.lineHeight;\n      componentData.textAlign = element.style.textAlign;\n      break;\n    case 'image':\n      componentData.src = element.getAttribute('src') || 'https://via.placeholder.com/150';\n      componentData.alt = element.getAttribute('alt') || 'Image';\n      componentData.imageUrl = componentData.src;\n      break;\n    case 'icon':\n      const img = element.querySelector('img');\n      const iconEl = element.querySelector('i');\n      const svgEl = element.querySelector('svg');\n      if (img) {\n        componentData.imageUrl = img.getAttribute('src');\n        componentData.alt = img.getAttribute('alt') || 'Icon';\n      } else if (svgEl) {\n        componentData.icon = svgEl.outerHTML;\n      } else if (iconEl) {\n        componentData.icon = iconEl.className;\n      }\n      componentData.title = element.getAttribute('title') || '';\n      break;\n    case 'gallery':\n      const images = Array.from(element.querySelectorAll('img')).map(img => img.getAttribute('src') || 'https://via.placeholder.com/150');\n      componentData.images = images;\n      componentData.display = element.style.display || 'grid';\n      componentData.gridTemplateColumns = element.style.gridTemplateColumns || 'repeat(auto-fill, minmax(150px, 1fr))';\n      componentData.gap = element.style.gap || '10px';\n      break;\n    default:\n      componentData.content = element.textContent.trim() || '';\n      break;\n  }\n\n  // Parse animation if present\n  if (element.style.animation) {\n    const animationMatch = element.style.animation.match(/(\\S+)\\s*(\\d+\\.?\\d*ms)\\s*(\\w+)\\s*(\\d+\\.?\\d*ms)?\\s*(infinite)?/);\n    if (animationMatch) {\n      componentData.animation = {\n        type: animationMatch[1],\n        duration: parseFloat(animationMatch[2]) || 1000,\n        timing: animationMatch[3] || 'ease',\n        delay: parseFloat(animationMatch[4]) || 0,\n        repeat: !!animationMatch[5]\n      };\n    }\n  }\n  return componentData;\n};\n\n/**\r\n * Parse inline styles and pseudo-classes from element\r\n * @param {CSSStyleDeclaration} styleObj - Style object\r\n * @param {HTMLElement} element - HTML element\r\n * @returns {Object} styles\r\n */\nconst parseInlineStyles = (styleObj, element) => {\n  const styles = {};\n  const importantProps = ['background', 'backgroundColor', 'backgroundImage', 'backgroundSize', 'backgroundPosition', 'color', 'fontSize', 'fontWeight', 'fontFamily', 'border', 'borderRadius', 'boxShadow', 'textShadow', 'padding', 'margin', 'paddingTop', 'paddingRight', 'paddingBottom', 'paddingLeft', 'marginTop', 'marginRight', 'marginBottom', 'marginLeft', 'display', 'alignItems', 'justifyContent', 'flexDirection', 'gap', 'gridTemplateColumns', 'gridTemplateRows', 'gridGap', 'textAlign', 'lineHeight', 'textTransform', 'cursor', 'transition', 'animation', 'filter', 'zIndex', 'opacity', 'transform', 'transformOrigin', 'width', 'height', 'minWidth', 'minHeight', 'maxWidth', 'maxHeight'];\n  importantProps.forEach(prop => {\n    if (styleObj[prop]) {\n      styles[prop] = styleObj[prop];\n    }\n  });\n\n  // Parse pseudo-classes from <style> related to element\n  const styleElements = element.ownerDocument.querySelectorAll('style');\n  styleElements.forEach(styleEl => {\n    const cssContent = styleEl.textContent || styleEl.innerHTML;\n    const hoverRegex = new RegExp(`#${element.id}:hover\\\\s*{([\\\\s\\\\S]*?)}`);\n    const hoverMatch = cssContent.match(hoverRegex);\n    if (hoverMatch) {\n      const hoverStyles = {};\n      hoverMatch[1].split(';').forEach(rule => {\n        const [key, value] = rule.split(':').map(s => s.trim());\n        if (key && value) {\n          const camelKey = key.replace(/-([a-z])/g, (_, letter) => letter.toUpperCase());\n          hoverStyles[camelKey] = value;\n        }\n      });\n      if (Object.keys(hoverStyles).length > 0) {\n        styles[':hover'] = hoverStyles;\n      }\n    }\n  });\n  return styles;\n};\n\n/**\r\n * Extract events from runtime script\r\n * @param {string} scriptContent - Script content\r\n * @returns {Array} Array of event configs\r\n */\nconst extractEventsFromScript = scriptContent => {\n  const eventsMatch = scriptContent.match(/const eventsConfig = (\\[[\\s\\S]*?\\]);/);\n  if (eventsMatch) {\n    try {\n      return JSON.parse(eventsMatch[1]);\n    } catch (e) {\n      console.warn('‚ö†Ô∏è Cannot parse events config:', e.message);\n      return [];\n    }\n  }\n  return [];\n};\n\n/**\r\n * Map events to elements\r\n * @param {Array} elements - Array of elements\r\n * @param {Array} eventsConfig - Array of event configs\r\n */\nconst mapEventsToElements = (elements, eventsConfig) => {\n  eventsConfig.forEach(eventConfig => {\n    const element = findElementById(elements, eventConfig.elementId);\n    if (element) {\n      if (!element.componentData) {\n        element.componentData = {};\n      }\n      element.componentData.events = eventConfig.events || {};\n    }\n  });\n};\n\n/**\r\n * Extract animations from CSS\r\n * @param {string} cssContent - CSS content\r\n * @returns {Object} Animations object\r\n */\nconst extractAnimationsFromCSS = cssContent => {\n  const animations = {};\n  const keyframesRegex = /@keyframes\\s+(\\S+)\\s*{([\\s\\S]*?)}/g;\n  let match;\n  while (match = keyframesRegex.exec(cssContent)) {\n    const keyframeName = match[1];\n    const framesContent = match[2];\n    const frames = {};\n    const frameRegex = /(\\d+%|from|to)\\s*{([\\s\\S]*?)}/g;\n    let frameMatch;\n    while (frameMatch = frameRegex.exec(framesContent)) {\n      const frameKey = frameMatch[1];\n      const props = {};\n      frameMatch[2].split(';').forEach(rule => {\n        const [key, value] = rule.split(':').map(s => s.trim());\n        if (key && value) {\n          const camelKey = key.replace(/-([a-z])/g, (_, letter) => letter.toUpperCase());\n          props[camelKey] = value;\n        }\n      });\n      frames[frameKey] = props;\n    }\n    animations[`@keyframes ${keyframeName}`] = frames;\n  }\n  return animations;\n};\n\n/**\r\n * Map animations to elements\r\n * @param {Array} elements - Array of elements\r\n * @param {Object} animations - Animations object\r\n */\nconst mapAnimationsToElements = (elements, animations) => {\n  elements.forEach(element => {\n    var _element$styles, _element$children;\n    if ((_element$styles = element.styles) !== null && _element$styles !== void 0 && _element$styles.animation) {\n      const animationMatch = element.styles.animation.match(/(\\S+)\\s*(\\d+\\.?\\d*ms)\\s*(\\w+)\\s*(\\d+\\.?\\d*ms)?\\s*(infinite)?/);\n      if (animationMatch) {\n        element.componentData.animation = {\n          type: animationMatch[1],\n          duration: parseFloat(animationMatch[2]) || 1000,\n          timing: animationMatch[3] || 'ease',\n          delay: parseFloat(animationMatch[4]) || 0,\n          repeat: !!animationMatch[5]\n        };\n      }\n    }\n    if (element.styles && animations[`@keyframes ${element.styles.animationName}`]) {\n      element.styles[`@keyframes ${element.styles.animationName}`] = animations[`@keyframes ${element.styles.animationName}`];\n    }\n    if (((_element$children = element.children) === null || _element$children === void 0 ? void 0 : _element$children.length) > 0) {\n      mapAnimationsToElements(element.children, animations);\n    }\n  });\n};\n\n/**\r\n * Find element by ID\r\n * @param {Array} elements - Array of elements\r\n * @param {string} id - Element ID\r\n * @returns {Object|null} Element object\r\n */\nconst findElementById = (elements, id) => {\n  for (const element of elements) {\n    if (element.id === id) return element;\n    if (element.children && element.children.length > 0) {\n      const found = findElementById(element.children, id);\n      if (found) return found;\n    }\n  }\n  return null;\n};\n\n/**\r\n * Infer type from HTML element\r\n * @param {HTMLElement} element - HTML element\r\n * @returns {string} Element type\r\n */\nconst inferTypeFromElement = element => {\n  const tagName = element.tagName.toLowerCase();\n  const classList = element.classList;\n  if (classList.contains('lpb-button') || tagName === 'button') return 'button';\n  if (classList.contains('lpb-icon')) return 'icon';\n  if (classList.contains('lpb-gallery')) return 'gallery';\n  if (classList.contains('lpb-section') || classList.contains('ladi-section')) return 'section';\n  if (classList.contains('lpb-popup')) return 'popup';\n  if (tagName.match(/^h[1-6]$/)) return 'heading';\n  if (tagName === 'p') return 'paragraph';\n  if (tagName === 'img') return 'image';\n  if (tagName === 'hr') return 'divider';\n  if (tagName === 'form') return 'form';\n  if (tagName === 'ul' || tagName === 'ol') return 'list';\n  return 'container';\n};\nexport default {\n  renderStaticHTML,\n  parseHTMLToPageData,\n  handleSave,\n  handlePreview,\n  renderElementHTML,\n  renderPopupsHTML,\n  renderSectionHTML,\n  renderGalleryHTML,\n  generateCSS,\n  extractEvents,\n  generateEventRuntime,\n  normalizeElements,\n  parseSectionElement,\n  parsePopupElement,\n  parseStandaloneElement,\n  parseChildElement,\n  parseComponentData,\n  parseInlineStyles,\n  extractEventsFromScript,\n  mapEventsToElements,\n  extractAnimationsFromCSS,\n  mapAnimationsToElements,\n  findElementById,\n  inferTypeFromElement\n};","map":{"version":3,"names":["v4","uuidv4","useCallback","getResponsiveValues","syncElementBetweenModes","initializeResponsiveData","autoScaleStyles","autoScaleSize","autoScalePosition","autoScaleComponentData","renderElementHTML","element","isChild","viewMode","_element$responsiveSt","_componentData$icon","visible","id","type","componentData","styles","size","position","responsiveStyles","combinedStyles","inlineStyles","Object","entries","filter","key","startsWith","map","value","kebabKey","replace","m","toLowerCase","join","baseAttrs","positionStyles","x","y","width","height","renderSectionHTML","content","HeadingTag","level","src","imageUrl","alt","isSvg","icon","title","renderGalleryHTML","_element$responsiveSt2","images","display","gridTemplateColumns","gap","index","borderRadius","objectFit","objectPosition","length","section","_section$responsiveSt","children","childrenHTML","child","backgroundColor","backgroundImage","overlayColor","overlayOpacity","padding","renderPopupsHTML","popups","popup","_popup$responsiveStyl","background","generateCSS","pageData","css","elements","el","forEach","generateStylesForMode","_element$responsiveSt3","styleString","cssKey","z","k","v","extractEvents","events","processElement","parentId","_element$componentDat","elementId","push","Array","isArray","_child$componentData","generateEventRuntime","JSON","stringify","renderStaticHTML","_initializedPageData$","_initializedPageData$2","_initializedPageData$3","_initializedPageData$4","initializedPageData","sections","standaloneElements","sectionsHTML","popupsHTML","standaloneHTML","cssContent","runtimeScript","embeddedPageData","meta","description","canvas","analytics","googleAnalyticsId","parseHTMLToPageData","htmlString","keywords","created_at","Date","toISOString","updated_at","parser","DOMParser","doc","parseFromString","titleEl","querySelector","textContent","trim","descEl","getAttribute","keywordsEl","_keywordsEl$getAttrib","split","analyticsScript","gaId","match","pageDataScript","embeddedData","parse","innerHTML","console","log","normalizeElements","warn","parseError","message","canvasEl","getElementById","canvasStyle","style","parseInt","minHeight","querySelectorAll","sectionEl","parseSectionElement","popupEl","parsePopupElement","closest","parseStandaloneElement","runtimeScripts","script","eventsConfig","extractEventsFromScript","mapEventsToElements","styleElements","styleEl","animations","extractAnimationsFromCSS","mapAnimationsToElements","maxHeight","Math","max","_el$position","_el$position$desktop","_el$size","_el$size$desktop","elTop","desktop","elHeight","elementsCount","standalone","error","handleSave","params","_s","pageId","navigate","setIsSaving","toast","api","syncedPageData","htmlContent","response","put","html","data","success","page","screenshot_url","get","err","_err$response","_err$response$data","_error$response","_error$response$data","_error$response2","status","localStorage","removeItem","handlePreview","_s2","setPreviewHtml","setShowPreview","validPageData","_params$toast","_el$position2","_el$position3","_el$position4","_el$position5","_el$position6","_el$size2","_el$size3","_el$size4","_el$responsiveStyles","_el$responsiveStyles2","_el$responsiveStyles3","now","random","toString","slice","tablet","mobile","locked","_style$top","_style$width","_style$height","topMatch","top","widthMatch","heightMatch","bgEl","overlayEl","containerEl","structure","classList","contains","_bgStyle$backgroundIm","bgStyle","bgImageMatch","backgroundType","backgroundPosition","backgroundSize","parseFloat","opacity","parseInlineStyles","childElements","childEl","parseChildElement","zIndex","_containerEl$style$wi","_containerEl$style$mi","minHeightMatch","headerEl","bodyEl","_style$left","_style$top2","_style$width2","_style$height2","inferTypeFromElement","leftMatch","left","parseComponentData","_style$left2","_style$top3","_style$width3","_style$height3","color","border","fontSize","fontWeight","tagName","textAlign","lineHeight","img","iconEl","svgEl","outerHTML","className","from","animation","animationMatch","duration","timing","delay","repeat","styleObj","importantProps","prop","ownerDocument","hoverRegex","RegExp","hoverMatch","hoverStyles","rule","s","camelKey","_","letter","toUpperCase","keys","scriptContent","eventsMatch","e","eventConfig","findElementById","keyframesRegex","exec","keyframeName","framesContent","frames","frameRegex","frameMatch","frameKey","props","_element$styles","_element$children","animationName","found"],"sources":["F:/landinghub-iconic/apps/web/src/utils/pageUtils.js"],"sourcesContent":["import { v4 as uuidv4 } from 'uuid';\r\nimport { useCallback } from 'react';\r\nimport {\r\n    getResponsiveValues,\r\n    syncElementBetweenModes,\r\n    initializeResponsiveData,\r\n    autoScaleStyles,\r\n    autoScaleSize,\r\n    autoScalePosition,\r\n    autoScaleComponentData\r\n} from './responsiveSync.js';\r\n\r\n/**\r\n * Render a single element to HTML\r\n * @param {Object} element - Element object\r\n * @param {boolean} isChild - Whether this is a child element\r\n * @param {string} viewMode - Current view mode (desktop, tablet, mobile)\r\n * @returns {string} - HTML string\r\n */\r\nconst renderElementHTML = (element, isChild = false, viewMode = 'desktop') => {\r\n    // Skip rendering if element is not visible in the current view mode\r\n    if (element.visible === false) return '';\r\n\r\n    const { id, type, componentData = {}, styles = {}, size = {}, position = {} } = getResponsiveValues(element, viewMode);\r\n    const responsiveStyles = element.responsiveStyles?.[viewMode] || {};\r\n    const combinedStyles = { ...styles, ...responsiveStyles };\r\n\r\n    // Convert styles object to inline CSS\r\n    const inlineStyles = Object.entries(combinedStyles)\r\n        .filter(([key]) => !key.startsWith(':') && !key.startsWith('@'))\r\n        .map(([key, value]) => {\r\n            const kebabKey = key.replace(/[A-Z]/g, m => `-${m.toLowerCase()}`);\r\n            return `${kebabKey}:${value}`;\r\n        })\r\n        .join(';');\r\n\r\n    // Base attributes\r\n    const baseAttrs = `\r\n        id=\"${id}\"\r\n        data-element-id=\"${id}\"\r\n        data-type=\"${type}\"\r\n        class=\"lpb-element lpb-${type}\"\r\n    `;\r\n\r\n    // Position styles for child elements\r\n    const positionStyles = isChild ? `\r\n        position: absolute;\r\n        left: ${position.x || 0}px;\r\n        top: ${position.y || 0}px;\r\n        width: ${size.width || 200}px;\r\n        height: ${size.height || 50}px;\r\n    ` : '';\r\n\r\n    // Render based on type\r\n    switch (type) {\r\n        case 'section':\r\n            return renderSectionHTML(element, viewMode);\r\n\r\n        case 'button':\r\n            return `\r\n                <button \r\n                    ${baseAttrs}\r\n                    style=\"${inlineStyles}; ${positionStyles}\"\r\n                >\r\n                    ${componentData.content || 'Button'}\r\n                </button>\r\n            `;\r\n\r\n        case 'heading':\r\n            const HeadingTag = componentData.level || 'h2';\r\n            return `\r\n                <${HeadingTag} \r\n                    ${baseAttrs}\r\n                    style=\"${inlineStyles}; ${positionStyles}\"\r\n                >\r\n                    ${componentData.content || 'Heading'}\r\n                </${HeadingTag}>\r\n            `;\r\n\r\n        case 'paragraph':\r\n            return `\r\n                <p \r\n                    ${baseAttrs}\r\n                    style=\"${inlineStyles}; ${positionStyles}\"\r\n                >\r\n                    ${componentData.content || 'Paragraph'}\r\n                </p>\r\n            `;\r\n\r\n        case 'image':\r\n            return `\r\n                <img \r\n                    ${baseAttrs}\r\n                    src=\"${componentData.src || componentData.imageUrl || 'https://via.placeholder.com/150'}\"\r\n                    alt=\"${componentData.alt || 'Image'}\"\r\n                    style=\"${inlineStyles}; ${positionStyles}\"\r\n                />\r\n            `;\r\n\r\n        case 'icon':\r\n            const isSvg = componentData.icon?.startsWith('<svg');\r\n            return `\r\n                <div \r\n                    ${baseAttrs}\r\n                    style=\"${inlineStyles}; ${positionStyles}\"\r\n                    title=\"${componentData.title || ''}\"\r\n                >\r\n                    ${componentData.imageUrl\r\n                ? `<img src=\"${componentData.imageUrl}\" alt=\"${componentData.title || 'Icon'}\" style=\"width:100%;height:100%;object-fit:contain;\" />`\r\n                : isSvg\r\n                    ? componentData.icon\r\n                    : componentData.icon\r\n                        ? `<i class=\"${componentData.icon}\"></i>`\r\n                        : 'üì¶'\r\n            }\r\n                </div>\r\n            `;\r\n\r\n        case 'gallery':\r\n            return renderGalleryHTML(element, isChild, viewMode);\r\n\r\n        default:\r\n            return `\r\n                <div \r\n                    ${baseAttrs}\r\n                    style=\"${inlineStyles}; ${positionStyles}\"\r\n                >\r\n                    ${componentData.content || type}\r\n                </div>\r\n            `;\r\n    }\r\n};\r\n\r\n/**\r\n * Render gallery element\r\n * @param {Object} element - Gallery element\r\n * @param {boolean} isChild - Whether this is a child element\r\n * @param {string} viewMode - Current view mode\r\n * @returns {string} - HTML string\r\n */\r\nconst renderGalleryHTML = (element, isChild, viewMode = 'desktop') => {\r\n    if (element.visible === false) return '';\r\n\r\n    const { id, componentData = {}, styles = {}, size = {}, position = {} } = getResponsiveValues(element, viewMode);\r\n    const responsiveStyles = element.responsiveStyles?.[viewMode] || {};\r\n    const combinedStyles = { ...styles, ...responsiveStyles };\r\n\r\n    const positionStyles = isChild ? `\r\n        position: absolute;\r\n        left: ${position.x || 0}px;\r\n        top: ${position.y || 0}px;\r\n    ` : '';\r\n\r\n    const images = componentData.images || [];\r\n\r\n    return `\r\n        <div \r\n            id=\"${id}\"\r\n            data-element-id=\"${id}\"\r\n            data-type=\"gallery\"\r\n            class=\"lpb-element lpb-gallery\"\r\n            style=\"${positionStyles} width: ${size.width || 380}px; height: ${size.height || 300}px;\"\r\n        >\r\n            <div style=\"\r\n                display: ${combinedStyles.display || 'grid'};\r\n                grid-template-columns: ${combinedStyles.gridTemplateColumns || 'repeat(auto-fill, minmax(150px, 1fr))'};\r\n                gap: ${combinedStyles.gap || '10px'};\r\n                width: 100%;\r\n                height: 100%;\r\n            \">\r\n                ${images.map((imageUrl, index) => `\r\n                    <div style=\"\r\n                        position: relative;\r\n                        overflow: hidden;\r\n                        border-radius: ${combinedStyles.borderRadius || '8px'};\r\n                        aspect-ratio: 1 / 1;\r\n                    \">\r\n                        <img\r\n                            src=\"${imageUrl || 'https://via.placeholder.com/150'}\"\r\n                            alt=\"Gallery ${index + 1}\"\r\n                            style=\"\r\n                                width: 100%;\r\n                                height: 100%;\r\n                                object-fit: ${combinedStyles.objectFit || 'cover'};\r\n                                object-position: ${combinedStyles.objectPosition || 'center'};\r\n                            \"\r\n                            loading=\"lazy\"\r\n                        />\r\n                    </div>\r\n                `).join('')}\r\n                ${images.length === 0 ? `\r\n                    <div style=\"\r\n                        display: flex;\r\n                        flex-direction: column;\r\n                        align-items: center;\r\n                        justify-content: center;\r\n                        color: #9ca3af;\r\n                        text-align: center;\r\n                        grid-column: 1 / -1;\r\n                    \">\r\n                        <i class=\"fas fa-image\" style=\"font-size: 48px; margin-bottom: 8px;\"></i>\r\n                        <p>Empty gallery</p>\r\n                    </div>\r\n                ` : ''}\r\n            </div>\r\n        </div>\r\n    `;\r\n};\r\n\r\n/**\r\n * Render section with children\r\n * @param {Object} section - Section element\r\n * @param {string} viewMode - Current view mode\r\n * @returns {string} - HTML string\r\n */\r\nconst renderSectionHTML = (section, viewMode = 'desktop') => {\r\n    if (section.visible === false) return '';\r\n\r\n    const { id, componentData = {}, styles = {}, size = {}, position = {}, children = [] } = getResponsiveValues(section, viewMode);\r\n    const responsiveStyles = section.responsiveStyles?.[viewMode] || {};\r\n    const combinedStyles = { ...styles, ...responsiveStyles };\r\n\r\n    // Render children\r\n    const childrenHTML = children\r\n        .filter(child => child.visible !== false)\r\n        .map(child => renderElementHTML(child, true, viewMode))\r\n        .join('\\n');\r\n\r\n    return `\r\n        <section \r\n            id=\"${id}\"\r\n            data-element-id=\"${id}\"\r\n            class=\"lpb-section ladi-section\"\r\n            style=\"\r\n                position: absolute;\r\n                top: ${position.y || 0}px;\r\n                left: 50%;\r\n                transform: translateX(-50%);\r\n                width: ${viewMode === 'desktop' ? '1200px' : viewMode === 'tablet' ? '768px' : '375px'};\r\n                height: ${size.height || 400}px;\r\n            \"\r\n        >\r\n            <!-- Background -->\r\n            <div class=\"ladi-section-background\" style=\"\r\n                position: absolute;\r\n                inset: 0;\r\n                z-index: 0;\r\n                background-color: ${componentData.backgroundColor || combinedStyles.backgroundColor || 'transparent'};\r\n                background-image: ${componentData.backgroundImage ? `url(${componentData.backgroundImage})` : 'none'};\r\n                background-size: cover;\r\n                background-position: center;\r\n            \"></div>\r\n            \r\n            <!-- Overlay -->\r\n            <div class=\"ladi-overlay\" style=\"\r\n                position: absolute;\r\n                inset: 0;\r\n                z-index: 0;\r\n                background-color: ${componentData.overlayColor || 'transparent'};\r\n                opacity: ${componentData.overlayOpacity || 0};\r\n            \"></div>\r\n            \r\n            <!-- Container -->\r\n            <div class=\"ladi-container\" style=\"\r\n                position: relative;\r\n                z-index: 1;\r\n                padding: ${componentData.padding || combinedStyles.padding || '20px'};\r\n                width: 100%;\r\n                height: 100%;\r\n            \">\r\n                ${childrenHTML}\r\n            </div>\r\n        </section>\r\n    `;\r\n};\r\n\r\n/**\r\n * Render all popups to HTML\r\n * @param {Array} popups - Array of popup elements\r\n * @param {string} viewMode - Current view mode\r\n * @returns {string} - HTML string\r\n */\r\nconst renderPopupsHTML = (popups, viewMode = 'desktop') => {\r\n    return popups\r\n        .filter(popup => popup.visible !== false)\r\n        .map(popup => {\r\n            const { id, componentData = {}, styles = {}, size = {}, children = [] } = getResponsiveValues(popup, viewMode);\r\n            const responsiveStyles = popup.responsiveStyles?.[viewMode] || {};\r\n            const combinedStyles = { ...styles, ...responsiveStyles };\r\n\r\n            // Render children content\r\n            const childrenHTML = children\r\n                .filter(child => child.visible !== false)\r\n                .map(child => renderElementHTML(child, true, viewMode))\r\n                .join('');\r\n\r\n            return `\r\n                <div \r\n                    id=\"${id}\" \r\n                    class=\"lpb-popup\" \r\n                    data-element-id=\"${id}\"\r\n                    style=\"display:none;\"\r\n                >\r\n                    <!-- Overlay -->\r\n                    <div \r\n                        class=\"lpb-popup-overlay\" \r\n                        onclick=\"LPB.popups.close('${id}')\"\r\n                    ></div>\r\n                    \r\n                    <!-- Popup Container -->\r\n                    <div \r\n                        class=\"lpb-popup-container\"\r\n                        style=\"\r\n                            width: ${size.width || 600}px;\r\n                            max-width: 90vw;\r\n                            min-height: ${size.height || 400}px;\r\n                            background: ${combinedStyles.background || componentData.background || 'rgba(255, 255, 255, 0.95)'};\r\n                            border-radius: ${combinedStyles.borderRadius || componentData.borderRadius || '12px'};\r\n                            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.25);\r\n                        \"\r\n                    >\r\n                        <!-- Header -->\r\n                        <div class=\"lpb-popup-header\">\r\n                            <h3 style=\"margin:0; font-size:16px; font-weight:600; color:#111827;\">\r\n                                ${componentData.title || 'Popup Title'}\r\n                            </h3>\r\n                            <button \r\n                                class=\"lpb-popup-close\" \r\n                                onclick=\"LPB.popups.close('${id}')\"\r\n                                aria-label=\"Close popup\"\r\n                            >\r\n                                ‚úï\r\n                            </button>\r\n                        </div>\r\n                        \r\n                        <!-- Body -->\r\n                        <div class=\"lpb-popup-body\" style=\"padding: ${componentData.padding || '20px'};\">\r\n                            ${childrenHTML || `<p style=\"color:#6b7280;\">${componentData.content || 'Popup content'}</p>`}\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            `;\r\n        }).join('\\n');\r\n};\r\n\r\n/**\r\n * Generate CSS from pageData with responsive support\r\n * @param {Object} pageData - Page data\r\n * @returns {string} - CSS string\r\n */\r\nconst generateCSS = (pageData) => {\r\n    let css = `\r\n        * {\r\n            box-sizing: border-box;\r\n        }\r\n        \r\n        body {\r\n            margin: 0;\r\n            padding: 0;\r\n        }\r\n        \r\n        .lpb-element {\r\n            transition: all 0.3s ease;\r\n        }\r\n        \r\n        .lpb-popup {\r\n            position: fixed;\r\n            inset: 0;\r\n            z-index: 9999;\r\n            display: none;\r\n            align-items: center;\r\n            justify-content: center;\r\n        }\r\n        \r\n        .lpb-popup.lpb-popup-active {\r\n            display: flex;\r\n        }\r\n        \r\n        .lpb-popup-overlay {\r\n            position: absolute;\r\n            inset: 0;\r\n            background: rgba(0, 0, 0, 0.5);\r\n            cursor: pointer;\r\n        }\r\n        \r\n        .lpb-popup-container {\r\n            position: relative;\r\n            z-index: 1;\r\n            background: white;\r\n            border-radius: 12px;\r\n            max-height: 90vh;\r\n            overflow-y: auto;\r\n            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);\r\n        }\r\n        \r\n        .lpb-popup-header {\r\n            display: flex;\r\n            justify-content: space-between;\r\n            align-items: center;\r\n            padding: 16px 20px;\r\n            border-bottom: 1px solid #e5e7eb;\r\n            background: linear-gradient(to bottom, #f9fafb, #ffffff);\r\n        }\r\n        \r\n        .lpb-popup-close {\r\n            width: 28px;\r\n            height: 28px;\r\n            border: none;\r\n            background: transparent;\r\n            cursor: pointer;\r\n            border-radius: 6px;\r\n            display: flex;\r\n            align-items: center;\r\n            justify-content: center;\r\n            transition: all 0.15s ease;\r\n            color: #6b7280;\r\n            font-size: 18px;\r\n            font-weight: bold;\r\n        }\r\n        \r\n        .lpb-popup-close:hover {\r\n            background: #f3f4f6;\r\n            color: #111827;\r\n        }\r\n        \r\n        .lpb-popup-body {\r\n            padding: 20px;\r\n        }\r\n        \r\n        .lpb-spinner {\r\n            border: 3px solid #f3f3f3;\r\n            border-top: 3px solid #3b82f6;\r\n            border-radius: 50%;\r\n            width: 40px;\r\n            height: 40px;\r\n            animation: spin 1s linear infinite;\r\n            margin: 0 auto;\r\n        }\r\n        \r\n        @keyframes spin {\r\n            0% { transform: rotate(0deg); }\r\n            100% { transform: rotate(360deg); }\r\n        }\r\n    `;\r\n\r\n    // Generate CSS for each element\r\n    pageData.elements\r\n        .filter(el => el.visible !== false)\r\n        .forEach(element => {\r\n            const generateStylesForMode = (viewMode) => {\r\n                const { id, styles = {}, size = {}, position = {} } = getResponsiveValues(element, viewMode);\r\n                const responsiveStyles = element.responsiveStyles?.[viewMode] || {};\r\n                const combinedStyles = { ...styles, ...responsiveStyles };\r\n\r\n                const styleString = Object.entries(combinedStyles)\r\n                    .filter(([key]) => !key.startsWith(':') && !key.startsWith('@'))\r\n                    .map(([key, value]) => {\r\n                        const cssKey = key.replace(/([A-Z])/g, '-$1').toLowerCase();\r\n                        return `${cssKey}: ${value};`;\r\n                    })\r\n                    .join(' ');\r\n\r\n                return `\r\n                    #${id} {\r\n                        position: absolute;\r\n                        left: ${position.x || 0}px;\r\n                        top: ${position.y || 0}px;\r\n                        width: ${size.width || (element.type === 'section' ? 1200 : 200)}px;\r\n                        height: ${size.height || (element.type === 'section' ? 400 : 50)}px;\r\n                        z-index: ${position.z || 1};\r\n                        ${styleString}\r\n                    }\r\n                    ${combinedStyles[':hover'] ? `\r\n                        #${id}:hover {\r\n                            ${Object.entries(combinedStyles[':hover'])\r\n                    .map(([key, value]) => `${key.replace(/([A-Z])/g, '-$1').toLowerCase()}: ${value};`)\r\n                    .join(' ')}\r\n                        }\r\n                    ` : ''}\r\n                    ${combinedStyles['@keyframes'] ? `\r\n                        @keyframes ${id}-keyframes {\r\n                            ${Object.entries(combinedStyles['@keyframes'])\r\n                    .map(([key, value]) => `${key} { ${Object.entries(value)\r\n                        .map(([k, v]) => `${k.replace(/([A-Z])/g, '-$1').toLowerCase()}: ${v};`)\r\n                        .join(' ')} }`)\r\n                    .join(' ')}\r\n                        }\r\n                    ` : ''}\r\n                `;\r\n            };\r\n\r\n            // Default desktop styles\r\n            css += generateStylesForMode('desktop');\r\n\r\n            // Tablet media query\r\n            css += `\r\n                @media (max-width: 768px) {\r\n                    ${generateStylesForMode('tablet')}\r\n                    .lpb-section {\r\n                        width: 100% !important;\r\n                    }\r\n                    .lpb-popup-container {\r\n                        width: 90% !important;\r\n                        max-width: 90vw !important;\r\n                    }\r\n                }\r\n            `;\r\n\r\n            // Mobile media query\r\n            css += `\r\n                @media (max-width: 375px) {\r\n                    ${generateStylesForMode('mobile')}\r\n                    .lpb-section {\r\n                        width: 100% !important;\r\n                    }\r\n                    .lpb-popup-container {\r\n                        width: 90% !important;\r\n                        max-width: 90vw !important;\r\n                    }\r\n                }\r\n            `;\r\n        });\r\n\r\n    return css;\r\n};\r\n\r\n/**\r\n * Extract all events from pageData elements\r\n * @param {Object} pageData - Page data object\r\n * @returns {Array} - Array of event configs\r\n */\r\nconst extractEvents = (pageData) => {\r\n    const events = [];\r\n\r\n    const processElement = (element, parentId = null) => {\r\n        const elementId = element.id;\r\n\r\n        // Only include events for visible elements\r\n        if (element.visible === false) return;\r\n\r\n        // Check element events\r\n        if (element.componentData?.events) {\r\n            events.push({\r\n                elementId: elementId,\r\n                events: element.componentData.events,\r\n                type: element.type,\r\n                parentId: parentId\r\n            });\r\n        }\r\n\r\n        // Check children events\r\n        if (Array.isArray(element.children)) {\r\n            element.children.forEach(child => {\r\n                if (child.visible !== false && child.componentData?.events) {\r\n                    events.push({\r\n                        elementId: child.id,\r\n                        events: child.componentData.events,\r\n                        type: child.type,\r\n                        parentId: elementId\r\n                    });\r\n                }\r\n\r\n                // Recursive for nested children\r\n                if (Array.isArray(child.children)) {\r\n                    processElement(child, child.id);\r\n                }\r\n            });\r\n        }\r\n    };\r\n\r\n    pageData.elements.forEach(element => {\r\n        processElement(element);\r\n    });\r\n\r\n    return events;\r\n};\r\n\r\n/**\r\n * Generate runtime script to handle events in static HTML\r\n * @param {Array} events - List of events from pageData\r\n * @param {Array} popups - List of popup elements\r\n * @returns {string} - JavaScript code\r\n */\r\nconst generateEventRuntime = (events, popups) => {\r\n    return `\r\n    // Landing Page Builder Runtime v1.1\r\n    (function() {\r\n        'use strict';\r\n        \r\n        window.LPB = window.LPB || {};\r\n        \r\n        // ========== POPUP MANAGER ==========\r\n        LPB.popups = {\r\n            active: new Set(),\r\n            \r\n            open: function(popupId, data) {\r\n                const popup = document.getElementById(popupId);\r\n                if (!popup) {\r\n                    console.error('[LPB] Popup not found:', popupId);\r\n                    return;\r\n                }\r\n                \r\n                // Update content if data exists\r\n                if (data && data.html) {\r\n                    const content = popup.querySelector('.lpb-popup-body');\r\n                    if (content) content.innerHTML = data.html;\r\n                }\r\n                \r\n                // Show popup\r\n                popup.classList.add('lpb-popup-active');\r\n                document.body.style.overflow = 'hidden';\r\n                this.active.add(popupId);\r\n                \r\n                // Analytics tracking\r\n                if (window.gtag) {\r\n                    gtag('event', 'popup_open', {\r\n                        event_category: 'Engagement',\r\n                        event_label: popupId\r\n                    });\r\n                }\r\n            },\r\n            \r\n            close: function(popupId) {\r\n                const popup = document.getElementById(popupId);\r\n                if (popup) {\r\n                    popup.classList.remove('lpb-popup-active');\r\n                    this.active.delete(popupId);\r\n                    \r\n                    // Restore scroll if no popups remain\r\n                    if (this.active.size === 0) {\r\n                        document.body.style.overflow = '';\r\n                    }\r\n                }\r\n            },\r\n            \r\n            closeAll: function() {\r\n                this.active.forEach(id => this.close(id));\r\n            }\r\n        };\r\n        \r\n        // ========== API MANAGER ==========\r\n        LPB.api = {\r\n            cache: new Map(),\r\n            \r\n            getCacheKey: function(endpoint, params) {\r\n                return endpoint + JSON.stringify(params || {});\r\n            },\r\n            \r\n            fetch: async function(endpoint, options = {}) {\r\n                const cacheKey = this.getCacheKey(endpoint, options.params);\r\n                \r\n                // Check cache\r\n                if (this.cache.has(cacheKey)) {\r\n                    const cached = this.cache.get(cacheKey);\r\n                    const now = Date.now();\r\n                    const TTL = options.ttl || 5 * 60 * 1000; // 5 minutes default\r\n                    \r\n                    if (now - cached.timestamp < TTL) {\r\n                        console.log('[LPB] Cache hit:', endpoint);\r\n                        return cached.data;\r\n                    }\r\n                }\r\n                \r\n                // Fetch new data\r\n                try {\r\n                    console.log('[LPB] Fetching:', endpoint);\r\n                    const response = await fetch(endpoint, {\r\n                        method: options.method || 'GET',\r\n                        headers: {\r\n                            'Content-Type': 'application/json',\r\n                            ...options.headers\r\n                        },\r\n                        body: options.data ? JSON.stringify(options.data) : undefined\r\n                    });\r\n                    \r\n                    if (!response.ok) {\r\n                        throw new Error(\\`HTTP \\${response.status}: \\${response.statusText}\\`);\r\n                    }\r\n                    \r\n                    const data = await response.json();\r\n                    \r\n                    // Cache result\r\n                    this.cache.set(cacheKey, {\r\n                        data: data,\r\n                        timestamp: Date.now()\r\n                    });\r\n                    \r\n                    return data;\r\n                } catch (error) {\r\n                    console.error('[LPB] API Error:', error);\r\n                    throw error;\r\n                }\r\n            },\r\n            \r\n            clearCache: function(endpoint) {\r\n                if (endpoint) {\r\n                    for (let key of this.cache.keys()) {\r\n                        if (key.startsWith(endpoint)) {\r\n                            this.cache.delete(key);\r\n                        }\r\n                    }\r\n                } else {\r\n                    this.cache.clear();\r\n                }\r\n            }\r\n        };\r\n        \r\n        // ========== EVENT HANDLER ==========\r\n        LPB.handleEvent = async function(config) {\r\n            const { type } = config;\r\n            \r\n            try {\r\n                switch(type) {\r\n                    case 'openPopup':\r\n                        if (!config.popupId) {\r\n                            console.error('[LPB] Missing popupId');\r\n                            return;\r\n                        }\r\n                        this.popups.open(config.popupId, config.data);\r\n                        break;\r\n                        \r\n                    case 'closePopup':\r\n                        const targetPopupId = config.popupId || config.elementId;\r\n                        if (!targetPopupId) {\r\n                            console.error('[LPB] Missing popupId');\r\n                            return;\r\n                        }\r\n                        this.popups.close(targetPopupId);\r\n                        break;\r\n                        \r\n                    case 'triggerApi':\r\n                        if (!config.apiUrl) {\r\n                            console.error('[LPB] Missing apiUrl');\r\n                            return;\r\n                        }\r\n                        const data = await this.api.fetch(config.apiUrl, {\r\n                            method: config.method || 'GET',\r\n                            params: config.params,\r\n                            data: config.data\r\n                        });\r\n                        \r\n                        // Update target if specified\r\n                        if (config.updateTarget) {\r\n                            const target = document.getElementById(config.updateTarget);\r\n                            if (target && data.html) {\r\n                                target.innerHTML = data.html;\r\n                            }\r\n                        }\r\n                        break;\r\n                        \r\n                    case 'both':\r\n                        // Open popup immediately with loading\r\n                        this.popups.open(config.popupId, { \r\n                            html: '<div style=\"text-align:center;padding:40px;\"><div class=\"lpb-spinner\"></div><p>ƒêang t·∫£i...</p></div>' \r\n                        });\r\n                        \r\n                        // Fetch API in background\r\n                        const apiData = await this.api.fetch(config.apiUrl, {\r\n                            method: config.method || 'GET',\r\n                            params: config.params\r\n                        });\r\n                        \r\n                        // Update popup content\r\n                        this.popups.open(config.popupId, { html: apiData.html || JSON.stringify(apiData) });\r\n                        break;\r\n                        \r\n                    case 'navigate':\r\n                        if (!config.url) {\r\n                            console.error('[LPB] Missing url');\r\n                            return;\r\n                        }\r\n                        if (config.newTab) {\r\n                            window.open(config.url, '_blank');\r\n                        } else {\r\n                            window.location.href = config.url;\r\n                        }\r\n                        break;\r\n                        \r\n                    case 'scrollToSection':\r\n                        if (!config.sectionId) {\r\n                            console.error('[LPB] Missing sectionId');\r\n                            return;\r\n                        }\r\n                        const section = document.querySelector(\\`[data-element-id=\"\\${config.sectionId}\"]\\`);\r\n                        if (section) {\r\n                            section.scrollIntoView({ \r\n                                behavior: config.smooth !== false ? 'smooth' : 'auto',\r\n                                block: 'start'\r\n                            });\r\n                        } else {\r\n                            console.error('[LPB] Section not found:', config.sectionId);\r\n                        }\r\n                        break;\r\n                        \r\n                    case 'submitForm':\r\n                        if (!config.apiUrl) {\r\n                            console.error('[LPB] Missing apiUrl');\r\n                            return;\r\n                        }\r\n                        console.log('[LPB] Form submit to:', config.apiUrl);\r\n                        break;\r\n                        \r\n                    default:\r\n                        console.warn('[LPB] Unknown event type:', type);\r\n                }\r\n            } catch (error) {\r\n                console.error('[LPB] Event handling error:', error);\r\n                alert('C√≥ l·ªói x·∫£y ra: ' + error.message);\r\n            }\r\n        };\r\n        \r\n        // ========== AUTO-BIND EVENTS ==========\r\n        const eventsConfig = ${JSON.stringify(events)};\r\n        \r\n        function bindEvents() {\r\n            console.log('[LPB] Initializing events...', eventsConfig.length);\r\n            \r\n            eventsConfig.forEach(config => {\r\n                const element = document.getElementById(config.elementId);\r\n                if (!element) {\r\n                    // Silently skip instead of logging warning\r\n                    return;\r\n                }\r\n                \r\n                // Bind onClick\r\n                if (config.events.onClick && config.events.onClick.type !== 'none') {\r\n                    element.addEventListener('click', function(e) {\r\n                        e.preventDefault();\r\n                        e.stopPropagation();\r\n                        LPB.handleEvent(config.events.onClick);\r\n                    });\r\n                    \r\n                    element.style.cursor = 'pointer';\r\n                }\r\n                \r\n                // Bind hover prefetch\r\n                if (config.events.onClick?.params?.apiConfig?.preload) {\r\n                    element.addEventListener('mouseenter', function() {\r\n                        LPB.api.fetch(\r\n                            config.events.onClick.params.apiConfig.endpoint,\r\n                            config.events.onClick.params.apiConfig\r\n                        ).catch(() => {}); // Silent prefetch\r\n                    }, { once: true });\r\n                }\r\n                \r\n                // Bind onHover effects\r\n                if (config.events.onHover) {\r\n                    const hoverClass = config.events.onHover.className;\r\n                    if (hoverClass) {\r\n                        element.addEventListener('mouseenter', function() {\r\n                            this.classList.add(hoverClass);\r\n                        });\r\n                        element.addEventListener('mouseleave', function() {\r\n                            this.classList.remove(hoverClass);\r\n                        });\r\n                    }\r\n                }\r\n            });\r\n            \r\n            console.log('[LPB] Events initialized!');\r\n        }\r\n        \r\n        // Try binding events immediately\r\n        bindEvents();\r\n        \r\n        // Fallback: Bind events on DOMContentLoaded for iframe compatibility\r\n        if (document.readyState === 'loading') {\r\n            document.addEventListener('DOMContentLoaded', bindEvents);\r\n        }\r\n        \r\n        // ========== ESC TO CLOSE POPUP ==========\r\n        document.addEventListener('keydown', function(e) {\r\n            if (e.key === 'Escape') {\r\n                LPB.popups.closeAll();\r\n            }\r\n        });\r\n        \r\n        console.log('[LPB] Runtime loaded');\r\n    })();\r\n    `;\r\n};\r\n\r\n/**\r\n * Render entire pageData to static HTML with embedded runtime\r\n * @param {Object} pageData - Page data\r\n * @returns {string} - Complete HTML document\r\n */\r\nexport const renderStaticHTML = (pageData) => {\r\n    // Initialize responsive data\r\n    const initializedPageData = initializeResponsiveData(pageData);\r\n\r\n    // Extract components\r\n    const popups = initializedPageData.elements.filter(el => el.type === 'popup' && el.visible !== false);\r\n    const sections = initializedPageData.elements.filter(el => el.type === 'section' && el.visible !== false);\r\n    const standaloneElements = initializedPageData.elements.filter(\r\n        el => el.type !== 'section' && el.type !== 'popup' && el.visible !== false\r\n    );\r\n\r\n    // Generate HTML parts\r\n    const sectionsHTML = sections.map(section => renderSectionHTML(section, 'desktop')).join('\\n');\r\n    const popupsHTML = renderPopupsHTML(popups, 'desktop');\r\n    const standaloneHTML = standaloneElements\r\n        .map(element => renderElementHTML(element, false, 'desktop'))\r\n        .join('\\n');\r\n    const cssContent = generateCSS(initializedPageData);\r\n    const events = extractEvents(initializedPageData);\r\n    const runtimeScript = generateEventRuntime(events, popups);\r\n\r\n    // Embed pageData as JSON\r\n    const embeddedPageData = JSON.stringify(initializedPageData, null, 2);\r\n\r\n    return `\r\n        <!DOCTYPE html>\r\n        <html lang=\"vi\">\r\n        <head>\r\n            <meta charset=\"UTF-8\">\r\n            <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\r\n            <meta name=\"description\" content=\"${initializedPageData.meta?.description || 'Landing page generated by LandingHub'}\">\r\n            <title>${initializedPageData.meta?.title || 'Landing Page'}</title>\r\n            \r\n            <!-- Font Awesome -->\r\n            <link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css\" crossorigin=\"anonymous\" referrerpolicy=\"no-referrer\" />\r\n            \r\n            <!-- Styles -->\r\n            <style>\r\n                ${cssContent}\r\n            </style>\r\n        </head>\r\n        <body style=\"margin: 0; padding: 0; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;\">\r\n            <!-- Canvas -->\r\n            <div id=\"lpb-canvas\" style=\"\r\n                position: relative;\r\n                min-height: 100vh;\r\n                background: ${initializedPageData.canvas?.background || '#ffffff'};\r\n            \">\r\n                ${sectionsHTML}\r\n                ${standaloneHTML}\r\n            </div>\r\n            \r\n            <!-- Popups -->\r\n            ${popupsHTML}\r\n            \r\n            <!-- Embedded Page Data -->\r\n            <script type=\"application/json\" id=\"lpb-page-data\">\r\n                ${embeddedPageData}\r\n            </script>\r\n            \r\n            <!-- Runtime Script -->\r\n            <script>\r\n                ${runtimeScript}\r\n            </script>\r\n            \r\n            <!-- Google Analytics (optional) -->\r\n            ${initializedPageData.analytics?.googleAnalyticsId ? `\r\n            <script async src=\"https://www.googletagmanager.com/gtag/js?id=${initializedPageData.analytics.googleAnalyticsId}\"></script>\r\n            <script>\r\n                window.dataLayer = window.dataLayer || [];\r\n                function gtag(){dataLayer.push(arguments);}\r\n                gtag('js', new Date());\r\n                gtag('config', '${initializedPageData.analytics.googleAnalyticsId}');\r\n            </script>\r\n            ` : ''}\r\n        </body>\r\n        </html>\r\n    `;\r\n};\r\n\r\n/**\r\n * Parse HTML string into pageData structure\r\n * @param {string} htmlString - HTML content from S3\r\n * @returns {Object} pageData with structure { canvas, elements, meta }\r\n */\r\nexport const parseHTMLToPageData = (htmlString) => {\r\n    const pageData = {\r\n        canvas: {\r\n            width: 1200,\r\n            height: 'auto',\r\n            background: '#ffffff'\r\n        },\r\n        elements: [],\r\n        meta: {\r\n            title: 'Untitled',\r\n            description: '',\r\n            keywords: [],\r\n            created_at: new Date().toISOString(),\r\n            updated_at: new Date().toISOString()\r\n        },\r\n        analytics: {}\r\n    };\r\n\r\n    try {\r\n        const parser = new DOMParser();\r\n        const doc = parser.parseFromString(htmlString, 'text/html');\r\n\r\n        // Parse meta\r\n        const titleEl = doc.querySelector('title');\r\n        if (titleEl) {\r\n            pageData.meta.title = titleEl.textContent.trim() || 'Untitled';\r\n        }\r\n\r\n        const descEl = doc.querySelector('meta[name=\"description\"]');\r\n        if (descEl) {\r\n            pageData.meta.description = descEl.getAttribute('content') || '';\r\n        }\r\n\r\n        const keywordsEl = doc.querySelector('meta[name=\"keywords\"]');\r\n        if (keywordsEl) {\r\n            pageData.meta.keywords = keywordsEl.getAttribute('content')?.split(',').map(k => k.trim()) || [];\r\n        }\r\n\r\n        const analyticsScript = doc.querySelector('script[src*=\"googletagmanager\"]');\r\n        if (analyticsScript) {\r\n            const gaId = analyticsScript.src.match(/id=([A-Za-z0-9-_]+)/);\r\n            if (gaId) {\r\n                pageData.analytics.googleAnalyticsId = gaId[1];\r\n            }\r\n        }\r\n\r\n        // Try parsing embedded pageData (priority)\r\n        const pageDataScript = doc.querySelector('script[type=\"application/json\"][id=\"lpb-page-data\"]');\r\n        if (pageDataScript) {\r\n            try {\r\n                const embeddedData = JSON.parse(pageDataScript.textContent || pageDataScript.innerHTML);\r\n                console.log('‚úÖ Found embedded pageData in <script id=\"lpb-page-data\">');\r\n\r\n                // Validate and normalize embedded pageData\r\n                if (embeddedData.canvas && Array.isArray(embeddedData.elements) && embeddedData.meta) {\r\n                    pageData.canvas = {\r\n                        width: embeddedData.canvas.width || 1200,\r\n                        height: embeddedData.canvas.height || 'auto',\r\n                        background: embeddedData.canvas.background || '#ffffff'\r\n                    };\r\n                    pageData.elements = normalizeElements(embeddedData.elements);\r\n                    pageData.meta = {\r\n                        title: embeddedData.meta.title || pageData.meta.title,\r\n                        description: embeddedData.meta.description || pageData.meta.description,\r\n                        keywords: embeddedData.meta.keywords || pageData.meta.keywords,\r\n                        created_at: embeddedData.meta.created_at || pageData.meta.created_at,\r\n                        updated_at: embeddedData.meta.updated_at || pageData.meta.updated_at\r\n                    };\r\n                    pageData.analytics = embeddedData.analytics || pageData.analytics;\r\n                    return initializeResponsiveData(pageData); // Ensure responsive data\r\n                } else {\r\n                    console.warn('‚ö†Ô∏è Embedded pageData kh√¥ng h·ª£p l·ªá, fallback parse HTML');\r\n                }\r\n            } catch (parseError) {\r\n                console.warn('‚ö†Ô∏è Failed to parse embedded pageData JSON:', parseError.message);\r\n            }\r\n        }\r\n\r\n        // Fallback: Parse HTML structure\r\n        console.log('üîç Parsing HTML structure...');\r\n\r\n        // Parse canvas from #lpb-canvas\r\n        const canvasEl = doc.getElementById('lpb-canvas');\r\n        if (canvasEl) {\r\n            const canvasStyle = canvasEl.style;\r\n            pageData.canvas = {\r\n                width: parseInt(canvasStyle.width) || 1200,\r\n                height: canvasStyle.height || 'auto',\r\n                background: canvasStyle.background || canvasStyle.backgroundColor || '#ffffff',\r\n                minHeight: canvasStyle.minHeight || '100vh'\r\n            };\r\n        }\r\n\r\n        // Parse sections\r\n        const sections = doc.querySelectorAll('section.lpb-section, section.ladi-section, section[data-element-id]');\r\n        sections.forEach((sectionEl, index) => {\r\n            const section = parseSectionElement(sectionEl, index);\r\n            if (section) {\r\n                pageData.elements.push(syncElementBetweenModes(section, 'desktop'));\r\n            }\r\n        });\r\n\r\n        // Parse popups\r\n        const popups = doc.querySelectorAll('div.lpb-popup, div[data-type=\"popup\"]');\r\n        popups.forEach((popupEl, index) => {\r\n            const popup = parsePopupElement(popupEl, index);\r\n            if (popup) {\r\n                pageData.elements.push(syncElementBetweenModes(popup, 'desktop'));\r\n            }\r\n        });\r\n\r\n        // Parse standalone elements\r\n        const standaloneElements = doc.querySelectorAll('div.lpb-element:not(section):not(.lpb-popup):not(.lpb-child-element), [data-element-id]:not(.lpb-section):not(.lpb-popup)');\r\n        standaloneElements.forEach((el, index) => {\r\n            if (!el.closest('section.lpb-section, div.lpb-popup')) {\r\n                const element = parseStandaloneElement(el, index);\r\n                if (element) {\r\n                    pageData.elements.push(syncElementBetweenModes(element, 'desktop'));\r\n                }\r\n            }\r\n        });\r\n\r\n        // Parse events from runtime script\r\n        const runtimeScripts = doc.querySelectorAll('script');\r\n        runtimeScripts.forEach(script => {\r\n            const content = script.textContent || script.innerHTML;\r\n            const eventsConfig = extractEventsFromScript(content);\r\n            if (eventsConfig.length > 0) {\r\n                mapEventsToElements(pageData.elements, eventsConfig);\r\n            }\r\n        });\r\n\r\n        // Parse animations and keyframes from <style>\r\n        const styleElements = doc.querySelectorAll('style');\r\n        styleElements.forEach(styleEl => {\r\n            const cssContent = styleEl.textContent || styleEl.innerHTML;\r\n            const animations = extractAnimationsFromCSS(cssContent);\r\n            mapAnimationsToElements(pageData.elements, animations);\r\n        });\r\n\r\n        // Calculate canvas height based on elements\r\n        const maxHeight = Math.max(\r\n            ...pageData.elements\r\n                .filter(el => el.visible !== false)\r\n                .map(el => {\r\n                    const elTop = el.position?.desktop?.y || 0;\r\n                    const elHeight = el.size?.desktop?.height || 400;\r\n                    return elTop + elHeight;\r\n                }),\r\n            1648\r\n        );\r\n        pageData.canvas.height = maxHeight;\r\n\r\n        console.log('‚úÖ HTML parsed successfully:', {\r\n            elementsCount: pageData.elements.length,\r\n            sections: pageData.elements.filter(el => el.type === 'section').length,\r\n            popups: pageData.elements.filter(el => el.type === 'popup').length,\r\n            standalone: pageData.elements.filter(el => el.type !== 'section' && el.type !== 'popup').length\r\n        });\r\n\r\n        return initializeResponsiveData(pageData);\r\n\r\n    } catch (error) {\r\n        console.error('‚ùå parseHTMLToPageData error:', error);\r\n        return pageData; // Fallback default pageData\r\n    }\r\n};\r\n\r\n/**\r\n * Handle saving pageData to server\r\n * @param {Object} params - Parameters including pageId, navigate, pageData, setIsSaving, toast, api\r\n * @returns {Function} - Callback function for saving\r\n */\r\nexport const handleSave = (params) => {\r\n    const { pageId, navigate, pageData, setIsSaving, toast, api } = params;\r\n\r\n    return useCallback(async () => {\r\n        if (!pageId) {\r\n            toast.error('Kh√¥ng t√¨m th·∫•y ID trang.');\r\n            return;\r\n        }\r\n        setIsSaving(true); // Show DogLoader during save\r\n        try {\r\n            // Initialize and sync responsive data\r\n            const initializedPageData = initializeResponsiveData(pageData);\r\n            const syncedPageData = {\r\n                ...initializedPageData,\r\n                elements: initializedPageData.elements.map(element => syncElementBetweenModes(element, 'desktop'))\r\n            };\r\n            const htmlContent = renderStaticHTML(syncedPageData);\r\n            const response = await api.put(`/api/pages/${pageId}`, { html: htmlContent, pageData: syncedPageData });\r\n            if (response.data.success) {\r\n                toast.success(`L∆∞u trang th√†nh c√¥ng! (${syncedPageData.elements.length} ph·∫ßn t·ª≠)`);\r\n                if (!response.data.page.screenshot_url) {\r\n                    toast.warn('·∫¢nh ch·ª•p m√†n h√¨nh ch∆∞a ƒë∆∞·ª£c t·∫°o. ƒêang th·ª≠ t·∫°o l·∫°i...');\r\n                    try {\r\n                        await api.get(`/api/pages/regenerate-screenshots`);\r\n                        toast.success('ƒê√£ y√™u c·∫ßu t·∫°o l·∫°i ·∫£nh ch·ª•p m√†n h√¨nh!');\r\n                    } catch (err) {\r\n                        console.error('Error regenerating screenshots:', err);\r\n                        toast.error('Kh√¥ng th·ªÉ t·∫°o l·∫°i ·∫£nh ch·ª•p m√†n h√¨nh: ' + (err.response?.data?.error || err.message));\r\n                    }\r\n                }\r\n                // Navigate back to page list to refresh\r\n                navigate('/pages');\r\n            }\r\n        } catch (error) {\r\n            console.error('L·ªói khi l∆∞u trang:', error);\r\n            toast.error('L·ªói khi l∆∞u trang: ' + (error.response?.data?.error || error.message));\r\n            if (error.response?.status === 401) {\r\n                localStorage.removeItem('token');\r\n                navigate('/auth');\r\n            }\r\n        } finally {\r\n            setIsSaving(false); // Hide DogLoader\r\n        }\r\n    }, [pageId, navigate, pageData, setIsSaving, toast, api]);\r\n};\r\n\r\n/**\r\n * Handle preview of pageData\r\n * @param {Object} params - Parameters including pageData, setPreviewHtml, setShowPreview\r\n * @returns {Function} - Callback function for preview\r\n */\r\nexport const handlePreview = (params) => {\r\n    const { pageData, setPreviewHtml, setShowPreview } = params;\r\n\r\n    return useCallback(() => {\r\n        try {\r\n            // Initialize responsive data\r\n            const initializedPageData = initializeResponsiveData(pageData);\r\n            // Filter out invalid or missing elements\r\n            const validPageData = {\r\n                ...initializedPageData,\r\n                elements: initializedPageData.elements.filter(\r\n                    el => el.id && el.type && el.visible !== false\r\n                )\r\n            };\r\n            const htmlContent = renderStaticHTML(validPageData);\r\n            setPreviewHtml(htmlContent);\r\n            setShowPreview(true);\r\n        } catch (error) {\r\n            console.error('L·ªói khi t·∫°o preview:', error);\r\n            params.toast?.error('L·ªói khi t·∫°o preview: ' + (error.message || 'Kh√¥ng x√°c ƒë·ªãnh'));\r\n        }\r\n    }, [pageData, setPreviewHtml, setShowPreview, params.toast]);\r\n};\r\n\r\n/**\r\n * Normalize elements to ensure valid structure\r\n * @param {Array} elements - Array of elements\r\n * @returns {Array} Normalized elements\r\n */\r\nconst normalizeElements = (elements) => {\r\n    return elements\r\n        .filter(el => el.id && el.type) // Ensure elements have id and type\r\n        .map(el => ({\r\n            id: el.id || `element-${Date.now()}-${Math.random().toString(36).slice(2)}`,\r\n            type: el.type || 'section',\r\n            componentData: el.componentData || {},\r\n            position: {\r\n                desktop: el.position?.desktop || { x: 0, y: 0, z: 1 },\r\n                tablet: el.position?.tablet || el.position?.desktop || { x: 0, y: 0, z: 1 },\r\n                mobile: el.position?.mobile || el.position?.desktop || { x: 0, y: 0, z: 1 }\r\n            },\r\n            size: {\r\n                desktop: el.size?.desktop || el.size || { width: el.type === 'popup' ? 600 : 1200, height: 400 },\r\n                tablet: el.size?.tablet || autoScaleSize(el, 'desktop', 'tablet'),\r\n                mobile: el.size?.mobile || autoScaleSize(el, 'desktop', 'mobile')\r\n            },\r\n            styles: el.styles || {},\r\n            responsiveStyles: {\r\n                desktop: el.responsiveStyles?.desktop || {},\r\n                tablet: el.responsiveStyles?.tablet || autoScaleStyles(el.styles, 'desktop', 'tablet'),\r\n                mobile: el.responsiveStyles?.mobile || autoScaleStyles(el.styles, 'desktop', 'mobile')\r\n            },\r\n            children: Array.isArray(el.children) ? normalizeElements(el.children) : [],\r\n            visible: el.visible !== false,\r\n            locked: !!el.locked\r\n        }));\r\n};\r\n\r\n/**\r\n * Parse section element from HTML\r\n * @param {HTMLElement} sectionEl - Section element\r\n * @param {number} index - Index of section\r\n * @returns {Object|null} Section object\r\n */\r\nconst parseSectionElement = (sectionEl, index) => {\r\n    const id = sectionEl.id || sectionEl.getAttribute('data-element-id') || `section-${Date.now()}-${index}`;\r\n    const style = sectionEl.style;\r\n\r\n    const topMatch = style.top?.match(/(\\d+)px/) || ['0'];\r\n    const top = parseInt(topMatch[1]) || 0;\r\n    const widthMatch = style.width?.match(/(\\d+)px/) || ['1200'];\r\n    const heightMatch = style.height?.match(/(\\d+)px/) || ['400'];\r\n    const width = parseInt(widthMatch[1]) || 1200;\r\n    const height = parseInt(heightMatch[1]) || 400;\r\n\r\n    const bgEl = sectionEl.querySelector('.ladi-section-background');\r\n    const overlayEl = sectionEl.querySelector('.ladi-overlay');\r\n    const containerEl = sectionEl.querySelector('.ladi-container');\r\n\r\n    const componentData = { structure: sectionEl.classList.contains('ladi-section') ? 'ladi-standard' : 'standard' };\r\n\r\n    if (bgEl) {\r\n        const bgStyle = bgEl.style;\r\n        componentData.backgroundColor = bgStyle.backgroundColor || 'transparent';\r\n        const bgImageMatch = bgStyle.backgroundImage?.match(/url\\(['\"]?(.+?)['\"]?\\)/);\r\n        if (bgImageMatch) {\r\n            componentData.backgroundImage = bgImageMatch[1];\r\n            componentData.backgroundType = 'image';\r\n        } else if (componentData.backgroundColor !== 'transparent') {\r\n            componentData.backgroundType = 'color';\r\n        }\r\n        componentData.backgroundPosition = bgStyle.backgroundPosition || 'center';\r\n        componentData.backgroundSize = bgStyle.backgroundSize || 'cover';\r\n    }\r\n\r\n    if (overlayEl) {\r\n        componentData.overlayColor = overlayEl.style.backgroundColor || 'transparent';\r\n        componentData.overlayOpacity = parseFloat(overlayEl.style.opacity) || 0;\r\n    }\r\n\r\n    const styles = parseInlineStyles(style, sectionEl);\r\n    if (containerEl) {\r\n        componentData.padding = containerEl.style.padding || '20px';\r\n    }\r\n\r\n    const children = [];\r\n    if (containerEl) {\r\n        const childElements = containerEl.querySelectorAll('.lpb-element[data-element-id], .lpb-child-element');\r\n        childElements.forEach(childEl => {\r\n            if (childEl.closest('.ladi-container') === containerEl) {\r\n                const child = parseChildElement(childEl, id);\r\n                if (child) {\r\n                    children.push(child);\r\n                }\r\n            }\r\n        });\r\n    }\r\n\r\n    return {\r\n        id,\r\n        type: 'section',\r\n        componentData,\r\n        position: {\r\n            desktop: { x: 0, y: top, z: parseInt(style.zIndex) || index + 1 },\r\n            tablet: autoScalePosition({ position: { desktop: { x: 0, y: top, z: parseInt(style.zIndex) || index + 1 } } }, 'desktop', 'tablet', { width, height }),\r\n            mobile: autoScalePosition({ position: { desktop: { x: 0, y: top, z: parseInt(style.zIndex) || index + 1 } } }, 'desktop', 'mobile', { width, height })\r\n        },\r\n        size: {\r\n            desktop: { width, height },\r\n            tablet: autoScaleSize({ size: { desktop: { width, height } } }, 'desktop', 'tablet'),\r\n            mobile: autoScaleSize({ size: { desktop: { width, height } } }, 'desktop', 'mobile')\r\n        },\r\n        styles,\r\n        responsiveStyles: {\r\n            desktop: {},\r\n            tablet: autoScaleStyles(styles, 'desktop', 'tablet'),\r\n            mobile: autoScaleStyles(styles, 'desktop', 'mobile')\r\n        },\r\n        children,\r\n        visible: style.display !== 'none',\r\n        locked: sectionEl.classList.contains('lpb-element-locked')\r\n    };\r\n};\r\n\r\n/**\r\n * Parse popup element from HTML\r\n * @param {HTMLElement} popupEl - Popup element\r\n * @param {number} index - Index of popup\r\n * @returns {Object|null} Popup object\r\n */\r\nconst parsePopupElement = (popupEl, index) => {\r\n    const id = popupEl.id || popupEl.getAttribute('data-element-id') || `popup-${Date.now()}-${index}`;\r\n    const containerEl = popupEl.querySelector('.lpb-popup-container');\r\n    if (!containerEl) return null;\r\n\r\n    const widthMatch = containerEl.style.width?.match(/(\\d+)px/) || ['600'];\r\n    const minHeightMatch = containerEl.style.minHeight?.match(/(\\d+)px/) || ['400'];\r\n    const width = parseInt(widthMatch[1]) || 600;\r\n    const height = parseInt(minHeightMatch[1]) || 400;\r\n\r\n    const headerEl = popupEl.querySelector('.lpb-popup-header h3');\r\n    const bodyEl = popupEl.querySelector('.lpb-popup-body');\r\n\r\n    const componentData = {\r\n        title: headerEl?.textContent.trim() || 'Popup',\r\n        background: containerEl.style.background || 'rgba(255, 255, 255, 0.95)',\r\n        borderRadius: containerEl.style.borderRadius || '12px',\r\n        padding: bodyEl?.style.padding || '20px'\r\n    };\r\n\r\n    const styles = parseInlineStyles(containerEl.style, popupEl);\r\n\r\n    const children = [];\r\n    if (bodyEl) {\r\n        const childElements = bodyEl.querySelectorAll('.lpb-element[data-element-id], .lpb-child-element');\r\n        childElements.forEach(childEl => {\r\n            if (childEl.closest('.lpb-popup-body') === bodyEl) {\r\n                const child = parseChildElement(childEl, id);\r\n                if (child) {\r\n                    children.push(child);\r\n                }\r\n            }\r\n        });\r\n    }\r\n\r\n    return {\r\n        id,\r\n        type: 'popup',\r\n        componentData,\r\n        position: {\r\n            desktop: { x: 0, y: 0, z: parseInt(containerEl.style.zIndex) || 1001 },\r\n            tablet: { x: 0, y: 0, z: parseInt(containerEl.style.zIndex) || 1001 },\r\n            mobile: { x: 0, y: 0, z: parseInt(containerEl.style.zIndex) || 1001 }\r\n        },\r\n        size: {\r\n            desktop: { width, height },\r\n            tablet: autoScaleSize({ size: { desktop: { width, height } } }, 'desktop', 'tablet'),\r\n            mobile: autoScaleSize({ size: { desktop: { width, height } } }, 'desktop', 'mobile')\r\n        },\r\n        styles,\r\n        responsiveStyles: {\r\n            desktop: {},\r\n            tablet: autoScaleStyles(styles, 'desktop', 'tablet'),\r\n            mobile: autoScaleStyles(styles, 'desktop', 'mobile')\r\n        },\r\n        children,\r\n        visible: popupEl.classList.contains('lpb-popup-active') || popupEl.style.display !== 'none',\r\n        locked: popupEl.classList.contains('lpb-element-locked')\r\n    };\r\n};\r\n\r\n/**\r\n * Parse standalone element from HTML\r\n * @param {HTMLElement} element - Standalone element\r\n * @param {number} index - Index of element\r\n * @returns {Object|null} Element object\r\n */\r\nconst parseStandaloneElement = (element, index) => {\r\n    const id = element.id || element.getAttribute('data-element-id') || `element-${Date.now()}-${index}`;\r\n    const type = element.getAttribute('data-type') || inferTypeFromElement(element);\r\n    const style = element.style;\r\n\r\n    const leftMatch = style.left?.match(/(\\d+)px/) || ['0'];\r\n    const topMatch = style.top?.match(/(\\d+)px/) || ['0'];\r\n    const widthMatch = style.width?.match(/(\\d+)px/) || [type === 'gallery' ? '380' : '200'];\r\n    const heightMatch = style.height?.match(/(\\d+)px/) || [type === 'gallery' ? '300' : '50'];\r\n    const left = parseInt(leftMatch[1]) || 0;\r\n    const top = parseInt(topMatch[1]) || 0;\r\n    const width = parseInt(widthMatch[1]) || (type === 'gallery' ? 380 : type === 'icon' ? 50 : 200);\r\n    const height = parseInt(heightMatch[1]) || (type === 'gallery' ? 300 : type === 'icon' ? 50 : 50);\r\n\r\n    const styles = parseInlineStyles(style, element);\r\n    const componentData = parseComponentData(element, type);\r\n\r\n    return {\r\n        id,\r\n        type,\r\n        componentData,\r\n        position: {\r\n            desktop: { x: left, y: top, z: parseInt(style.zIndex) || index + 1 },\r\n            tablet: autoScalePosition({ position: { desktop: { x: left, y: top, z: parseInt(style.zIndex) || index + 1 } } }, 'desktop', 'tablet', { width, height }),\r\n            mobile: autoScalePosition({ position: { desktop: { x: left, y: top, z: parseInt(style.zIndex) || index + 1 } } }, 'desktop', 'mobile', { width, height })\r\n        },\r\n        size: {\r\n            desktop: { width, height },\r\n            tablet: autoScaleSize({ size: { desktop: { width, height } } }, 'desktop', 'tablet'),\r\n            mobile: autoScaleSize({ size: { desktop: { width, height } } }, 'desktop', 'mobile')\r\n        },\r\n        styles,\r\n        responsiveStyles: {\r\n            desktop: {},\r\n            tablet: autoScaleStyles(styles, 'desktop', 'tablet'),\r\n            mobile: autoScaleStyles(styles, 'desktop', 'mobile')\r\n        },\r\n        children: [],\r\n        visible: style.display !== 'none',\r\n        locked: element.classList.contains('lpb-element-locked')\r\n    };\r\n};\r\n\r\n/**\r\n * Parse child element from HTML\r\n * @param {HTMLElement} element - Child element\r\n * @param {string} parentId - ID of parent (section/popup)\r\n * @returns {Object|null} Child element object\r\n */\r\nconst parseChildElement = (element, parentId) => {\r\n    const id = element.id || element.getAttribute('data-element-id') || `child-${Date.now()}-${Math.random().toString(36).slice(2)}`;\r\n    const type = element.getAttribute('data-type') || inferTypeFromElement(element);\r\n    const style = element.style;\r\n\r\n    const leftMatch = style.left?.match(/(\\d+)px/) || ['0'];\r\n    const topMatch = style.top?.match(/(\\d+)px/) || ['0'];\r\n    const widthMatch = style.width?.match(/(\\d+)px/) || [type === 'gallery' ? '380' : '200'];\r\n    const heightMatch = style.height?.match(/(\\d+)px/) || [type === 'gallery' ? '300' : '50'];\r\n    const left = parseInt(leftMatch[1]) || 0;\r\n    const top = parseInt(topMatch[1]) || 0;\r\n    const width = parseInt(widthMatch[1]) || (type === 'gallery' ? 380 : type === 'icon' ? 50 : 200);\r\n    const height = parseInt(heightMatch[1]) || (type === 'gallery' ? 300 : type === 'icon' ? 50 : 50);\r\n\r\n    const styles = parseInlineStyles(style, element);\r\n    const componentData = parseComponentData(element, type);\r\n\r\n    return {\r\n        id,\r\n        type,\r\n        componentData,\r\n        position: {\r\n            desktop: { x: left, y: top, z: parseInt(style.zIndex) || 10 },\r\n            tablet: autoScalePosition({ position: { desktop: { x: left, y: top, z: parseInt(style.zIndex) || 10 } } }, 'desktop', 'tablet', { width, height }),\r\n            mobile: autoScalePosition({ position: { desktop: { x: left, y: top, z: parseInt(style.zIndex) || 10 } } }, 'desktop', 'mobile', { width, height })\r\n        },\r\n        size: {\r\n            desktop: { width, height },\r\n            tablet: autoScaleSize({ size: { desktop: { width, height } } }, 'desktop', 'tablet'),\r\n            mobile: autoScaleSize({ size: { desktop: { width, height } } }, 'desktop', 'mobile')\r\n        },\r\n        styles,\r\n        responsiveStyles: {\r\n            desktop: {},\r\n            tablet: autoScaleStyles(styles, 'desktop', 'tablet'),\r\n            mobile: autoScaleStyles(styles, 'desktop', 'mobile')\r\n        },\r\n        children: [],\r\n        visible: style.display !== 'none',\r\n        locked: element.classList.contains('lpb-element-locked'),\r\n        parentId\r\n    };\r\n};\r\n\r\n/**\r\n * Parse componentData based on type\r\n * @param {HTMLElement} element - Element\r\n * @param {string} type - Type of element\r\n * @returns {Object} componentData\r\n */\r\nconst parseComponentData = (element, type) => {\r\n    const componentData = {};\r\n\r\n    switch (type) {\r\n        case 'button':\r\n            componentData.content = element.textContent.trim() || 'Button';\r\n            componentData.background = element.style.background || element.style.backgroundColor;\r\n            componentData.color = element.style.color;\r\n            componentData.borderRadius = element.style.borderRadius;\r\n            componentData.border = element.style.border;\r\n            componentData.fontSize = element.style.fontSize;\r\n            componentData.fontWeight = element.style.fontWeight;\r\n            break;\r\n\r\n        case 'heading':\r\n            componentData.content = element.textContent.trim() || 'Heading';\r\n            componentData.level = element.tagName.toLowerCase();\r\n            componentData.fontSize = element.style.fontSize;\r\n            componentData.color = element.style.color;\r\n            componentData.fontWeight = element.style.fontWeight;\r\n            componentData.textAlign = element.style.textAlign;\r\n            break;\r\n\r\n        case 'paragraph':\r\n            componentData.content = element.textContent.trim() || 'Paragraph';\r\n            componentData.fontSize = element.style.fontSize;\r\n            componentData.color = element.style.color;\r\n            componentData.fontWeight = element.style.fontWeight;\r\n            componentData.lineHeight = element.style.lineHeight;\r\n            componentData.textAlign = element.style.textAlign;\r\n            break;\r\n\r\n        case 'image':\r\n            componentData.src = element.getAttribute('src') || 'https://via.placeholder.com/150';\r\n            componentData.alt = element.getAttribute('alt') || 'Image';\r\n            componentData.imageUrl = componentData.src;\r\n            break;\r\n\r\n        case 'icon':\r\n            const img = element.querySelector('img');\r\n            const iconEl = element.querySelector('i');\r\n            const svgEl = element.querySelector('svg');\r\n            if (img) {\r\n                componentData.imageUrl = img.getAttribute('src');\r\n                componentData.alt = img.getAttribute('alt') || 'Icon';\r\n            } else if (svgEl) {\r\n                componentData.icon = svgEl.outerHTML;\r\n            } else if (iconEl) {\r\n                componentData.icon = iconEl.className;\r\n            }\r\n            componentData.title = element.getAttribute('title') || '';\r\n            break;\r\n\r\n        case 'gallery':\r\n            const images = Array.from(element.querySelectorAll('img')).map(img => img.getAttribute('src') || 'https://via.placeholder.com/150');\r\n            componentData.images = images;\r\n            componentData.display = element.style.display || 'grid';\r\n            componentData.gridTemplateColumns = element.style.gridTemplateColumns || 'repeat(auto-fill, minmax(150px, 1fr))';\r\n            componentData.gap = element.style.gap || '10px';\r\n            break;\r\n\r\n        default:\r\n            componentData.content = element.textContent.trim() || '';\r\n            break;\r\n    }\r\n\r\n    // Parse animation if present\r\n    if (element.style.animation) {\r\n        const animationMatch = element.style.animation.match(/(\\S+)\\s*(\\d+\\.?\\d*ms)\\s*(\\w+)\\s*(\\d+\\.?\\d*ms)?\\s*(infinite)?/);\r\n        if (animationMatch) {\r\n            componentData.animation = {\r\n                type: animationMatch[1],\r\n                duration: parseFloat(animationMatch[2]) || 1000,\r\n                timing: animationMatch[3] || 'ease',\r\n                delay: parseFloat(animationMatch[4]) || 0,\r\n                repeat: !!animationMatch[5]\r\n            };\r\n        }\r\n    }\r\n\r\n    return componentData;\r\n};\r\n\r\n/**\r\n * Parse inline styles and pseudo-classes from element\r\n * @param {CSSStyleDeclaration} styleObj - Style object\r\n * @param {HTMLElement} element - HTML element\r\n * @returns {Object} styles\r\n */\r\nconst parseInlineStyles = (styleObj, element) => {\r\n    const styles = {};\r\n    const importantProps = [\r\n        'background', 'backgroundColor', 'backgroundImage', 'backgroundSize', 'backgroundPosition',\r\n        'color', 'fontSize', 'fontWeight', 'fontFamily',\r\n        'border', 'borderRadius', 'boxShadow', 'textShadow',\r\n        'padding', 'margin', 'paddingTop', 'paddingRight', 'paddingBottom', 'paddingLeft',\r\n        'marginTop', 'marginRight', 'marginBottom', 'marginLeft',\r\n        'display', 'alignItems', 'justifyContent', 'flexDirection', 'gap',\r\n        'gridTemplateColumns', 'gridTemplateRows', 'gridGap',\r\n        'textAlign', 'lineHeight', 'textTransform',\r\n        'cursor', 'transition', 'animation', 'filter',\r\n        'zIndex', 'opacity', 'transform', 'transformOrigin',\r\n        'width', 'height', 'minWidth', 'minHeight', 'maxWidth', 'maxHeight'\r\n    ];\r\n\r\n    importantProps.forEach(prop => {\r\n        if (styleObj[prop]) {\r\n            styles[prop] = styleObj[prop];\r\n        }\r\n    });\r\n\r\n    // Parse pseudo-classes from <style> related to element\r\n    const styleElements = element.ownerDocument.querySelectorAll('style');\r\n    styleElements.forEach(styleEl => {\r\n        const cssContent = styleEl.textContent || styleEl.innerHTML;\r\n        const hoverRegex = new RegExp(`#${element.id}:hover\\\\s*{([\\\\s\\\\S]*?)}`);\r\n        const hoverMatch = cssContent.match(hoverRegex);\r\n        if (hoverMatch) {\r\n            const hoverStyles = {};\r\n            hoverMatch[1].split(';').forEach(rule => {\r\n                const [key, value] = rule.split(':').map(s => s.trim());\r\n                if (key && value) {\r\n                    const camelKey = key.replace(/-([a-z])/g, (_, letter) => letter.toUpperCase());\r\n                    hoverStyles[camelKey] = value;\r\n                }\r\n            });\r\n            if (Object.keys(hoverStyles).length > 0) {\r\n                styles[':hover'] = hoverStyles;\r\n            }\r\n        }\r\n    });\r\n\r\n    return styles;\r\n};\r\n\r\n/**\r\n * Extract events from runtime script\r\n * @param {string} scriptContent - Script content\r\n * @returns {Array} Array of event configs\r\n */\r\nconst extractEventsFromScript = (scriptContent) => {\r\n    const eventsMatch = scriptContent.match(/const eventsConfig = (\\[[\\s\\S]*?\\]);/);\r\n    if (eventsMatch) {\r\n        try {\r\n            return JSON.parse(eventsMatch[1]);\r\n        } catch (e) {\r\n            console.warn('‚ö†Ô∏è Cannot parse events config:', e.message);\r\n            return [];\r\n        }\r\n    }\r\n    return [];\r\n};\r\n\r\n/**\r\n * Map events to elements\r\n * @param {Array} elements - Array of elements\r\n * @param {Array} eventsConfig - Array of event configs\r\n */\r\nconst mapEventsToElements = (elements, eventsConfig) => {\r\n    eventsConfig.forEach(eventConfig => {\r\n        const element = findElementById(elements, eventConfig.elementId);\r\n        if (element) {\r\n            if (!element.componentData) {\r\n                element.componentData = {};\r\n            }\r\n            element.componentData.events = eventConfig.events || {};\r\n        }\r\n    });\r\n};\r\n\r\n/**\r\n * Extract animations from CSS\r\n * @param {string} cssContent - CSS content\r\n * @returns {Object} Animations object\r\n */\r\nconst extractAnimationsFromCSS = (cssContent) => {\r\n    const animations = {};\r\n    const keyframesRegex = /@keyframes\\s+(\\S+)\\s*{([\\s\\S]*?)}/g;\r\n    let match;\r\n    while ((match = keyframesRegex.exec(cssContent))) {\r\n        const keyframeName = match[1];\r\n        const framesContent = match[2];\r\n        const frames = {};\r\n        const frameRegex = /(\\d+%|from|to)\\s*{([\\s\\S]*?)}/g;\r\n        let frameMatch;\r\n        while ((frameMatch = frameRegex.exec(framesContent))) {\r\n            const frameKey = frameMatch[1];\r\n            const props = {};\r\n            frameMatch[2].split(';').forEach(rule => {\r\n                const [key, value] = rule.split(':').map(s => s.trim());\r\n                if (key && value) {\r\n                    const camelKey = key.replace(/-([a-z])/g, (_, letter) => letter.toUpperCase());\r\n                    props[camelKey] = value;\r\n                }\r\n            });\r\n            frames[frameKey] = props;\r\n        }\r\n        animations[`@keyframes ${keyframeName}`] = frames;\r\n    }\r\n    return animations;\r\n};\r\n\r\n/**\r\n * Map animations to elements\r\n * @param {Array} elements - Array of elements\r\n * @param {Object} animations - Animations object\r\n */\r\nconst mapAnimationsToElements = (elements, animations) => {\r\n    elements.forEach(element => {\r\n        if (element.styles?.animation) {\r\n            const animationMatch = element.styles.animation.match(/(\\S+)\\s*(\\d+\\.?\\d*ms)\\s*(\\w+)\\s*(\\d+\\.?\\d*ms)?\\s*(infinite)?/);\r\n            if (animationMatch) {\r\n                element.componentData.animation = {\r\n                    type: animationMatch[1],\r\n                    duration: parseFloat(animationMatch[2]) || 1000,\r\n                    timing: animationMatch[3] || 'ease',\r\n                    delay: parseFloat(animationMatch[4]) || 0,\r\n                    repeat: !!animationMatch[5]\r\n                };\r\n            }\r\n        }\r\n        if (element.styles && animations[`@keyframes ${element.styles.animationName}`]) {\r\n            element.styles[`@keyframes ${element.styles.animationName}`] = animations[`@keyframes ${element.styles.animationName}`];\r\n        }\r\n        if (element.children?.length > 0) {\r\n            mapAnimationsToElements(element.children, animations);\r\n        }\r\n    });\r\n};\r\n\r\n/**\r\n * Find element by ID\r\n * @param {Array} elements - Array of elements\r\n * @param {string} id - Element ID\r\n * @returns {Object|null} Element object\r\n */\r\nconst findElementById = (elements, id) => {\r\n    for (const element of elements) {\r\n        if (element.id === id) return element;\r\n\r\n        if (element.children && element.children.length > 0) {\r\n            const found = findElementById(element.children, id);\r\n            if (found) return found;\r\n        }\r\n    }\r\n    return null;\r\n};\r\n\r\n/**\r\n * Infer type from HTML element\r\n * @param {HTMLElement} element - HTML element\r\n * @returns {string} Element type\r\n */\r\nconst inferTypeFromElement = (element) => {\r\n    const tagName = element.tagName.toLowerCase();\r\n    const classList = element.classList;\r\n\r\n    if (classList.contains('lpb-button') || tagName === 'button') return 'button';\r\n    if (classList.contains('lpb-icon')) return 'icon';\r\n    if (classList.contains('lpb-gallery')) return 'gallery';\r\n    if (classList.contains('lpb-section') || classList.contains('ladi-section')) return 'section';\r\n    if (classList.contains('lpb-popup')) return 'popup';\r\n    if (tagName.match(/^h[1-6]$/)) return 'heading';\r\n    if (tagName === 'p') return 'paragraph';\r\n    if (tagName === 'img') return 'image';\r\n    if (tagName === 'hr') return 'divider';\r\n    if (tagName === 'form') return 'form';\r\n    if (tagName === 'ul' || tagName === 'ol') return 'list';\r\n    return 'container';\r\n};\r\n\r\nexport default {\r\n    renderStaticHTML,\r\n    parseHTMLToPageData,\r\n    handleSave,\r\n    handlePreview,\r\n    renderElementHTML,\r\n    renderPopupsHTML,\r\n    renderSectionHTML,\r\n    renderGalleryHTML,\r\n    generateCSS,\r\n    extractEvents,\r\n    generateEventRuntime,\r\n    normalizeElements,\r\n    parseSectionElement,\r\n    parsePopupElement,\r\n    parseStandaloneElement,\r\n    parseChildElement,\r\n    parseComponentData,\r\n    parseInlineStyles,\r\n    extractEventsFromScript,\r\n    mapEventsToElements,\r\n    extractAnimationsFromCSS,\r\n    mapAnimationsToElements,\r\n    findElementById,\r\n    inferTypeFromElement\r\n};"],"mappings":";;AAAA,SAASA,EAAE,IAAIC,MAAM,QAAQ,MAAM;AACnC,SAASC,WAAW,QAAQ,OAAO;AACnC,SACIC,mBAAmB,EACnBC,uBAAuB,EACvBC,wBAAwB,EACxBC,eAAe,EACfC,aAAa,EACbC,iBAAiB,EACjBC,sBAAsB,QACnB,qBAAqB;;AAE5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAMC,iBAAiB,GAAGA,CAACC,OAAO,EAAEC,OAAO,GAAG,KAAK,EAAEC,QAAQ,GAAG,SAAS,KAAK;EAAA,IAAAC,qBAAA,EAAAC,mBAAA;EAC1E;EACA,IAAIJ,OAAO,CAACK,OAAO,KAAK,KAAK,EAAE,OAAO,EAAE;EAExC,MAAM;IAAEC,EAAE;IAAEC,IAAI;IAAEC,aAAa,GAAG,CAAC,CAAC;IAAEC,MAAM,GAAG,CAAC,CAAC;IAAEC,IAAI,GAAG,CAAC,CAAC;IAAEC,QAAQ,GAAG,CAAC;EAAE,CAAC,GAAGnB,mBAAmB,CAACQ,OAAO,EAAEE,QAAQ,CAAC;EACtH,MAAMU,gBAAgB,GAAG,EAAAT,qBAAA,GAAAH,OAAO,CAACY,gBAAgB,cAAAT,qBAAA,uBAAxBA,qBAAA,CAA2BD,QAAQ,CAAC,KAAI,CAAC,CAAC;EACnE,MAAMW,cAAc,GAAG;IAAE,GAAGJ,MAAM;IAAE,GAAGG;EAAiB,CAAC;;EAEzD;EACA,MAAME,YAAY,GAAGC,MAAM,CAACC,OAAO,CAACH,cAAc,CAAC,CAC9CI,MAAM,CAAC,CAAC,CAACC,GAAG,CAAC,KAAK,CAACA,GAAG,CAACC,UAAU,CAAC,GAAG,CAAC,IAAI,CAACD,GAAG,CAACC,UAAU,CAAC,GAAG,CAAC,CAAC,CAC/DC,GAAG,CAAC,CAAC,CAACF,GAAG,EAAEG,KAAK,CAAC,KAAK;IACnB,MAAMC,QAAQ,GAAGJ,GAAG,CAACK,OAAO,CAAC,QAAQ,EAAEC,CAAC,IAAI,IAAIA,CAAC,CAACC,WAAW,CAAC,CAAC,EAAE,CAAC;IAClE,OAAO,GAAGH,QAAQ,IAAID,KAAK,EAAE;EACjC,CAAC,CAAC,CACDK,IAAI,CAAC,GAAG,CAAC;;EAEd;EACA,MAAMC,SAAS,GAAG;AACtB,cAAcrB,EAAE;AAChB,2BAA2BA,EAAE;AAC7B,qBAAqBC,IAAI;AACzB,iCAAiCA,IAAI;AACrC,KAAK;;EAED;EACA,MAAMqB,cAAc,GAAG3B,OAAO,GAAG;AACrC;AACA,gBAAgBU,QAAQ,CAACkB,CAAC,IAAI,CAAC;AAC/B,eAAelB,QAAQ,CAACmB,CAAC,IAAI,CAAC;AAC9B,iBAAiBpB,IAAI,CAACqB,KAAK,IAAI,GAAG;AAClC,kBAAkBrB,IAAI,CAACsB,MAAM,IAAI,EAAE;AACnC,KAAK,GAAG,EAAE;;EAEN;EACA,QAAQzB,IAAI;IACR,KAAK,SAAS;MACV,OAAO0B,iBAAiB,CAACjC,OAAO,EAAEE,QAAQ,CAAC;IAE/C,KAAK,QAAQ;MACT,OAAO;AACnB;AACA,sBAAsByB,SAAS;AAC/B,6BAA6Bb,YAAY,KAAKc,cAAc;AAC5D;AACA,sBAAsBpB,aAAa,CAAC0B,OAAO,IAAI,QAAQ;AACvD;AACA,aAAa;IAEL,KAAK,SAAS;MACV,MAAMC,UAAU,GAAG3B,aAAa,CAAC4B,KAAK,IAAI,IAAI;MAC9C,OAAO;AACnB,mBAAmBD,UAAU;AAC7B,sBAAsBR,SAAS;AAC/B,6BAA6Bb,YAAY,KAAKc,cAAc;AAC5D;AACA,sBAAsBpB,aAAa,CAAC0B,OAAO,IAAI,SAAS;AACxD,oBAAoBC,UAAU;AAC9B,aAAa;IAEL,KAAK,WAAW;MACZ,OAAO;AACnB;AACA,sBAAsBR,SAAS;AAC/B,6BAA6Bb,YAAY,KAAKc,cAAc;AAC5D;AACA,sBAAsBpB,aAAa,CAAC0B,OAAO,IAAI,WAAW;AAC1D;AACA,aAAa;IAEL,KAAK,OAAO;MACR,OAAO;AACnB;AACA,sBAAsBP,SAAS;AAC/B,2BAA2BnB,aAAa,CAAC6B,GAAG,IAAI7B,aAAa,CAAC8B,QAAQ,IAAI,iCAAiC;AAC3G,2BAA2B9B,aAAa,CAAC+B,GAAG,IAAI,OAAO;AACvD,6BAA6BzB,YAAY,KAAKc,cAAc;AAC5D;AACA,aAAa;IAEL,KAAK,MAAM;MACP,MAAMY,KAAK,IAAApC,mBAAA,GAAGI,aAAa,CAACiC,IAAI,cAAArC,mBAAA,uBAAlBA,mBAAA,CAAoBe,UAAU,CAAC,MAAM,CAAC;MACpD,OAAO;AACnB;AACA,sBAAsBQ,SAAS;AAC/B,6BAA6Bb,YAAY,KAAKc,cAAc;AAC5D,6BAA6BpB,aAAa,CAACkC,KAAK,IAAI,EAAE;AACtD;AACA,sBAAsBlC,aAAa,CAAC8B,QAAQ,GAC1B,aAAa9B,aAAa,CAAC8B,QAAQ,UAAU9B,aAAa,CAACkC,KAAK,IAAI,MAAM,yDAAyD,GACnIF,KAAK,GACDhC,aAAa,CAACiC,IAAI,GAClBjC,aAAa,CAACiC,IAAI,GACd,aAAajC,aAAa,CAACiC,IAAI,QAAQ,GACvC,IAAI;AAC9B;AACA,aACa;IAEL,KAAK,SAAS;MACV,OAAOE,iBAAiB,CAAC3C,OAAO,EAAEC,OAAO,EAAEC,QAAQ,CAAC;IAExD;MACI,OAAO;AACnB;AACA,sBAAsByB,SAAS;AAC/B,6BAA6Bb,YAAY,KAAKc,cAAc;AAC5D;AACA,sBAAsBpB,aAAa,CAAC0B,OAAO,IAAI3B,IAAI;AACnD;AACA,aAAa;EACT;AACJ,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAMoC,iBAAiB,GAAGA,CAAC3C,OAAO,EAAEC,OAAO,EAAEC,QAAQ,GAAG,SAAS,KAAK;EAAA,IAAA0C,sBAAA;EAClE,IAAI5C,OAAO,CAACK,OAAO,KAAK,KAAK,EAAE,OAAO,EAAE;EAExC,MAAM;IAAEC,EAAE;IAAEE,aAAa,GAAG,CAAC,CAAC;IAAEC,MAAM,GAAG,CAAC,CAAC;IAAEC,IAAI,GAAG,CAAC,CAAC;IAAEC,QAAQ,GAAG,CAAC;EAAE,CAAC,GAAGnB,mBAAmB,CAACQ,OAAO,EAAEE,QAAQ,CAAC;EAChH,MAAMU,gBAAgB,GAAG,EAAAgC,sBAAA,GAAA5C,OAAO,CAACY,gBAAgB,cAAAgC,sBAAA,uBAAxBA,sBAAA,CAA2B1C,QAAQ,CAAC,KAAI,CAAC,CAAC;EACnE,MAAMW,cAAc,GAAG;IAAE,GAAGJ,MAAM;IAAE,GAAGG;EAAiB,CAAC;EAEzD,MAAMgB,cAAc,GAAG3B,OAAO,GAAG;AACrC;AACA,gBAAgBU,QAAQ,CAACkB,CAAC,IAAI,CAAC;AAC/B,eAAelB,QAAQ,CAACmB,CAAC,IAAI,CAAC;AAC9B,KAAK,GAAG,EAAE;EAEN,MAAMe,MAAM,GAAGrC,aAAa,CAACqC,MAAM,IAAI,EAAE;EAEzC,OAAO;AACX;AACA,kBAAkBvC,EAAE;AACpB,+BAA+BA,EAAE;AACjC;AACA;AACA,qBAAqBsB,cAAc,WAAWlB,IAAI,CAACqB,KAAK,IAAI,GAAG,eAAerB,IAAI,CAACsB,MAAM,IAAI,GAAG;AAChG;AACA;AACA,2BAA2BnB,cAAc,CAACiC,OAAO,IAAI,MAAM;AAC3D,yCAAyCjC,cAAc,CAACkC,mBAAmB,IAAI,uCAAuC;AACtH,uBAAuBlC,cAAc,CAACmC,GAAG,IAAI,MAAM;AACnD;AACA;AACA;AACA,kBAAkBH,MAAM,CAACzB,GAAG,CAAC,CAACkB,QAAQ,EAAEW,KAAK,KAAK;AAClD;AACA;AACA;AACA,yCAAyCpC,cAAc,CAACqC,YAAY,IAAI,KAAK;AAC7E;AACA;AACA;AACA,mCAAmCZ,QAAQ,IAAI,iCAAiC;AAChF,2CAA2CW,KAAK,GAAG,CAAC;AACpD;AACA;AACA;AACA,8CAA8CpC,cAAc,CAACsC,SAAS,IAAI,OAAO;AACjF,mDAAmDtC,cAAc,CAACuC,cAAc,IAAI,QAAQ;AAC5F;AACA;AACA;AACA;AACA,iBAAiB,CAAC,CAAC1B,IAAI,CAAC,EAAE,CAAC;AAC3B,kBAAkBmB,MAAM,CAACQ,MAAM,KAAK,CAAC,GAAG;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,GAAG,EAAE;AACtB;AACA;AACA,KAAK;AACL,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA,MAAMpB,iBAAiB,GAAGA,CAACqB,OAAO,EAAEpD,QAAQ,GAAG,SAAS,KAAK;EAAA,IAAAqD,qBAAA;EACzD,IAAID,OAAO,CAACjD,OAAO,KAAK,KAAK,EAAE,OAAO,EAAE;EAExC,MAAM;IAAEC,EAAE;IAAEE,aAAa,GAAG,CAAC,CAAC;IAAEC,MAAM,GAAG,CAAC,CAAC;IAAEC,IAAI,GAAG,CAAC,CAAC;IAAEC,QAAQ,GAAG,CAAC,CAAC;IAAE6C,QAAQ,GAAG;EAAG,CAAC,GAAGhE,mBAAmB,CAAC8D,OAAO,EAAEpD,QAAQ,CAAC;EAC/H,MAAMU,gBAAgB,GAAG,EAAA2C,qBAAA,GAAAD,OAAO,CAAC1C,gBAAgB,cAAA2C,qBAAA,uBAAxBA,qBAAA,CAA2BrD,QAAQ,CAAC,KAAI,CAAC,CAAC;EACnE,MAAMW,cAAc,GAAG;IAAE,GAAGJ,MAAM;IAAE,GAAGG;EAAiB,CAAC;;EAEzD;EACA,MAAM6C,YAAY,GAAGD,QAAQ,CACxBvC,MAAM,CAACyC,KAAK,IAAIA,KAAK,CAACrD,OAAO,KAAK,KAAK,CAAC,CACxCe,GAAG,CAACsC,KAAK,IAAI3D,iBAAiB,CAAC2D,KAAK,EAAE,IAAI,EAAExD,QAAQ,CAAC,CAAC,CACtDwB,IAAI,CAAC,IAAI,CAAC;EAEf,OAAO;AACX;AACA,kBAAkBpB,EAAE;AACpB,+BAA+BA,EAAE;AACjC;AACA;AACA;AACA,uBAAuBK,QAAQ,CAACmB,CAAC,IAAI,CAAC;AACtC;AACA;AACA,yBAAyB5B,QAAQ,KAAK,SAAS,GAAG,QAAQ,GAAGA,QAAQ,KAAK,QAAQ,GAAG,OAAO,GAAG,OAAO;AACtG,0BAA0BQ,IAAI,CAACsB,MAAM,IAAI,GAAG;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oCAAoCxB,aAAa,CAACmD,eAAe,IAAI9C,cAAc,CAAC8C,eAAe,IAAI,aAAa;AACpH,oCAAoCnD,aAAa,CAACoD,eAAe,GAAG,OAAOpD,aAAa,CAACoD,eAAe,GAAG,GAAG,MAAM;AACpH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oCAAoCpD,aAAa,CAACqD,YAAY,IAAI,aAAa;AAC/E,2BAA2BrD,aAAa,CAACsD,cAAc,IAAI,CAAC;AAC5D;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2BtD,aAAa,CAACuD,OAAO,IAAIlD,cAAc,CAACkD,OAAO,IAAI,MAAM;AACpF;AACA;AACA;AACA,kBAAkBN,YAAY;AAC9B;AACA;AACA,KAAK;AACL,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA,MAAMO,gBAAgB,GAAGA,CAACC,MAAM,EAAE/D,QAAQ,GAAG,SAAS,KAAK;EACvD,OAAO+D,MAAM,CACRhD,MAAM,CAACiD,KAAK,IAAIA,KAAK,CAAC7D,OAAO,KAAK,KAAK,CAAC,CACxCe,GAAG,CAAC8C,KAAK,IAAI;IAAA,IAAAC,qBAAA;IACV,MAAM;MAAE7D,EAAE;MAAEE,aAAa,GAAG,CAAC,CAAC;MAAEC,MAAM,GAAG,CAAC,CAAC;MAAEC,IAAI,GAAG,CAAC,CAAC;MAAE8C,QAAQ,GAAG;IAAG,CAAC,GAAGhE,mBAAmB,CAAC0E,KAAK,EAAEhE,QAAQ,CAAC;IAC9G,MAAMU,gBAAgB,GAAG,EAAAuD,qBAAA,GAAAD,KAAK,CAACtD,gBAAgB,cAAAuD,qBAAA,uBAAtBA,qBAAA,CAAyBjE,QAAQ,CAAC,KAAI,CAAC,CAAC;IACjE,MAAMW,cAAc,GAAG;MAAE,GAAGJ,MAAM;MAAE,GAAGG;IAAiB,CAAC;;IAEzD;IACA,MAAM6C,YAAY,GAAGD,QAAQ,CACxBvC,MAAM,CAACyC,KAAK,IAAIA,KAAK,CAACrD,OAAO,KAAK,KAAK,CAAC,CACxCe,GAAG,CAACsC,KAAK,IAAI3D,iBAAiB,CAAC2D,KAAK,EAAE,IAAI,EAAExD,QAAQ,CAAC,CAAC,CACtDwB,IAAI,CAAC,EAAE,CAAC;IAEb,OAAO;AACnB;AACA,0BAA0BpB,EAAE;AAC5B;AACA,uCAAuCA,EAAE;AACzC;AACA;AACA;AACA;AACA;AACA,qDAAqDA,EAAE;AACvD;AACA;AACA;AACA;AACA;AACA;AACA,qCAAqCI,IAAI,CAACqB,KAAK,IAAI,GAAG;AACtD;AACA,0CAA0CrB,IAAI,CAACsB,MAAM,IAAI,GAAG;AAC5D,0CAA0CnB,cAAc,CAACuD,UAAU,IAAI5D,aAAa,CAAC4D,UAAU,IAAI,2BAA2B;AAC9H,6CAA6CvD,cAAc,CAACqC,YAAY,IAAI1C,aAAa,CAAC0C,YAAY,IAAI,MAAM;AAChH;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC1C,aAAa,CAACkC,KAAK,IAAI,aAAa;AACtE;AACA;AACA;AACA,6DAA6DpC,EAAE;AAC/D;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sEAAsEE,aAAa,CAACuD,OAAO,IAAI,MAAM;AACrG,8BAA8BN,YAAY,IAAI,6BAA6BjD,aAAa,CAAC0B,OAAO,IAAI,eAAe,MAAM;AACzH;AACA;AACA;AACA,aAAa;EACL,CAAC,CAAC,CAACR,IAAI,CAAC,IAAI,CAAC;AACrB,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA,MAAM2C,WAAW,GAAIC,QAAQ,IAAK;EAC9B,IAAIC,GAAG,GAAG;AACd;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;EAED;EACAD,QAAQ,CAACE,QAAQ,CACZvD,MAAM,CAACwD,EAAE,IAAIA,EAAE,CAACpE,OAAO,KAAK,KAAK,CAAC,CAClCqE,OAAO,CAAC1E,OAAO,IAAI;IAChB,MAAM2E,qBAAqB,GAAIzE,QAAQ,IAAK;MAAA,IAAA0E,sBAAA;MACxC,MAAM;QAAEtE,EAAE;QAAEG,MAAM,GAAG,CAAC,CAAC;QAAEC,IAAI,GAAG,CAAC,CAAC;QAAEC,QAAQ,GAAG,CAAC;MAAE,CAAC,GAAGnB,mBAAmB,CAACQ,OAAO,EAAEE,QAAQ,CAAC;MAC5F,MAAMU,gBAAgB,GAAG,EAAAgE,sBAAA,GAAA5E,OAAO,CAACY,gBAAgB,cAAAgE,sBAAA,uBAAxBA,sBAAA,CAA2B1E,QAAQ,CAAC,KAAI,CAAC,CAAC;MACnE,MAAMW,cAAc,GAAG;QAAE,GAAGJ,MAAM;QAAE,GAAGG;MAAiB,CAAC;MAEzD,MAAMiE,WAAW,GAAG9D,MAAM,CAACC,OAAO,CAACH,cAAc,CAAC,CAC7CI,MAAM,CAAC,CAAC,CAACC,GAAG,CAAC,KAAK,CAACA,GAAG,CAACC,UAAU,CAAC,GAAG,CAAC,IAAI,CAACD,GAAG,CAACC,UAAU,CAAC,GAAG,CAAC,CAAC,CAC/DC,GAAG,CAAC,CAAC,CAACF,GAAG,EAAEG,KAAK,CAAC,KAAK;QACnB,MAAMyD,MAAM,GAAG5D,GAAG,CAACK,OAAO,CAAC,UAAU,EAAE,KAAK,CAAC,CAACE,WAAW,CAAC,CAAC;QAC3D,OAAO,GAAGqD,MAAM,KAAKzD,KAAK,GAAG;MACjC,CAAC,CAAC,CACDK,IAAI,CAAC,GAAG,CAAC;MAEd,OAAO;AACvB,uBAAuBpB,EAAE;AACzB;AACA,gCAAgCK,QAAQ,CAACkB,CAAC,IAAI,CAAC;AAC/C,+BAA+BlB,QAAQ,CAACmB,CAAC,IAAI,CAAC;AAC9C,iCAAiCpB,IAAI,CAACqB,KAAK,KAAK/B,OAAO,CAACO,IAAI,KAAK,SAAS,GAAG,IAAI,GAAG,GAAG,CAAC;AACxF,kCAAkCG,IAAI,CAACsB,MAAM,KAAKhC,OAAO,CAACO,IAAI,KAAK,SAAS,GAAG,GAAG,GAAG,EAAE,CAAC;AACxF,mCAAmCI,QAAQ,CAACoE,CAAC,IAAI,CAAC;AAClD,0BAA0BF,WAAW;AACrC;AACA,sBAAsBhE,cAAc,CAAC,QAAQ,CAAC,GAAG;AACjD,2BAA2BP,EAAE;AAC7B,8BAA8BS,MAAM,CAACC,OAAO,CAACH,cAAc,CAAC,QAAQ,CAAC,CAAC,CACjDO,GAAG,CAAC,CAAC,CAACF,GAAG,EAAEG,KAAK,CAAC,KAAK,GAAGH,GAAG,CAACK,OAAO,CAAC,UAAU,EAAE,KAAK,CAAC,CAACE,WAAW,CAAC,CAAC,KAAKJ,KAAK,GAAG,CAAC,CACnFK,IAAI,CAAC,GAAG,CAAC;AAC9B;AACA,qBAAqB,GAAG,EAAE;AAC1B,sBAAsBb,cAAc,CAAC,YAAY,CAAC,GAAG;AACrD,qCAAqCP,EAAE;AACvC,8BAA8BS,MAAM,CAACC,OAAO,CAACH,cAAc,CAAC,YAAY,CAAC,CAAC,CACrDO,GAAG,CAAC,CAAC,CAACF,GAAG,EAAEG,KAAK,CAAC,KAAK,GAAGH,GAAG,MAAMH,MAAM,CAACC,OAAO,CAACK,KAAK,CAAC,CACnDD,GAAG,CAAC,CAAC,CAAC4D,CAAC,EAAEC,CAAC,CAAC,KAAK,GAAGD,CAAC,CAACzD,OAAO,CAAC,UAAU,EAAE,KAAK,CAAC,CAACE,WAAW,CAAC,CAAC,KAAKwD,CAAC,GAAG,CAAC,CACvEvD,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,CAClBA,IAAI,CAAC,GAAG,CAAC;AAC9B;AACA,qBAAqB,GAAG,EAAE;AAC1B,iBAAiB;IACL,CAAC;;IAED;IACA6C,GAAG,IAAII,qBAAqB,CAAC,SAAS,CAAC;;IAEvC;IACAJ,GAAG,IAAI;AACnB;AACA,sBAAsBI,qBAAqB,CAAC,QAAQ,CAAC;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;;IAED;IACAJ,GAAG,IAAI;AACnB;AACA,sBAAsBI,qBAAqB,CAAC,QAAQ,CAAC;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;EACL,CAAC,CAAC;EAEN,OAAOJ,GAAG;AACd,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA,MAAMW,aAAa,GAAIZ,QAAQ,IAAK;EAChC,MAAMa,MAAM,GAAG,EAAE;EAEjB,MAAMC,cAAc,GAAGA,CAACpF,OAAO,EAAEqF,QAAQ,GAAG,IAAI,KAAK;IAAA,IAAAC,qBAAA;IACjD,MAAMC,SAAS,GAAGvF,OAAO,CAACM,EAAE;;IAE5B;IACA,IAAIN,OAAO,CAACK,OAAO,KAAK,KAAK,EAAE;;IAE/B;IACA,KAAAiF,qBAAA,GAAItF,OAAO,CAACQ,aAAa,cAAA8E,qBAAA,eAArBA,qBAAA,CAAuBH,MAAM,EAAE;MAC/BA,MAAM,CAACK,IAAI,CAAC;QACRD,SAAS,EAAEA,SAAS;QACpBJ,MAAM,EAAEnF,OAAO,CAACQ,aAAa,CAAC2E,MAAM;QACpC5E,IAAI,EAAEP,OAAO,CAACO,IAAI;QAClB8E,QAAQ,EAAEA;MACd,CAAC,CAAC;IACN;;IAEA;IACA,IAAII,KAAK,CAACC,OAAO,CAAC1F,OAAO,CAACwD,QAAQ,CAAC,EAAE;MACjCxD,OAAO,CAACwD,QAAQ,CAACkB,OAAO,CAAChB,KAAK,IAAI;QAAA,IAAAiC,oBAAA;QAC9B,IAAIjC,KAAK,CAACrD,OAAO,KAAK,KAAK,KAAAsF,oBAAA,GAAIjC,KAAK,CAAClD,aAAa,cAAAmF,oBAAA,eAAnBA,oBAAA,CAAqBR,MAAM,EAAE;UACxDA,MAAM,CAACK,IAAI,CAAC;YACRD,SAAS,EAAE7B,KAAK,CAACpD,EAAE;YACnB6E,MAAM,EAAEzB,KAAK,CAAClD,aAAa,CAAC2E,MAAM;YAClC5E,IAAI,EAAEmD,KAAK,CAACnD,IAAI;YAChB8E,QAAQ,EAAEE;UACd,CAAC,CAAC;QACN;;QAEA;QACA,IAAIE,KAAK,CAACC,OAAO,CAAChC,KAAK,CAACF,QAAQ,CAAC,EAAE;UAC/B4B,cAAc,CAAC1B,KAAK,EAAEA,KAAK,CAACpD,EAAE,CAAC;QACnC;MACJ,CAAC,CAAC;IACN;EACJ,CAAC;EAEDgE,QAAQ,CAACE,QAAQ,CAACE,OAAO,CAAC1E,OAAO,IAAI;IACjCoF,cAAc,CAACpF,OAAO,CAAC;EAC3B,CAAC,CAAC;EAEF,OAAOmF,MAAM;AACjB,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA,MAAMS,oBAAoB,GAAGA,CAACT,MAAM,EAAElB,MAAM,KAAK;EAC7C,OAAO;AACX;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B4B,IAAI,CAACC,SAAS,CAACX,MAAM,CAAC;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA,OAAO,MAAMY,gBAAgB,GAAIzB,QAAQ,IAAK;EAAA,IAAA0B,qBAAA,EAAAC,sBAAA,EAAAC,sBAAA,EAAAC,sBAAA;EAC1C;EACA,MAAMC,mBAAmB,GAAG1G,wBAAwB,CAAC4E,QAAQ,CAAC;;EAE9D;EACA,MAAML,MAAM,GAAGmC,mBAAmB,CAAC5B,QAAQ,CAACvD,MAAM,CAACwD,EAAE,IAAIA,EAAE,CAAClE,IAAI,KAAK,OAAO,IAAIkE,EAAE,CAACpE,OAAO,KAAK,KAAK,CAAC;EACrG,MAAMgG,QAAQ,GAAGD,mBAAmB,CAAC5B,QAAQ,CAACvD,MAAM,CAACwD,EAAE,IAAIA,EAAE,CAAClE,IAAI,KAAK,SAAS,IAAIkE,EAAE,CAACpE,OAAO,KAAK,KAAK,CAAC;EACzG,MAAMiG,kBAAkB,GAAGF,mBAAmB,CAAC5B,QAAQ,CAACvD,MAAM,CAC1DwD,EAAE,IAAIA,EAAE,CAAClE,IAAI,KAAK,SAAS,IAAIkE,EAAE,CAAClE,IAAI,KAAK,OAAO,IAAIkE,EAAE,CAACpE,OAAO,KAAK,KACzE,CAAC;;EAED;EACA,MAAMkG,YAAY,GAAGF,QAAQ,CAACjF,GAAG,CAACkC,OAAO,IAAIrB,iBAAiB,CAACqB,OAAO,EAAE,SAAS,CAAC,CAAC,CAAC5B,IAAI,CAAC,IAAI,CAAC;EAC9F,MAAM8E,UAAU,GAAGxC,gBAAgB,CAACC,MAAM,EAAE,SAAS,CAAC;EACtD,MAAMwC,cAAc,GAAGH,kBAAkB,CACpClF,GAAG,CAACpB,OAAO,IAAID,iBAAiB,CAACC,OAAO,EAAE,KAAK,EAAE,SAAS,CAAC,CAAC,CAC5D0B,IAAI,CAAC,IAAI,CAAC;EACf,MAAMgF,UAAU,GAAGrC,WAAW,CAAC+B,mBAAmB,CAAC;EACnD,MAAMjB,MAAM,GAAGD,aAAa,CAACkB,mBAAmB,CAAC;EACjD,MAAMO,aAAa,GAAGf,oBAAoB,CAACT,MAAM,EAAElB,MAAM,CAAC;;EAE1D;EACA,MAAM2C,gBAAgB,GAAGf,IAAI,CAACC,SAAS,CAACM,mBAAmB,EAAE,IAAI,EAAE,CAAC,CAAC;EAErE,OAAO;AACX;AACA;AACA;AACA;AACA;AACA,gDAAgD,EAAAJ,qBAAA,GAAAI,mBAAmB,CAACS,IAAI,cAAAb,qBAAA,uBAAxBA,qBAAA,CAA0Bc,WAAW,KAAI,sCAAsC;AAC/H,qBAAqB,EAAAb,sBAAA,GAAAG,mBAAmB,CAACS,IAAI,cAAAZ,sBAAA,uBAAxBA,sBAAA,CAA0BvD,KAAK,KAAI,cAAc;AACtE;AACA;AACA;AACA;AACA;AACA;AACA,kBAAkBgE,UAAU;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8BAA8B,EAAAR,sBAAA,GAAAE,mBAAmB,CAACW,MAAM,cAAAb,sBAAA,uBAA1BA,sBAAA,CAA4B9B,UAAU,KAAI,SAAS;AACjF;AACA,kBAAkBmC,YAAY;AAC9B,kBAAkBE,cAAc;AAChC;AACA;AACA;AACA,cAAcD,UAAU;AACxB;AACA;AACA;AACA,kBAAkBI,gBAAgB;AAClC;AACA;AACA;AACA;AACA,kBAAkBD,aAAa;AAC/B;AACA;AACA;AACA,cAAc,CAAAR,sBAAA,GAAAC,mBAAmB,CAACY,SAAS,cAAAb,sBAAA,eAA7BA,sBAAA,CAA+Bc,iBAAiB,GAAG;AACjE,6EAA6Eb,mBAAmB,CAACY,SAAS,CAACC,iBAAiB;AAC5H;AACA;AACA;AACA;AACA,kCAAkCb,mBAAmB,CAACY,SAAS,CAACC,iBAAiB;AACjF;AACA,aAAa,GAAG,EAAE;AAClB;AACA;AACA,KAAK;AACL,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA,OAAO,MAAMC,mBAAmB,GAAIC,UAAU,IAAK;EAC/C,MAAM7C,QAAQ,GAAG;IACbyC,MAAM,EAAE;MACJhF,KAAK,EAAE,IAAI;MACXC,MAAM,EAAE,MAAM;MACdoC,UAAU,EAAE;IAChB,CAAC;IACDI,QAAQ,EAAE,EAAE;IACZqC,IAAI,EAAE;MACFnE,KAAK,EAAE,UAAU;MACjBoE,WAAW,EAAE,EAAE;MACfM,QAAQ,EAAE,EAAE;MACZC,UAAU,EAAE,IAAIC,IAAI,CAAC,CAAC,CAACC,WAAW,CAAC,CAAC;MACpCC,UAAU,EAAE,IAAIF,IAAI,CAAC,CAAC,CAACC,WAAW,CAAC;IACvC,CAAC;IACDP,SAAS,EAAE,CAAC;EAChB,CAAC;EAED,IAAI;IACA,MAAMS,MAAM,GAAG,IAAIC,SAAS,CAAC,CAAC;IAC9B,MAAMC,GAAG,GAAGF,MAAM,CAACG,eAAe,CAACT,UAAU,EAAE,WAAW,CAAC;;IAE3D;IACA,MAAMU,OAAO,GAAGF,GAAG,CAACG,aAAa,CAAC,OAAO,CAAC;IAC1C,IAAID,OAAO,EAAE;MACTvD,QAAQ,CAACuC,IAAI,CAACnE,KAAK,GAAGmF,OAAO,CAACE,WAAW,CAACC,IAAI,CAAC,CAAC,IAAI,UAAU;IAClE;IAEA,MAAMC,MAAM,GAAGN,GAAG,CAACG,aAAa,CAAC,0BAA0B,CAAC;IAC5D,IAAIG,MAAM,EAAE;MACR3D,QAAQ,CAACuC,IAAI,CAACC,WAAW,GAAGmB,MAAM,CAACC,YAAY,CAAC,SAAS,CAAC,IAAI,EAAE;IACpE;IAEA,MAAMC,UAAU,GAAGR,GAAG,CAACG,aAAa,CAAC,uBAAuB,CAAC;IAC7D,IAAIK,UAAU,EAAE;MAAA,IAAAC,qBAAA;MACZ9D,QAAQ,CAACuC,IAAI,CAACO,QAAQ,GAAG,EAAAgB,qBAAA,GAAAD,UAAU,CAACD,YAAY,CAAC,SAAS,CAAC,cAAAE,qBAAA,uBAAlCA,qBAAA,CAAoCC,KAAK,CAAC,GAAG,CAAC,CAACjH,GAAG,CAAC4D,CAAC,IAAIA,CAAC,CAACgD,IAAI,CAAC,CAAC,CAAC,KAAI,EAAE;IACpG;IAEA,MAAMM,eAAe,GAAGX,GAAG,CAACG,aAAa,CAAC,iCAAiC,CAAC;IAC5E,IAAIQ,eAAe,EAAE;MACjB,MAAMC,IAAI,GAAGD,eAAe,CAACjG,GAAG,CAACmG,KAAK,CAAC,qBAAqB,CAAC;MAC7D,IAAID,IAAI,EAAE;QACNjE,QAAQ,CAAC0C,SAAS,CAACC,iBAAiB,GAAGsB,IAAI,CAAC,CAAC,CAAC;MAClD;IACJ;;IAEA;IACA,MAAME,cAAc,GAAGd,GAAG,CAACG,aAAa,CAAC,qDAAqD,CAAC;IAC/F,IAAIW,cAAc,EAAE;MAChB,IAAI;QACA,MAAMC,YAAY,GAAG7C,IAAI,CAAC8C,KAAK,CAACF,cAAc,CAACV,WAAW,IAAIU,cAAc,CAACG,SAAS,CAAC;QACvFC,OAAO,CAACC,GAAG,CAAC,0DAA0D,CAAC;;QAEvE;QACA,IAAIJ,YAAY,CAAC3B,MAAM,IAAItB,KAAK,CAACC,OAAO,CAACgD,YAAY,CAAClE,QAAQ,CAAC,IAAIkE,YAAY,CAAC7B,IAAI,EAAE;UAClFvC,QAAQ,CAACyC,MAAM,GAAG;YACdhF,KAAK,EAAE2G,YAAY,CAAC3B,MAAM,CAAChF,KAAK,IAAI,IAAI;YACxCC,MAAM,EAAE0G,YAAY,CAAC3B,MAAM,CAAC/E,MAAM,IAAI,MAAM;YAC5CoC,UAAU,EAAEsE,YAAY,CAAC3B,MAAM,CAAC3C,UAAU,IAAI;UAClD,CAAC;UACDE,QAAQ,CAACE,QAAQ,GAAGuE,iBAAiB,CAACL,YAAY,CAAClE,QAAQ,CAAC;UAC5DF,QAAQ,CAACuC,IAAI,GAAG;YACZnE,KAAK,EAAEgG,YAAY,CAAC7B,IAAI,CAACnE,KAAK,IAAI4B,QAAQ,CAACuC,IAAI,CAACnE,KAAK;YACrDoE,WAAW,EAAE4B,YAAY,CAAC7B,IAAI,CAACC,WAAW,IAAIxC,QAAQ,CAACuC,IAAI,CAACC,WAAW;YACvEM,QAAQ,EAAEsB,YAAY,CAAC7B,IAAI,CAACO,QAAQ,IAAI9C,QAAQ,CAACuC,IAAI,CAACO,QAAQ;YAC9DC,UAAU,EAAEqB,YAAY,CAAC7B,IAAI,CAACQ,UAAU,IAAI/C,QAAQ,CAACuC,IAAI,CAACQ,UAAU;YACpEG,UAAU,EAAEkB,YAAY,CAAC7B,IAAI,CAACW,UAAU,IAAIlD,QAAQ,CAACuC,IAAI,CAACW;UAC9D,CAAC;UACDlD,QAAQ,CAAC0C,SAAS,GAAG0B,YAAY,CAAC1B,SAAS,IAAI1C,QAAQ,CAAC0C,SAAS;UACjE,OAAOtH,wBAAwB,CAAC4E,QAAQ,CAAC,CAAC,CAAC;QAC/C,CAAC,MAAM;UACHuE,OAAO,CAACG,IAAI,CAAC,wDAAwD,CAAC;QAC1E;MACJ,CAAC,CAAC,OAAOC,UAAU,EAAE;QACjBJ,OAAO,CAACG,IAAI,CAAC,4CAA4C,EAAEC,UAAU,CAACC,OAAO,CAAC;MAClF;IACJ;;IAEA;IACAL,OAAO,CAACC,GAAG,CAAC,8BAA8B,CAAC;;IAE3C;IACA,MAAMK,QAAQ,GAAGxB,GAAG,CAACyB,cAAc,CAAC,YAAY,CAAC;IACjD,IAAID,QAAQ,EAAE;MACV,MAAME,WAAW,GAAGF,QAAQ,CAACG,KAAK;MAClChF,QAAQ,CAACyC,MAAM,GAAG;QACdhF,KAAK,EAAEwH,QAAQ,CAACF,WAAW,CAACtH,KAAK,CAAC,IAAI,IAAI;QAC1CC,MAAM,EAAEqH,WAAW,CAACrH,MAAM,IAAI,MAAM;QACpCoC,UAAU,EAAEiF,WAAW,CAACjF,UAAU,IAAIiF,WAAW,CAAC1F,eAAe,IAAI,SAAS;QAC9E6F,SAAS,EAAEH,WAAW,CAACG,SAAS,IAAI;MACxC,CAAC;IACL;;IAEA;IACA,MAAMnD,QAAQ,GAAGsB,GAAG,CAAC8B,gBAAgB,CAAC,qEAAqE,CAAC;IAC5GpD,QAAQ,CAAC3B,OAAO,CAAC,CAACgF,SAAS,EAAEzG,KAAK,KAAK;MACnC,MAAMK,OAAO,GAAGqG,mBAAmB,CAACD,SAAS,EAAEzG,KAAK,CAAC;MACrD,IAAIK,OAAO,EAAE;QACTgB,QAAQ,CAACE,QAAQ,CAACgB,IAAI,CAAC/F,uBAAuB,CAAC6D,OAAO,EAAE,SAAS,CAAC,CAAC;MACvE;IACJ,CAAC,CAAC;;IAEF;IACA,MAAMW,MAAM,GAAG0D,GAAG,CAAC8B,gBAAgB,CAAC,uCAAuC,CAAC;IAC5ExF,MAAM,CAACS,OAAO,CAAC,CAACkF,OAAO,EAAE3G,KAAK,KAAK;MAC/B,MAAMiB,KAAK,GAAG2F,iBAAiB,CAACD,OAAO,EAAE3G,KAAK,CAAC;MAC/C,IAAIiB,KAAK,EAAE;QACPI,QAAQ,CAACE,QAAQ,CAACgB,IAAI,CAAC/F,uBAAuB,CAACyE,KAAK,EAAE,SAAS,CAAC,CAAC;MACrE;IACJ,CAAC,CAAC;;IAEF;IACA,MAAMoC,kBAAkB,GAAGqB,GAAG,CAAC8B,gBAAgB,CAAC,2HAA2H,CAAC;IAC5KnD,kBAAkB,CAAC5B,OAAO,CAAC,CAACD,EAAE,EAAExB,KAAK,KAAK;MACtC,IAAI,CAACwB,EAAE,CAACqF,OAAO,CAAC,oCAAoC,CAAC,EAAE;QACnD,MAAM9J,OAAO,GAAG+J,sBAAsB,CAACtF,EAAE,EAAExB,KAAK,CAAC;QACjD,IAAIjD,OAAO,EAAE;UACTsE,QAAQ,CAACE,QAAQ,CAACgB,IAAI,CAAC/F,uBAAuB,CAACO,OAAO,EAAE,SAAS,CAAC,CAAC;QACvE;MACJ;IACJ,CAAC,CAAC;;IAEF;IACA,MAAMgK,cAAc,GAAGrC,GAAG,CAAC8B,gBAAgB,CAAC,QAAQ,CAAC;IACrDO,cAAc,CAACtF,OAAO,CAACuF,MAAM,IAAI;MAC7B,MAAM/H,OAAO,GAAG+H,MAAM,CAAClC,WAAW,IAAIkC,MAAM,CAACrB,SAAS;MACtD,MAAMsB,YAAY,GAAGC,uBAAuB,CAACjI,OAAO,CAAC;MACrD,IAAIgI,YAAY,CAAC7G,MAAM,GAAG,CAAC,EAAE;QACzB+G,mBAAmB,CAAC9F,QAAQ,CAACE,QAAQ,EAAE0F,YAAY,CAAC;MACxD;IACJ,CAAC,CAAC;;IAEF;IACA,MAAMG,aAAa,GAAG1C,GAAG,CAAC8B,gBAAgB,CAAC,OAAO,CAAC;IACnDY,aAAa,CAAC3F,OAAO,CAAC4F,OAAO,IAAI;MAC7B,MAAM5D,UAAU,GAAG4D,OAAO,CAACvC,WAAW,IAAIuC,OAAO,CAAC1B,SAAS;MAC3D,MAAM2B,UAAU,GAAGC,wBAAwB,CAAC9D,UAAU,CAAC;MACvD+D,uBAAuB,CAACnG,QAAQ,CAACE,QAAQ,EAAE+F,UAAU,CAAC;IAC1D,CAAC,CAAC;;IAEF;IACA,MAAMG,SAAS,GAAGC,IAAI,CAACC,GAAG,CACtB,GAAGtG,QAAQ,CAACE,QAAQ,CACfvD,MAAM,CAACwD,EAAE,IAAIA,EAAE,CAACpE,OAAO,KAAK,KAAK,CAAC,CAClCe,GAAG,CAACqD,EAAE,IAAI;MAAA,IAAAoG,YAAA,EAAAC,oBAAA,EAAAC,QAAA,EAAAC,gBAAA;MACP,MAAMC,KAAK,GAAG,EAAAJ,YAAA,GAAApG,EAAE,CAAC9D,QAAQ,cAAAkK,YAAA,wBAAAC,oBAAA,GAAXD,YAAA,CAAaK,OAAO,cAAAJ,oBAAA,uBAApBA,oBAAA,CAAsBhJ,CAAC,KAAI,CAAC;MAC1C,MAAMqJ,QAAQ,GAAG,EAAAJ,QAAA,GAAAtG,EAAE,CAAC/D,IAAI,cAAAqK,QAAA,wBAAAC,gBAAA,GAAPD,QAAA,CAASG,OAAO,cAAAF,gBAAA,uBAAhBA,gBAAA,CAAkBhJ,MAAM,KAAI,GAAG;MAChD,OAAOiJ,KAAK,GAAGE,QAAQ;IAC3B,CAAC,CAAC,EACN,IACJ,CAAC;IACD7G,QAAQ,CAACyC,MAAM,CAAC/E,MAAM,GAAG0I,SAAS;IAElC7B,OAAO,CAACC,GAAG,CAAC,6BAA6B,EAAE;MACvCsC,aAAa,EAAE9G,QAAQ,CAACE,QAAQ,CAACnB,MAAM;MACvCgD,QAAQ,EAAE/B,QAAQ,CAACE,QAAQ,CAACvD,MAAM,CAACwD,EAAE,IAAIA,EAAE,CAAClE,IAAI,KAAK,SAAS,CAAC,CAAC8C,MAAM;MACtEY,MAAM,EAAEK,QAAQ,CAACE,QAAQ,CAACvD,MAAM,CAACwD,EAAE,IAAIA,EAAE,CAAClE,IAAI,KAAK,OAAO,CAAC,CAAC8C,MAAM;MAClEgI,UAAU,EAAE/G,QAAQ,CAACE,QAAQ,CAACvD,MAAM,CAACwD,EAAE,IAAIA,EAAE,CAAClE,IAAI,KAAK,SAAS,IAAIkE,EAAE,CAAClE,IAAI,KAAK,OAAO,CAAC,CAAC8C;IAC7F,CAAC,CAAC;IAEF,OAAO3D,wBAAwB,CAAC4E,QAAQ,CAAC;EAE7C,CAAC,CAAC,OAAOgH,KAAK,EAAE;IACZzC,OAAO,CAACyC,KAAK,CAAC,8BAA8B,EAAEA,KAAK,CAAC;IACpD,OAAOhH,QAAQ,CAAC,CAAC;EACrB;AACJ,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA,OAAO,MAAMiH,UAAU,GAAIC,MAAM,IAAK;EAAAC,EAAA;EAClC,MAAM;IAAEC,MAAM;IAAEC,QAAQ;IAAErH,QAAQ;IAAEsH,WAAW;IAAEC,KAAK;IAAEC;EAAI,CAAC,GAAGN,MAAM;EAEtE,OAAOjM,WAAW,CAAC,YAAY;IAC3B,IAAI,CAACmM,MAAM,EAAE;MACTG,KAAK,CAACP,KAAK,CAAC,0BAA0B,CAAC;MACvC;IACJ;IACAM,WAAW,CAAC,IAAI,CAAC,CAAC,CAAC;IACnB,IAAI;MACA;MACA,MAAMxF,mBAAmB,GAAG1G,wBAAwB,CAAC4E,QAAQ,CAAC;MAC9D,MAAMyH,cAAc,GAAG;QACnB,GAAG3F,mBAAmB;QACtB5B,QAAQ,EAAE4B,mBAAmB,CAAC5B,QAAQ,CAACpD,GAAG,CAACpB,OAAO,IAAIP,uBAAuB,CAACO,OAAO,EAAE,SAAS,CAAC;MACrG,CAAC;MACD,MAAMgM,WAAW,GAAGjG,gBAAgB,CAACgG,cAAc,CAAC;MACpD,MAAME,QAAQ,GAAG,MAAMH,GAAG,CAACI,GAAG,CAAC,cAAcR,MAAM,EAAE,EAAE;QAAES,IAAI,EAAEH,WAAW;QAAE1H,QAAQ,EAAEyH;MAAe,CAAC,CAAC;MACvG,IAAIE,QAAQ,CAACG,IAAI,CAACC,OAAO,EAAE;QACvBR,KAAK,CAACQ,OAAO,CAAC,0BAA0BN,cAAc,CAACvH,QAAQ,CAACnB,MAAM,WAAW,CAAC;QAClF,IAAI,CAAC4I,QAAQ,CAACG,IAAI,CAACE,IAAI,CAACC,cAAc,EAAE;UACpCV,KAAK,CAAC7C,IAAI,CAAC,sDAAsD,CAAC;UAClE,IAAI;YACA,MAAM8C,GAAG,CAACU,GAAG,CAAC,mCAAmC,CAAC;YAClDX,KAAK,CAACQ,OAAO,CAAC,uCAAuC,CAAC;UAC1D,CAAC,CAAC,OAAOI,GAAG,EAAE;YAAA,IAAAC,aAAA,EAAAC,kBAAA;YACV9D,OAAO,CAACyC,KAAK,CAAC,iCAAiC,EAAEmB,GAAG,CAAC;YACrDZ,KAAK,CAACP,KAAK,CAAC,uCAAuC,IAAI,EAAAoB,aAAA,GAAAD,GAAG,CAACR,QAAQ,cAAAS,aAAA,wBAAAC,kBAAA,GAAZD,aAAA,CAAcN,IAAI,cAAAO,kBAAA,uBAAlBA,kBAAA,CAAoBrB,KAAK,KAAImB,GAAG,CAACvD,OAAO,CAAC,CAAC;UACrG;QACJ;QACA;QACAyC,QAAQ,CAAC,QAAQ,CAAC;MACtB;IACJ,CAAC,CAAC,OAAOL,KAAK,EAAE;MAAA,IAAAsB,eAAA,EAAAC,oBAAA,EAAAC,gBAAA;MACZjE,OAAO,CAACyC,KAAK,CAAC,oBAAoB,EAAEA,KAAK,CAAC;MAC1CO,KAAK,CAACP,KAAK,CAAC,qBAAqB,IAAI,EAAAsB,eAAA,GAAAtB,KAAK,CAACW,QAAQ,cAAAW,eAAA,wBAAAC,oBAAA,GAAdD,eAAA,CAAgBR,IAAI,cAAAS,oBAAA,uBAApBA,oBAAA,CAAsBvB,KAAK,KAAIA,KAAK,CAACpC,OAAO,CAAC,CAAC;MACnF,IAAI,EAAA4D,gBAAA,GAAAxB,KAAK,CAACW,QAAQ,cAAAa,gBAAA,uBAAdA,gBAAA,CAAgBC,MAAM,MAAK,GAAG,EAAE;QAChCC,YAAY,CAACC,UAAU,CAAC,OAAO,CAAC;QAChCtB,QAAQ,CAAC,OAAO,CAAC;MACrB;IACJ,CAAC,SAAS;MACNC,WAAW,CAAC,KAAK,CAAC,CAAC,CAAC;IACxB;EACJ,CAAC,EAAE,CAACF,MAAM,EAAEC,QAAQ,EAAErH,QAAQ,EAAEsH,WAAW,EAAEC,KAAK,EAAEC,GAAG,CAAC,CAAC;AAC7D,CAAC;;AAED;AACA;AACA;AACA;AACA;AAJAL,EAAA,CA9CaF,UAAU;AAmDvB,OAAO,MAAM2B,aAAa,GAAI1B,MAAM,IAAK;EAAA2B,GAAA;EACrC,MAAM;IAAE7I,QAAQ;IAAE8I,cAAc;IAAEC;EAAe,CAAC,GAAG7B,MAAM;EAE3D,OAAOjM,WAAW,CAAC,MAAM;IACrB,IAAI;MACA;MACA,MAAM6G,mBAAmB,GAAG1G,wBAAwB,CAAC4E,QAAQ,CAAC;MAC9D;MACA,MAAMgJ,aAAa,GAAG;QAClB,GAAGlH,mBAAmB;QACtB5B,QAAQ,EAAE4B,mBAAmB,CAAC5B,QAAQ,CAACvD,MAAM,CACzCwD,EAAE,IAAIA,EAAE,CAACnE,EAAE,IAAImE,EAAE,CAAClE,IAAI,IAAIkE,EAAE,CAACpE,OAAO,KAAK,KAC7C;MACJ,CAAC;MACD,MAAM2L,WAAW,GAAGjG,gBAAgB,CAACuH,aAAa,CAAC;MACnDF,cAAc,CAACpB,WAAW,CAAC;MAC3BqB,cAAc,CAAC,IAAI,CAAC;IACxB,CAAC,CAAC,OAAO/B,KAAK,EAAE;MAAA,IAAAiC,aAAA;MACZ1E,OAAO,CAACyC,KAAK,CAAC,sBAAsB,EAAEA,KAAK,CAAC;MAC5C,CAAAiC,aAAA,GAAA/B,MAAM,CAACK,KAAK,cAAA0B,aAAA,uBAAZA,aAAA,CAAcjC,KAAK,CAAC,uBAAuB,IAAIA,KAAK,CAACpC,OAAO,IAAI,gBAAgB,CAAC,CAAC;IACtF;EACJ,CAAC,EAAE,CAAC5E,QAAQ,EAAE8I,cAAc,EAAEC,cAAc,EAAE7B,MAAM,CAACK,KAAK,CAAC,CAAC;AAChE,CAAC;;AAED;AACA;AACA;AACA;AACA;AAJAsB,GAAA,CAxBaD,aAAa;AA6B1B,MAAMnE,iBAAiB,GAAIvE,QAAQ,IAAK;EACpC,OAAOA,QAAQ,CACVvD,MAAM,CAACwD,EAAE,IAAIA,EAAE,CAACnE,EAAE,IAAImE,EAAE,CAAClE,IAAI,CAAC,CAAC;EAAA,CAC/Ba,GAAG,CAACqD,EAAE;IAAA,IAAA+I,aAAA,EAAAC,aAAA,EAAAC,aAAA,EAAAC,aAAA,EAAAC,aAAA,EAAAC,SAAA,EAAAC,SAAA,EAAAC,SAAA,EAAAC,oBAAA,EAAAC,qBAAA,EAAAC,qBAAA;IAAA,OAAK;MACR5N,EAAE,EAAEmE,EAAE,CAACnE,EAAE,IAAI,WAAWgH,IAAI,CAAC6G,GAAG,CAAC,CAAC,IAAIxD,IAAI,CAACyD,MAAM,CAAC,CAAC,CAACC,QAAQ,CAAC,EAAE,CAAC,CAACC,KAAK,CAAC,CAAC,CAAC,EAAE;MAC3E/N,IAAI,EAAEkE,EAAE,CAAClE,IAAI,IAAI,SAAS;MAC1BC,aAAa,EAAEiE,EAAE,CAACjE,aAAa,IAAI,CAAC,CAAC;MACrCG,QAAQ,EAAE;QACNuK,OAAO,EAAE,EAAAsC,aAAA,GAAA/I,EAAE,CAAC9D,QAAQ,cAAA6M,aAAA,uBAAXA,aAAA,CAAatC,OAAO,KAAI;UAAErJ,CAAC,EAAE,CAAC;UAAEC,CAAC,EAAE,CAAC;UAAEiD,CAAC,EAAE;QAAE,CAAC;QACrDwJ,MAAM,EAAE,EAAAd,aAAA,GAAAhJ,EAAE,CAAC9D,QAAQ,cAAA8M,aAAA,uBAAXA,aAAA,CAAac,MAAM,OAAAb,aAAA,GAAIjJ,EAAE,CAAC9D,QAAQ,cAAA+M,aAAA,uBAAXA,aAAA,CAAaxC,OAAO,KAAI;UAAErJ,CAAC,EAAE,CAAC;UAAEC,CAAC,EAAE,CAAC;UAAEiD,CAAC,EAAE;QAAE,CAAC;QAC3EyJ,MAAM,EAAE,EAAAb,aAAA,GAAAlJ,EAAE,CAAC9D,QAAQ,cAAAgN,aAAA,uBAAXA,aAAA,CAAaa,MAAM,OAAAZ,aAAA,GAAInJ,EAAE,CAAC9D,QAAQ,cAAAiN,aAAA,uBAAXA,aAAA,CAAa1C,OAAO,KAAI;UAAErJ,CAAC,EAAE,CAAC;UAAEC,CAAC,EAAE,CAAC;UAAEiD,CAAC,EAAE;QAAE;MAC9E,CAAC;MACDrE,IAAI,EAAE;QACFwK,OAAO,EAAE,EAAA2C,SAAA,GAAApJ,EAAE,CAAC/D,IAAI,cAAAmN,SAAA,uBAAPA,SAAA,CAAS3C,OAAO,KAAIzG,EAAE,CAAC/D,IAAI,IAAI;UAAEqB,KAAK,EAAE0C,EAAE,CAAClE,IAAI,KAAK,OAAO,GAAG,GAAG,GAAG,IAAI;UAAEyB,MAAM,EAAE;QAAI,CAAC;QAChGuM,MAAM,EAAE,EAAAT,SAAA,GAAArJ,EAAE,CAAC/D,IAAI,cAAAoN,SAAA,uBAAPA,SAAA,CAASS,MAAM,KAAI3O,aAAa,CAAC6E,EAAE,EAAE,SAAS,EAAE,QAAQ,CAAC;QACjE+J,MAAM,EAAE,EAAAT,SAAA,GAAAtJ,EAAE,CAAC/D,IAAI,cAAAqN,SAAA,uBAAPA,SAAA,CAASS,MAAM,KAAI5O,aAAa,CAAC6E,EAAE,EAAE,SAAS,EAAE,QAAQ;MACpE,CAAC;MACDhE,MAAM,EAAEgE,EAAE,CAAChE,MAAM,IAAI,CAAC,CAAC;MACvBG,gBAAgB,EAAE;QACdsK,OAAO,EAAE,EAAA8C,oBAAA,GAAAvJ,EAAE,CAAC7D,gBAAgB,cAAAoN,oBAAA,uBAAnBA,oBAAA,CAAqB9C,OAAO,KAAI,CAAC,CAAC;QAC3CqD,MAAM,EAAE,EAAAN,qBAAA,GAAAxJ,EAAE,CAAC7D,gBAAgB,cAAAqN,qBAAA,uBAAnBA,qBAAA,CAAqBM,MAAM,KAAI5O,eAAe,CAAC8E,EAAE,CAAChE,MAAM,EAAE,SAAS,EAAE,QAAQ,CAAC;QACtF+N,MAAM,EAAE,EAAAN,qBAAA,GAAAzJ,EAAE,CAAC7D,gBAAgB,cAAAsN,qBAAA,uBAAnBA,qBAAA,CAAqBM,MAAM,KAAI7O,eAAe,CAAC8E,EAAE,CAAChE,MAAM,EAAE,SAAS,EAAE,QAAQ;MACzF,CAAC;MACD+C,QAAQ,EAAEiC,KAAK,CAACC,OAAO,CAACjB,EAAE,CAACjB,QAAQ,CAAC,GAAGuF,iBAAiB,CAACtE,EAAE,CAACjB,QAAQ,CAAC,GAAG,EAAE;MAC1EnD,OAAO,EAAEoE,EAAE,CAACpE,OAAO,KAAK,KAAK;MAC7BoO,MAAM,EAAE,CAAC,CAAChK,EAAE,CAACgK;IACjB,CAAC;EAAA,CAAC,CAAC;AACX,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA,MAAM9E,mBAAmB,GAAGA,CAACD,SAAS,EAAEzG,KAAK,KAAK;EAAA,IAAAyL,UAAA,EAAAC,YAAA,EAAAC,aAAA;EAC9C,MAAMtO,EAAE,GAAGoJ,SAAS,CAACpJ,EAAE,IAAIoJ,SAAS,CAACxB,YAAY,CAAC,iBAAiB,CAAC,IAAI,WAAWZ,IAAI,CAAC6G,GAAG,CAAC,CAAC,IAAIlL,KAAK,EAAE;EACxG,MAAMqG,KAAK,GAAGI,SAAS,CAACJ,KAAK;EAE7B,MAAMuF,QAAQ,GAAG,EAAAH,UAAA,GAAApF,KAAK,CAACwF,GAAG,cAAAJ,UAAA,uBAATA,UAAA,CAAWlG,KAAK,CAAC,SAAS,CAAC,KAAI,CAAC,GAAG,CAAC;EACrD,MAAMsG,GAAG,GAAGvF,QAAQ,CAACsF,QAAQ,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC;EACtC,MAAME,UAAU,GAAG,EAAAJ,YAAA,GAAArF,KAAK,CAACvH,KAAK,cAAA4M,YAAA,uBAAXA,YAAA,CAAanG,KAAK,CAAC,SAAS,CAAC,KAAI,CAAC,MAAM,CAAC;EAC5D,MAAMwG,WAAW,GAAG,EAAAJ,aAAA,GAAAtF,KAAK,CAACtH,MAAM,cAAA4M,aAAA,uBAAZA,aAAA,CAAcpG,KAAK,CAAC,SAAS,CAAC,KAAI,CAAC,KAAK,CAAC;EAC7D,MAAMzG,KAAK,GAAGwH,QAAQ,CAACwF,UAAU,CAAC,CAAC,CAAC,CAAC,IAAI,IAAI;EAC7C,MAAM/M,MAAM,GAAGuH,QAAQ,CAACyF,WAAW,CAAC,CAAC,CAAC,CAAC,IAAI,GAAG;EAE9C,MAAMC,IAAI,GAAGvF,SAAS,CAAC5B,aAAa,CAAC,0BAA0B,CAAC;EAChE,MAAMoH,SAAS,GAAGxF,SAAS,CAAC5B,aAAa,CAAC,eAAe,CAAC;EAC1D,MAAMqH,WAAW,GAAGzF,SAAS,CAAC5B,aAAa,CAAC,iBAAiB,CAAC;EAE9D,MAAMtH,aAAa,GAAG;IAAE4O,SAAS,EAAE1F,SAAS,CAAC2F,SAAS,CAACC,QAAQ,CAAC,cAAc,CAAC,GAAG,eAAe,GAAG;EAAW,CAAC;EAEhH,IAAIL,IAAI,EAAE;IAAA,IAAAM,qBAAA;IACN,MAAMC,OAAO,GAAGP,IAAI,CAAC3F,KAAK;IAC1B9I,aAAa,CAACmD,eAAe,GAAG6L,OAAO,CAAC7L,eAAe,IAAI,aAAa;IACxE,MAAM8L,YAAY,IAAAF,qBAAA,GAAGC,OAAO,CAAC5L,eAAe,cAAA2L,qBAAA,uBAAvBA,qBAAA,CAAyB/G,KAAK,CAAC,wBAAwB,CAAC;IAC7E,IAAIiH,YAAY,EAAE;MACdjP,aAAa,CAACoD,eAAe,GAAG6L,YAAY,CAAC,CAAC,CAAC;MAC/CjP,aAAa,CAACkP,cAAc,GAAG,OAAO;IAC1C,CAAC,MAAM,IAAIlP,aAAa,CAACmD,eAAe,KAAK,aAAa,EAAE;MACxDnD,aAAa,CAACkP,cAAc,GAAG,OAAO;IAC1C;IACAlP,aAAa,CAACmP,kBAAkB,GAAGH,OAAO,CAACG,kBAAkB,IAAI,QAAQ;IACzEnP,aAAa,CAACoP,cAAc,GAAGJ,OAAO,CAACI,cAAc,IAAI,OAAO;EACpE;EAEA,IAAIV,SAAS,EAAE;IACX1O,aAAa,CAACqD,YAAY,GAAGqL,SAAS,CAAC5F,KAAK,CAAC3F,eAAe,IAAI,aAAa;IAC7EnD,aAAa,CAACsD,cAAc,GAAG+L,UAAU,CAACX,SAAS,CAAC5F,KAAK,CAACwG,OAAO,CAAC,IAAI,CAAC;EAC3E;EAEA,MAAMrP,MAAM,GAAGsP,iBAAiB,CAACzG,KAAK,EAAEI,SAAS,CAAC;EAClD,IAAIyF,WAAW,EAAE;IACb3O,aAAa,CAACuD,OAAO,GAAGoL,WAAW,CAAC7F,KAAK,CAACvF,OAAO,IAAI,MAAM;EAC/D;EAEA,MAAMP,QAAQ,GAAG,EAAE;EACnB,IAAI2L,WAAW,EAAE;IACb,MAAMa,aAAa,GAAGb,WAAW,CAAC1F,gBAAgB,CAAC,mDAAmD,CAAC;IACvGuG,aAAa,CAACtL,OAAO,CAACuL,OAAO,IAAI;MAC7B,IAAIA,OAAO,CAACnG,OAAO,CAAC,iBAAiB,CAAC,KAAKqF,WAAW,EAAE;QACpD,MAAMzL,KAAK,GAAGwM,iBAAiB,CAACD,OAAO,EAAE3P,EAAE,CAAC;QAC5C,IAAIoD,KAAK,EAAE;UACPF,QAAQ,CAACgC,IAAI,CAAC9B,KAAK,CAAC;QACxB;MACJ;IACJ,CAAC,CAAC;EACN;EAEA,OAAO;IACHpD,EAAE;IACFC,IAAI,EAAE,SAAS;IACfC,aAAa;IACbG,QAAQ,EAAE;MACNuK,OAAO,EAAE;QAAErJ,CAAC,EAAE,CAAC;QAAEC,CAAC,EAAEgN,GAAG;QAAE/J,CAAC,EAAEwE,QAAQ,CAACD,KAAK,CAAC6G,MAAM,CAAC,IAAIlN,KAAK,GAAG;MAAE,CAAC;MACjEsL,MAAM,EAAE1O,iBAAiB,CAAC;QAAEc,QAAQ,EAAE;UAAEuK,OAAO,EAAE;YAAErJ,CAAC,EAAE,CAAC;YAAEC,CAAC,EAAEgN,GAAG;YAAE/J,CAAC,EAAEwE,QAAQ,CAACD,KAAK,CAAC6G,MAAM,CAAC,IAAIlN,KAAK,GAAG;UAAE;QAAE;MAAE,CAAC,EAAE,SAAS,EAAE,QAAQ,EAAE;QAAElB,KAAK;QAAEC;MAAO,CAAC,CAAC;MACtJwM,MAAM,EAAE3O,iBAAiB,CAAC;QAAEc,QAAQ,EAAE;UAAEuK,OAAO,EAAE;YAAErJ,CAAC,EAAE,CAAC;YAAEC,CAAC,EAAEgN,GAAG;YAAE/J,CAAC,EAAEwE,QAAQ,CAACD,KAAK,CAAC6G,MAAM,CAAC,IAAIlN,KAAK,GAAG;UAAE;QAAE;MAAE,CAAC,EAAE,SAAS,EAAE,QAAQ,EAAE;QAAElB,KAAK;QAAEC;MAAO,CAAC;IACzJ,CAAC;IACDtB,IAAI,EAAE;MACFwK,OAAO,EAAE;QAAEnJ,KAAK;QAAEC;MAAO,CAAC;MAC1BuM,MAAM,EAAE3O,aAAa,CAAC;QAAEc,IAAI,EAAE;UAAEwK,OAAO,EAAE;YAAEnJ,KAAK;YAAEC;UAAO;QAAE;MAAE,CAAC,EAAE,SAAS,EAAE,QAAQ,CAAC;MACpFwM,MAAM,EAAE5O,aAAa,CAAC;QAAEc,IAAI,EAAE;UAAEwK,OAAO,EAAE;YAAEnJ,KAAK;YAAEC;UAAO;QAAE;MAAE,CAAC,EAAE,SAAS,EAAE,QAAQ;IACvF,CAAC;IACDvB,MAAM;IACNG,gBAAgB,EAAE;MACdsK,OAAO,EAAE,CAAC,CAAC;MACXqD,MAAM,EAAE5O,eAAe,CAACc,MAAM,EAAE,SAAS,EAAE,QAAQ,CAAC;MACpD+N,MAAM,EAAE7O,eAAe,CAACc,MAAM,EAAE,SAAS,EAAE,QAAQ;IACvD,CAAC;IACD+C,QAAQ;IACRnD,OAAO,EAAEiJ,KAAK,CAACxG,OAAO,KAAK,MAAM;IACjC2L,MAAM,EAAE/E,SAAS,CAAC2F,SAAS,CAACC,QAAQ,CAAC,oBAAoB;EAC7D,CAAC;AACL,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA,MAAMzF,iBAAiB,GAAGA,CAACD,OAAO,EAAE3G,KAAK,KAAK;EAAA,IAAAmN,qBAAA,EAAAC,qBAAA;EAC1C,MAAM/P,EAAE,GAAGsJ,OAAO,CAACtJ,EAAE,IAAIsJ,OAAO,CAAC1B,YAAY,CAAC,iBAAiB,CAAC,IAAI,SAASZ,IAAI,CAAC6G,GAAG,CAAC,CAAC,IAAIlL,KAAK,EAAE;EAClG,MAAMkM,WAAW,GAAGvF,OAAO,CAAC9B,aAAa,CAAC,sBAAsB,CAAC;EACjE,IAAI,CAACqH,WAAW,EAAE,OAAO,IAAI;EAE7B,MAAMJ,UAAU,GAAG,EAAAqB,qBAAA,GAAAjB,WAAW,CAAC7F,KAAK,CAACvH,KAAK,cAAAqO,qBAAA,uBAAvBA,qBAAA,CAAyB5H,KAAK,CAAC,SAAS,CAAC,KAAI,CAAC,KAAK,CAAC;EACvE,MAAM8H,cAAc,GAAG,EAAAD,qBAAA,GAAAlB,WAAW,CAAC7F,KAAK,CAACE,SAAS,cAAA6G,qBAAA,uBAA3BA,qBAAA,CAA6B7H,KAAK,CAAC,SAAS,CAAC,KAAI,CAAC,KAAK,CAAC;EAC/E,MAAMzG,KAAK,GAAGwH,QAAQ,CAACwF,UAAU,CAAC,CAAC,CAAC,CAAC,IAAI,GAAG;EAC5C,MAAM/M,MAAM,GAAGuH,QAAQ,CAAC+G,cAAc,CAAC,CAAC,CAAC,CAAC,IAAI,GAAG;EAEjD,MAAMC,QAAQ,GAAG3G,OAAO,CAAC9B,aAAa,CAAC,sBAAsB,CAAC;EAC9D,MAAM0I,MAAM,GAAG5G,OAAO,CAAC9B,aAAa,CAAC,iBAAiB,CAAC;EAEvD,MAAMtH,aAAa,GAAG;IAClBkC,KAAK,EAAE,CAAA6N,QAAQ,aAARA,QAAQ,uBAARA,QAAQ,CAAExI,WAAW,CAACC,IAAI,CAAC,CAAC,KAAI,OAAO;IAC9C5D,UAAU,EAAE+K,WAAW,CAAC7F,KAAK,CAAClF,UAAU,IAAI,2BAA2B;IACvElB,YAAY,EAAEiM,WAAW,CAAC7F,KAAK,CAACpG,YAAY,IAAI,MAAM;IACtDa,OAAO,EAAE,CAAAyM,MAAM,aAANA,MAAM,uBAANA,MAAM,CAAElH,KAAK,CAACvF,OAAO,KAAI;EACtC,CAAC;EAED,MAAMtD,MAAM,GAAGsP,iBAAiB,CAACZ,WAAW,CAAC7F,KAAK,EAAEM,OAAO,CAAC;EAE5D,MAAMpG,QAAQ,GAAG,EAAE;EACnB,IAAIgN,MAAM,EAAE;IACR,MAAMR,aAAa,GAAGQ,MAAM,CAAC/G,gBAAgB,CAAC,mDAAmD,CAAC;IAClGuG,aAAa,CAACtL,OAAO,CAACuL,OAAO,IAAI;MAC7B,IAAIA,OAAO,CAACnG,OAAO,CAAC,iBAAiB,CAAC,KAAK0G,MAAM,EAAE;QAC/C,MAAM9M,KAAK,GAAGwM,iBAAiB,CAACD,OAAO,EAAE3P,EAAE,CAAC;QAC5C,IAAIoD,KAAK,EAAE;UACPF,QAAQ,CAACgC,IAAI,CAAC9B,KAAK,CAAC;QACxB;MACJ;IACJ,CAAC,CAAC;EACN;EAEA,OAAO;IACHpD,EAAE;IACFC,IAAI,EAAE,OAAO;IACbC,aAAa;IACbG,QAAQ,EAAE;MACNuK,OAAO,EAAE;QAAErJ,CAAC,EAAE,CAAC;QAAEC,CAAC,EAAE,CAAC;QAAEiD,CAAC,EAAEwE,QAAQ,CAAC4F,WAAW,CAAC7F,KAAK,CAAC6G,MAAM,CAAC,IAAI;MAAK,CAAC;MACtE5B,MAAM,EAAE;QAAE1M,CAAC,EAAE,CAAC;QAAEC,CAAC,EAAE,CAAC;QAAEiD,CAAC,EAAEwE,QAAQ,CAAC4F,WAAW,CAAC7F,KAAK,CAAC6G,MAAM,CAAC,IAAI;MAAK,CAAC;MACrE3B,MAAM,EAAE;QAAE3M,CAAC,EAAE,CAAC;QAAEC,CAAC,EAAE,CAAC;QAAEiD,CAAC,EAAEwE,QAAQ,CAAC4F,WAAW,CAAC7F,KAAK,CAAC6G,MAAM,CAAC,IAAI;MAAK;IACxE,CAAC;IACDzP,IAAI,EAAE;MACFwK,OAAO,EAAE;QAAEnJ,KAAK;QAAEC;MAAO,CAAC;MAC1BuM,MAAM,EAAE3O,aAAa,CAAC;QAAEc,IAAI,EAAE;UAAEwK,OAAO,EAAE;YAAEnJ,KAAK;YAAEC;UAAO;QAAE;MAAE,CAAC,EAAE,SAAS,EAAE,QAAQ,CAAC;MACpFwM,MAAM,EAAE5O,aAAa,CAAC;QAAEc,IAAI,EAAE;UAAEwK,OAAO,EAAE;YAAEnJ,KAAK;YAAEC;UAAO;QAAE;MAAE,CAAC,EAAE,SAAS,EAAE,QAAQ;IACvF,CAAC;IACDvB,MAAM;IACNG,gBAAgB,EAAE;MACdsK,OAAO,EAAE,CAAC,CAAC;MACXqD,MAAM,EAAE5O,eAAe,CAACc,MAAM,EAAE,SAAS,EAAE,QAAQ,CAAC;MACpD+N,MAAM,EAAE7O,eAAe,CAACc,MAAM,EAAE,SAAS,EAAE,QAAQ;IACvD,CAAC;IACD+C,QAAQ;IACRnD,OAAO,EAAEuJ,OAAO,CAACyF,SAAS,CAACC,QAAQ,CAAC,kBAAkB,CAAC,IAAI1F,OAAO,CAACN,KAAK,CAACxG,OAAO,KAAK,MAAM;IAC3F2L,MAAM,EAAE7E,OAAO,CAACyF,SAAS,CAACC,QAAQ,CAAC,oBAAoB;EAC3D,CAAC;AACL,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA,MAAMvF,sBAAsB,GAAGA,CAAC/J,OAAO,EAAEiD,KAAK,KAAK;EAAA,IAAAwN,WAAA,EAAAC,WAAA,EAAAC,aAAA,EAAAC,cAAA;EAC/C,MAAMtQ,EAAE,GAAGN,OAAO,CAACM,EAAE,IAAIN,OAAO,CAACkI,YAAY,CAAC,iBAAiB,CAAC,IAAI,WAAWZ,IAAI,CAAC6G,GAAG,CAAC,CAAC,IAAIlL,KAAK,EAAE;EACpG,MAAM1C,IAAI,GAAGP,OAAO,CAACkI,YAAY,CAAC,WAAW,CAAC,IAAI2I,oBAAoB,CAAC7Q,OAAO,CAAC;EAC/E,MAAMsJ,KAAK,GAAGtJ,OAAO,CAACsJ,KAAK;EAE3B,MAAMwH,SAAS,GAAG,EAAAL,WAAA,GAAAnH,KAAK,CAACyH,IAAI,cAAAN,WAAA,uBAAVA,WAAA,CAAYjI,KAAK,CAAC,SAAS,CAAC,KAAI,CAAC,GAAG,CAAC;EACvD,MAAMqG,QAAQ,GAAG,EAAA6B,WAAA,GAAApH,KAAK,CAACwF,GAAG,cAAA4B,WAAA,uBAATA,WAAA,CAAWlI,KAAK,CAAC,SAAS,CAAC,KAAI,CAAC,GAAG,CAAC;EACrD,MAAMuG,UAAU,GAAG,EAAA4B,aAAA,GAAArH,KAAK,CAACvH,KAAK,cAAA4O,aAAA,uBAAXA,aAAA,CAAanI,KAAK,CAAC,SAAS,CAAC,KAAI,CAACjI,IAAI,KAAK,SAAS,GAAG,KAAK,GAAG,KAAK,CAAC;EACxF,MAAMyO,WAAW,GAAG,EAAA4B,cAAA,GAAAtH,KAAK,CAACtH,MAAM,cAAA4O,cAAA,uBAAZA,cAAA,CAAcpI,KAAK,CAAC,SAAS,CAAC,KAAI,CAACjI,IAAI,KAAK,SAAS,GAAG,KAAK,GAAG,IAAI,CAAC;EACzF,MAAMwQ,IAAI,GAAGxH,QAAQ,CAACuH,SAAS,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC;EACxC,MAAMhC,GAAG,GAAGvF,QAAQ,CAACsF,QAAQ,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC;EACtC,MAAM9M,KAAK,GAAGwH,QAAQ,CAACwF,UAAU,CAAC,CAAC,CAAC,CAAC,KAAKxO,IAAI,KAAK,SAAS,GAAG,GAAG,GAAGA,IAAI,KAAK,MAAM,GAAG,EAAE,GAAG,GAAG,CAAC;EAChG,MAAMyB,MAAM,GAAGuH,QAAQ,CAACyF,WAAW,CAAC,CAAC,CAAC,CAAC,KAAKzO,IAAI,KAAK,SAAS,GAAG,GAAG,GAAGA,IAAI,KAAK,MAAM,GAAG,EAAE,GAAG,EAAE,CAAC;EAEjG,MAAME,MAAM,GAAGsP,iBAAiB,CAACzG,KAAK,EAAEtJ,OAAO,CAAC;EAChD,MAAMQ,aAAa,GAAGwQ,kBAAkB,CAAChR,OAAO,EAAEO,IAAI,CAAC;EAEvD,OAAO;IACHD,EAAE;IACFC,IAAI;IACJC,aAAa;IACbG,QAAQ,EAAE;MACNuK,OAAO,EAAE;QAAErJ,CAAC,EAAEkP,IAAI;QAAEjP,CAAC,EAAEgN,GAAG;QAAE/J,CAAC,EAAEwE,QAAQ,CAACD,KAAK,CAAC6G,MAAM,CAAC,IAAIlN,KAAK,GAAG;MAAE,CAAC;MACpEsL,MAAM,EAAE1O,iBAAiB,CAAC;QAAEc,QAAQ,EAAE;UAAEuK,OAAO,EAAE;YAAErJ,CAAC,EAAEkP,IAAI;YAAEjP,CAAC,EAAEgN,GAAG;YAAE/J,CAAC,EAAEwE,QAAQ,CAACD,KAAK,CAAC6G,MAAM,CAAC,IAAIlN,KAAK,GAAG;UAAE;QAAE;MAAE,CAAC,EAAE,SAAS,EAAE,QAAQ,EAAE;QAAElB,KAAK;QAAEC;MAAO,CAAC,CAAC;MACzJwM,MAAM,EAAE3O,iBAAiB,CAAC;QAAEc,QAAQ,EAAE;UAAEuK,OAAO,EAAE;YAAErJ,CAAC,EAAEkP,IAAI;YAAEjP,CAAC,EAAEgN,GAAG;YAAE/J,CAAC,EAAEwE,QAAQ,CAACD,KAAK,CAAC6G,MAAM,CAAC,IAAIlN,KAAK,GAAG;UAAE;QAAE;MAAE,CAAC,EAAE,SAAS,EAAE,QAAQ,EAAE;QAAElB,KAAK;QAAEC;MAAO,CAAC;IAC5J,CAAC;IACDtB,IAAI,EAAE;MACFwK,OAAO,EAAE;QAAEnJ,KAAK;QAAEC;MAAO,CAAC;MAC1BuM,MAAM,EAAE3O,aAAa,CAAC;QAAEc,IAAI,EAAE;UAAEwK,OAAO,EAAE;YAAEnJ,KAAK;YAAEC;UAAO;QAAE;MAAE,CAAC,EAAE,SAAS,EAAE,QAAQ,CAAC;MACpFwM,MAAM,EAAE5O,aAAa,CAAC;QAAEc,IAAI,EAAE;UAAEwK,OAAO,EAAE;YAAEnJ,KAAK;YAAEC;UAAO;QAAE;MAAE,CAAC,EAAE,SAAS,EAAE,QAAQ;IACvF,CAAC;IACDvB,MAAM;IACNG,gBAAgB,EAAE;MACdsK,OAAO,EAAE,CAAC,CAAC;MACXqD,MAAM,EAAE5O,eAAe,CAACc,MAAM,EAAE,SAAS,EAAE,QAAQ,CAAC;MACpD+N,MAAM,EAAE7O,eAAe,CAACc,MAAM,EAAE,SAAS,EAAE,QAAQ;IACvD,CAAC;IACD+C,QAAQ,EAAE,EAAE;IACZnD,OAAO,EAAEiJ,KAAK,CAACxG,OAAO,KAAK,MAAM;IACjC2L,MAAM,EAAEzO,OAAO,CAACqP,SAAS,CAACC,QAAQ,CAAC,oBAAoB;EAC3D,CAAC;AACL,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA,MAAMY,iBAAiB,GAAGA,CAAClQ,OAAO,EAAEqF,QAAQ,KAAK;EAAA,IAAA4L,YAAA,EAAAC,WAAA,EAAAC,aAAA,EAAAC,cAAA;EAC7C,MAAM9Q,EAAE,GAAGN,OAAO,CAACM,EAAE,IAAIN,OAAO,CAACkI,YAAY,CAAC,iBAAiB,CAAC,IAAI,SAASZ,IAAI,CAAC6G,GAAG,CAAC,CAAC,IAAIxD,IAAI,CAACyD,MAAM,CAAC,CAAC,CAACC,QAAQ,CAAC,EAAE,CAAC,CAACC,KAAK,CAAC,CAAC,CAAC,EAAE;EAChI,MAAM/N,IAAI,GAAGP,OAAO,CAACkI,YAAY,CAAC,WAAW,CAAC,IAAI2I,oBAAoB,CAAC7Q,OAAO,CAAC;EAC/E,MAAMsJ,KAAK,GAAGtJ,OAAO,CAACsJ,KAAK;EAE3B,MAAMwH,SAAS,GAAG,EAAAG,YAAA,GAAA3H,KAAK,CAACyH,IAAI,cAAAE,YAAA,uBAAVA,YAAA,CAAYzI,KAAK,CAAC,SAAS,CAAC,KAAI,CAAC,GAAG,CAAC;EACvD,MAAMqG,QAAQ,GAAG,EAAAqC,WAAA,GAAA5H,KAAK,CAACwF,GAAG,cAAAoC,WAAA,uBAATA,WAAA,CAAW1I,KAAK,CAAC,SAAS,CAAC,KAAI,CAAC,GAAG,CAAC;EACrD,MAAMuG,UAAU,GAAG,EAAAoC,aAAA,GAAA7H,KAAK,CAACvH,KAAK,cAAAoP,aAAA,uBAAXA,aAAA,CAAa3I,KAAK,CAAC,SAAS,CAAC,KAAI,CAACjI,IAAI,KAAK,SAAS,GAAG,KAAK,GAAG,KAAK,CAAC;EACxF,MAAMyO,WAAW,GAAG,EAAAoC,cAAA,GAAA9H,KAAK,CAACtH,MAAM,cAAAoP,cAAA,uBAAZA,cAAA,CAAc5I,KAAK,CAAC,SAAS,CAAC,KAAI,CAACjI,IAAI,KAAK,SAAS,GAAG,KAAK,GAAG,IAAI,CAAC;EACzF,MAAMwQ,IAAI,GAAGxH,QAAQ,CAACuH,SAAS,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC;EACxC,MAAMhC,GAAG,GAAGvF,QAAQ,CAACsF,QAAQ,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC;EACtC,MAAM9M,KAAK,GAAGwH,QAAQ,CAACwF,UAAU,CAAC,CAAC,CAAC,CAAC,KAAKxO,IAAI,KAAK,SAAS,GAAG,GAAG,GAAGA,IAAI,KAAK,MAAM,GAAG,EAAE,GAAG,GAAG,CAAC;EAChG,MAAMyB,MAAM,GAAGuH,QAAQ,CAACyF,WAAW,CAAC,CAAC,CAAC,CAAC,KAAKzO,IAAI,KAAK,SAAS,GAAG,GAAG,GAAGA,IAAI,KAAK,MAAM,GAAG,EAAE,GAAG,EAAE,CAAC;EAEjG,MAAME,MAAM,GAAGsP,iBAAiB,CAACzG,KAAK,EAAEtJ,OAAO,CAAC;EAChD,MAAMQ,aAAa,GAAGwQ,kBAAkB,CAAChR,OAAO,EAAEO,IAAI,CAAC;EAEvD,OAAO;IACHD,EAAE;IACFC,IAAI;IACJC,aAAa;IACbG,QAAQ,EAAE;MACNuK,OAAO,EAAE;QAAErJ,CAAC,EAAEkP,IAAI;QAAEjP,CAAC,EAAEgN,GAAG;QAAE/J,CAAC,EAAEwE,QAAQ,CAACD,KAAK,CAAC6G,MAAM,CAAC,IAAI;MAAG,CAAC;MAC7D5B,MAAM,EAAE1O,iBAAiB,CAAC;QAAEc,QAAQ,EAAE;UAAEuK,OAAO,EAAE;YAAErJ,CAAC,EAAEkP,IAAI;YAAEjP,CAAC,EAAEgN,GAAG;YAAE/J,CAAC,EAAEwE,QAAQ,CAACD,KAAK,CAAC6G,MAAM,CAAC,IAAI;UAAG;QAAE;MAAE,CAAC,EAAE,SAAS,EAAE,QAAQ,EAAE;QAAEpO,KAAK;QAAEC;MAAO,CAAC,CAAC;MAClJwM,MAAM,EAAE3O,iBAAiB,CAAC;QAAEc,QAAQ,EAAE;UAAEuK,OAAO,EAAE;YAAErJ,CAAC,EAAEkP,IAAI;YAAEjP,CAAC,EAAEgN,GAAG;YAAE/J,CAAC,EAAEwE,QAAQ,CAACD,KAAK,CAAC6G,MAAM,CAAC,IAAI;UAAG;QAAE;MAAE,CAAC,EAAE,SAAS,EAAE,QAAQ,EAAE;QAAEpO,KAAK;QAAEC;MAAO,CAAC;IACrJ,CAAC;IACDtB,IAAI,EAAE;MACFwK,OAAO,EAAE;QAAEnJ,KAAK;QAAEC;MAAO,CAAC;MAC1BuM,MAAM,EAAE3O,aAAa,CAAC;QAAEc,IAAI,EAAE;UAAEwK,OAAO,EAAE;YAAEnJ,KAAK;YAAEC;UAAO;QAAE;MAAE,CAAC,EAAE,SAAS,EAAE,QAAQ,CAAC;MACpFwM,MAAM,EAAE5O,aAAa,CAAC;QAAEc,IAAI,EAAE;UAAEwK,OAAO,EAAE;YAAEnJ,KAAK;YAAEC;UAAO;QAAE;MAAE,CAAC,EAAE,SAAS,EAAE,QAAQ;IACvF,CAAC;IACDvB,MAAM;IACNG,gBAAgB,EAAE;MACdsK,OAAO,EAAE,CAAC,CAAC;MACXqD,MAAM,EAAE5O,eAAe,CAACc,MAAM,EAAE,SAAS,EAAE,QAAQ,CAAC;MACpD+N,MAAM,EAAE7O,eAAe,CAACc,MAAM,EAAE,SAAS,EAAE,QAAQ;IACvD,CAAC;IACD+C,QAAQ,EAAE,EAAE;IACZnD,OAAO,EAAEiJ,KAAK,CAACxG,OAAO,KAAK,MAAM;IACjC2L,MAAM,EAAEzO,OAAO,CAACqP,SAAS,CAACC,QAAQ,CAAC,oBAAoB,CAAC;IACxDjK;EACJ,CAAC;AACL,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA,MAAM2L,kBAAkB,GAAGA,CAAChR,OAAO,EAAEO,IAAI,KAAK;EAC1C,MAAMC,aAAa,GAAG,CAAC,CAAC;EAExB,QAAQD,IAAI;IACR,KAAK,QAAQ;MACTC,aAAa,CAAC0B,OAAO,GAAGlC,OAAO,CAAC+H,WAAW,CAACC,IAAI,CAAC,CAAC,IAAI,QAAQ;MAC9DxH,aAAa,CAAC4D,UAAU,GAAGpE,OAAO,CAACsJ,KAAK,CAAClF,UAAU,IAAIpE,OAAO,CAACsJ,KAAK,CAAC3F,eAAe;MACpFnD,aAAa,CAAC6Q,KAAK,GAAGrR,OAAO,CAACsJ,KAAK,CAAC+H,KAAK;MACzC7Q,aAAa,CAAC0C,YAAY,GAAGlD,OAAO,CAACsJ,KAAK,CAACpG,YAAY;MACvD1C,aAAa,CAAC8Q,MAAM,GAAGtR,OAAO,CAACsJ,KAAK,CAACgI,MAAM;MAC3C9Q,aAAa,CAAC+Q,QAAQ,GAAGvR,OAAO,CAACsJ,KAAK,CAACiI,QAAQ;MAC/C/Q,aAAa,CAACgR,UAAU,GAAGxR,OAAO,CAACsJ,KAAK,CAACkI,UAAU;MACnD;IAEJ,KAAK,SAAS;MACVhR,aAAa,CAAC0B,OAAO,GAAGlC,OAAO,CAAC+H,WAAW,CAACC,IAAI,CAAC,CAAC,IAAI,SAAS;MAC/DxH,aAAa,CAAC4B,KAAK,GAAGpC,OAAO,CAACyR,OAAO,CAAChQ,WAAW,CAAC,CAAC;MACnDjB,aAAa,CAAC+Q,QAAQ,GAAGvR,OAAO,CAACsJ,KAAK,CAACiI,QAAQ;MAC/C/Q,aAAa,CAAC6Q,KAAK,GAAGrR,OAAO,CAACsJ,KAAK,CAAC+H,KAAK;MACzC7Q,aAAa,CAACgR,UAAU,GAAGxR,OAAO,CAACsJ,KAAK,CAACkI,UAAU;MACnDhR,aAAa,CAACkR,SAAS,GAAG1R,OAAO,CAACsJ,KAAK,CAACoI,SAAS;MACjD;IAEJ,KAAK,WAAW;MACZlR,aAAa,CAAC0B,OAAO,GAAGlC,OAAO,CAAC+H,WAAW,CAACC,IAAI,CAAC,CAAC,IAAI,WAAW;MACjExH,aAAa,CAAC+Q,QAAQ,GAAGvR,OAAO,CAACsJ,KAAK,CAACiI,QAAQ;MAC/C/Q,aAAa,CAAC6Q,KAAK,GAAGrR,OAAO,CAACsJ,KAAK,CAAC+H,KAAK;MACzC7Q,aAAa,CAACgR,UAAU,GAAGxR,OAAO,CAACsJ,KAAK,CAACkI,UAAU;MACnDhR,aAAa,CAACmR,UAAU,GAAG3R,OAAO,CAACsJ,KAAK,CAACqI,UAAU;MACnDnR,aAAa,CAACkR,SAAS,GAAG1R,OAAO,CAACsJ,KAAK,CAACoI,SAAS;MACjD;IAEJ,KAAK,OAAO;MACRlR,aAAa,CAAC6B,GAAG,GAAGrC,OAAO,CAACkI,YAAY,CAAC,KAAK,CAAC,IAAI,iCAAiC;MACpF1H,aAAa,CAAC+B,GAAG,GAAGvC,OAAO,CAACkI,YAAY,CAAC,KAAK,CAAC,IAAI,OAAO;MAC1D1H,aAAa,CAAC8B,QAAQ,GAAG9B,aAAa,CAAC6B,GAAG;MAC1C;IAEJ,KAAK,MAAM;MACP,MAAMuP,GAAG,GAAG5R,OAAO,CAAC8H,aAAa,CAAC,KAAK,CAAC;MACxC,MAAM+J,MAAM,GAAG7R,OAAO,CAAC8H,aAAa,CAAC,GAAG,CAAC;MACzC,MAAMgK,KAAK,GAAG9R,OAAO,CAAC8H,aAAa,CAAC,KAAK,CAAC;MAC1C,IAAI8J,GAAG,EAAE;QACLpR,aAAa,CAAC8B,QAAQ,GAAGsP,GAAG,CAAC1J,YAAY,CAAC,KAAK,CAAC;QAChD1H,aAAa,CAAC+B,GAAG,GAAGqP,GAAG,CAAC1J,YAAY,CAAC,KAAK,CAAC,IAAI,MAAM;MACzD,CAAC,MAAM,IAAI4J,KAAK,EAAE;QACdtR,aAAa,CAACiC,IAAI,GAAGqP,KAAK,CAACC,SAAS;MACxC,CAAC,MAAM,IAAIF,MAAM,EAAE;QACfrR,aAAa,CAACiC,IAAI,GAAGoP,MAAM,CAACG,SAAS;MACzC;MACAxR,aAAa,CAACkC,KAAK,GAAG1C,OAAO,CAACkI,YAAY,CAAC,OAAO,CAAC,IAAI,EAAE;MACzD;IAEJ,KAAK,SAAS;MACV,MAAMrF,MAAM,GAAG4C,KAAK,CAACwM,IAAI,CAACjS,OAAO,CAACyJ,gBAAgB,CAAC,KAAK,CAAC,CAAC,CAACrI,GAAG,CAACwQ,GAAG,IAAIA,GAAG,CAAC1J,YAAY,CAAC,KAAK,CAAC,IAAI,iCAAiC,CAAC;MACnI1H,aAAa,CAACqC,MAAM,GAAGA,MAAM;MAC7BrC,aAAa,CAACsC,OAAO,GAAG9C,OAAO,CAACsJ,KAAK,CAACxG,OAAO,IAAI,MAAM;MACvDtC,aAAa,CAACuC,mBAAmB,GAAG/C,OAAO,CAACsJ,KAAK,CAACvG,mBAAmB,IAAI,uCAAuC;MAChHvC,aAAa,CAACwC,GAAG,GAAGhD,OAAO,CAACsJ,KAAK,CAACtG,GAAG,IAAI,MAAM;MAC/C;IAEJ;MACIxC,aAAa,CAAC0B,OAAO,GAAGlC,OAAO,CAAC+H,WAAW,CAACC,IAAI,CAAC,CAAC,IAAI,EAAE;MACxD;EACR;;EAEA;EACA,IAAIhI,OAAO,CAACsJ,KAAK,CAAC4I,SAAS,EAAE;IACzB,MAAMC,cAAc,GAAGnS,OAAO,CAACsJ,KAAK,CAAC4I,SAAS,CAAC1J,KAAK,CAAC,8DAA8D,CAAC;IACpH,IAAI2J,cAAc,EAAE;MAChB3R,aAAa,CAAC0R,SAAS,GAAG;QACtB3R,IAAI,EAAE4R,cAAc,CAAC,CAAC,CAAC;QACvBC,QAAQ,EAAEvC,UAAU,CAACsC,cAAc,CAAC,CAAC,CAAC,CAAC,IAAI,IAAI;QAC/CE,MAAM,EAAEF,cAAc,CAAC,CAAC,CAAC,IAAI,MAAM;QACnCG,KAAK,EAAEzC,UAAU,CAACsC,cAAc,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC;QACzCI,MAAM,EAAE,CAAC,CAACJ,cAAc,CAAC,CAAC;MAC9B,CAAC;IACL;EACJ;EAEA,OAAO3R,aAAa;AACxB,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA,MAAMuP,iBAAiB,GAAGA,CAACyC,QAAQ,EAAExS,OAAO,KAAK;EAC7C,MAAMS,MAAM,GAAG,CAAC,CAAC;EACjB,MAAMgS,cAAc,GAAG,CACnB,YAAY,EAAE,iBAAiB,EAAE,iBAAiB,EAAE,gBAAgB,EAAE,oBAAoB,EAC1F,OAAO,EAAE,UAAU,EAAE,YAAY,EAAE,YAAY,EAC/C,QAAQ,EAAE,cAAc,EAAE,WAAW,EAAE,YAAY,EACnD,SAAS,EAAE,QAAQ,EAAE,YAAY,EAAE,cAAc,EAAE,eAAe,EAAE,aAAa,EACjF,WAAW,EAAE,aAAa,EAAE,cAAc,EAAE,YAAY,EACxD,SAAS,EAAE,YAAY,EAAE,gBAAgB,EAAE,eAAe,EAAE,KAAK,EACjE,qBAAqB,EAAE,kBAAkB,EAAE,SAAS,EACpD,WAAW,EAAE,YAAY,EAAE,eAAe,EAC1C,QAAQ,EAAE,YAAY,EAAE,WAAW,EAAE,QAAQ,EAC7C,QAAQ,EAAE,SAAS,EAAE,WAAW,EAAE,iBAAiB,EACnD,OAAO,EAAE,QAAQ,EAAE,UAAU,EAAE,WAAW,EAAE,UAAU,EAAE,WAAW,CACtE;EAEDA,cAAc,CAAC/N,OAAO,CAACgO,IAAI,IAAI;IAC3B,IAAIF,QAAQ,CAACE,IAAI,CAAC,EAAE;MAChBjS,MAAM,CAACiS,IAAI,CAAC,GAAGF,QAAQ,CAACE,IAAI,CAAC;IACjC;EACJ,CAAC,CAAC;;EAEF;EACA,MAAMrI,aAAa,GAAGrK,OAAO,CAAC2S,aAAa,CAAClJ,gBAAgB,CAAC,OAAO,CAAC;EACrEY,aAAa,CAAC3F,OAAO,CAAC4F,OAAO,IAAI;IAC7B,MAAM5D,UAAU,GAAG4D,OAAO,CAACvC,WAAW,IAAIuC,OAAO,CAAC1B,SAAS;IAC3D,MAAMgK,UAAU,GAAG,IAAIC,MAAM,CAAC,IAAI7S,OAAO,CAACM,EAAE,0BAA0B,CAAC;IACvE,MAAMwS,UAAU,GAAGpM,UAAU,CAAC8B,KAAK,CAACoK,UAAU,CAAC;IAC/C,IAAIE,UAAU,EAAE;MACZ,MAAMC,WAAW,GAAG,CAAC,CAAC;MACtBD,UAAU,CAAC,CAAC,CAAC,CAACzK,KAAK,CAAC,GAAG,CAAC,CAAC3D,OAAO,CAACsO,IAAI,IAAI;QACrC,MAAM,CAAC9R,GAAG,EAAEG,KAAK,CAAC,GAAG2R,IAAI,CAAC3K,KAAK,CAAC,GAAG,CAAC,CAACjH,GAAG,CAAC6R,CAAC,IAAIA,CAAC,CAACjL,IAAI,CAAC,CAAC,CAAC;QACvD,IAAI9G,GAAG,IAAIG,KAAK,EAAE;UACd,MAAM6R,QAAQ,GAAGhS,GAAG,CAACK,OAAO,CAAC,WAAW,EAAE,CAAC4R,CAAC,EAAEC,MAAM,KAAKA,MAAM,CAACC,WAAW,CAAC,CAAC,CAAC;UAC9EN,WAAW,CAACG,QAAQ,CAAC,GAAG7R,KAAK;QACjC;MACJ,CAAC,CAAC;MACF,IAAIN,MAAM,CAACuS,IAAI,CAACP,WAAW,CAAC,CAAC1P,MAAM,GAAG,CAAC,EAAE;QACrC5C,MAAM,CAAC,QAAQ,CAAC,GAAGsS,WAAW;MAClC;IACJ;EACJ,CAAC,CAAC;EAEF,OAAOtS,MAAM;AACjB,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA,MAAM0J,uBAAuB,GAAIoJ,aAAa,IAAK;EAC/C,MAAMC,WAAW,GAAGD,aAAa,CAAC/K,KAAK,CAAC,sCAAsC,CAAC;EAC/E,IAAIgL,WAAW,EAAE;IACb,IAAI;MACA,OAAO3N,IAAI,CAAC8C,KAAK,CAAC6K,WAAW,CAAC,CAAC,CAAC,CAAC;IACrC,CAAC,CAAC,OAAOC,CAAC,EAAE;MACR5K,OAAO,CAACG,IAAI,CAAC,gCAAgC,EAAEyK,CAAC,CAACvK,OAAO,CAAC;MACzD,OAAO,EAAE;IACb;EACJ;EACA,OAAO,EAAE;AACb,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA,MAAMkB,mBAAmB,GAAGA,CAAC5F,QAAQ,EAAE0F,YAAY,KAAK;EACpDA,YAAY,CAACxF,OAAO,CAACgP,WAAW,IAAI;IAChC,MAAM1T,OAAO,GAAG2T,eAAe,CAACnP,QAAQ,EAAEkP,WAAW,CAACnO,SAAS,CAAC;IAChE,IAAIvF,OAAO,EAAE;MACT,IAAI,CAACA,OAAO,CAACQ,aAAa,EAAE;QACxBR,OAAO,CAACQ,aAAa,GAAG,CAAC,CAAC;MAC9B;MACAR,OAAO,CAACQ,aAAa,CAAC2E,MAAM,GAAGuO,WAAW,CAACvO,MAAM,IAAI,CAAC,CAAC;IAC3D;EACJ,CAAC,CAAC;AACN,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA,MAAMqF,wBAAwB,GAAI9D,UAAU,IAAK;EAC7C,MAAM6D,UAAU,GAAG,CAAC,CAAC;EACrB,MAAMqJ,cAAc,GAAG,oCAAoC;EAC3D,IAAIpL,KAAK;EACT,OAAQA,KAAK,GAAGoL,cAAc,CAACC,IAAI,CAACnN,UAAU,CAAC,EAAG;IAC9C,MAAMoN,YAAY,GAAGtL,KAAK,CAAC,CAAC,CAAC;IAC7B,MAAMuL,aAAa,GAAGvL,KAAK,CAAC,CAAC,CAAC;IAC9B,MAAMwL,MAAM,GAAG,CAAC,CAAC;IACjB,MAAMC,UAAU,GAAG,gCAAgC;IACnD,IAAIC,UAAU;IACd,OAAQA,UAAU,GAAGD,UAAU,CAACJ,IAAI,CAACE,aAAa,CAAC,EAAG;MAClD,MAAMI,QAAQ,GAAGD,UAAU,CAAC,CAAC,CAAC;MAC9B,MAAME,KAAK,GAAG,CAAC,CAAC;MAChBF,UAAU,CAAC,CAAC,CAAC,CAAC7L,KAAK,CAAC,GAAG,CAAC,CAAC3D,OAAO,CAACsO,IAAI,IAAI;QACrC,MAAM,CAAC9R,GAAG,EAAEG,KAAK,CAAC,GAAG2R,IAAI,CAAC3K,KAAK,CAAC,GAAG,CAAC,CAACjH,GAAG,CAAC6R,CAAC,IAAIA,CAAC,CAACjL,IAAI,CAAC,CAAC,CAAC;QACvD,IAAI9G,GAAG,IAAIG,KAAK,EAAE;UACd,MAAM6R,QAAQ,GAAGhS,GAAG,CAACK,OAAO,CAAC,WAAW,EAAE,CAAC4R,CAAC,EAAEC,MAAM,KAAKA,MAAM,CAACC,WAAW,CAAC,CAAC,CAAC;UAC9Ee,KAAK,CAAClB,QAAQ,CAAC,GAAG7R,KAAK;QAC3B;MACJ,CAAC,CAAC;MACF2S,MAAM,CAACG,QAAQ,CAAC,GAAGC,KAAK;IAC5B;IACA7J,UAAU,CAAC,cAAcuJ,YAAY,EAAE,CAAC,GAAGE,MAAM;EACrD;EACA,OAAOzJ,UAAU;AACrB,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA,MAAME,uBAAuB,GAAGA,CAACjG,QAAQ,EAAE+F,UAAU,KAAK;EACtD/F,QAAQ,CAACE,OAAO,CAAC1E,OAAO,IAAI;IAAA,IAAAqU,eAAA,EAAAC,iBAAA;IACxB,KAAAD,eAAA,GAAIrU,OAAO,CAACS,MAAM,cAAA4T,eAAA,eAAdA,eAAA,CAAgBnC,SAAS,EAAE;MAC3B,MAAMC,cAAc,GAAGnS,OAAO,CAACS,MAAM,CAACyR,SAAS,CAAC1J,KAAK,CAAC,8DAA8D,CAAC;MACrH,IAAI2J,cAAc,EAAE;QAChBnS,OAAO,CAACQ,aAAa,CAAC0R,SAAS,GAAG;UAC9B3R,IAAI,EAAE4R,cAAc,CAAC,CAAC,CAAC;UACvBC,QAAQ,EAAEvC,UAAU,CAACsC,cAAc,CAAC,CAAC,CAAC,CAAC,IAAI,IAAI;UAC/CE,MAAM,EAAEF,cAAc,CAAC,CAAC,CAAC,IAAI,MAAM;UACnCG,KAAK,EAAEzC,UAAU,CAACsC,cAAc,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC;UACzCI,MAAM,EAAE,CAAC,CAACJ,cAAc,CAAC,CAAC;QAC9B,CAAC;MACL;IACJ;IACA,IAAInS,OAAO,CAACS,MAAM,IAAI8J,UAAU,CAAC,cAAcvK,OAAO,CAACS,MAAM,CAAC8T,aAAa,EAAE,CAAC,EAAE;MAC5EvU,OAAO,CAACS,MAAM,CAAC,cAAcT,OAAO,CAACS,MAAM,CAAC8T,aAAa,EAAE,CAAC,GAAGhK,UAAU,CAAC,cAAcvK,OAAO,CAACS,MAAM,CAAC8T,aAAa,EAAE,CAAC;IAC3H;IACA,IAAI,EAAAD,iBAAA,GAAAtU,OAAO,CAACwD,QAAQ,cAAA8Q,iBAAA,uBAAhBA,iBAAA,CAAkBjR,MAAM,IAAG,CAAC,EAAE;MAC9BoH,uBAAuB,CAACzK,OAAO,CAACwD,QAAQ,EAAE+G,UAAU,CAAC;IACzD;EACJ,CAAC,CAAC;AACN,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA,MAAMoJ,eAAe,GAAGA,CAACnP,QAAQ,EAAElE,EAAE,KAAK;EACtC,KAAK,MAAMN,OAAO,IAAIwE,QAAQ,EAAE;IAC5B,IAAIxE,OAAO,CAACM,EAAE,KAAKA,EAAE,EAAE,OAAON,OAAO;IAErC,IAAIA,OAAO,CAACwD,QAAQ,IAAIxD,OAAO,CAACwD,QAAQ,CAACH,MAAM,GAAG,CAAC,EAAE;MACjD,MAAMmR,KAAK,GAAGb,eAAe,CAAC3T,OAAO,CAACwD,QAAQ,EAAElD,EAAE,CAAC;MACnD,IAAIkU,KAAK,EAAE,OAAOA,KAAK;IAC3B;EACJ;EACA,OAAO,IAAI;AACf,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA,MAAM3D,oBAAoB,GAAI7Q,OAAO,IAAK;EACtC,MAAMyR,OAAO,GAAGzR,OAAO,CAACyR,OAAO,CAAChQ,WAAW,CAAC,CAAC;EAC7C,MAAM4N,SAAS,GAAGrP,OAAO,CAACqP,SAAS;EAEnC,IAAIA,SAAS,CAACC,QAAQ,CAAC,YAAY,CAAC,IAAImC,OAAO,KAAK,QAAQ,EAAE,OAAO,QAAQ;EAC7E,IAAIpC,SAAS,CAACC,QAAQ,CAAC,UAAU,CAAC,EAAE,OAAO,MAAM;EACjD,IAAID,SAAS,CAACC,QAAQ,CAAC,aAAa,CAAC,EAAE,OAAO,SAAS;EACvD,IAAID,SAAS,CAACC,QAAQ,CAAC,aAAa,CAAC,IAAID,SAAS,CAACC,QAAQ,CAAC,cAAc,CAAC,EAAE,OAAO,SAAS;EAC7F,IAAID,SAAS,CAACC,QAAQ,CAAC,WAAW,CAAC,EAAE,OAAO,OAAO;EACnD,IAAImC,OAAO,CAACjJ,KAAK,CAAC,UAAU,CAAC,EAAE,OAAO,SAAS;EAC/C,IAAIiJ,OAAO,KAAK,GAAG,EAAE,OAAO,WAAW;EACvC,IAAIA,OAAO,KAAK,KAAK,EAAE,OAAO,OAAO;EACrC,IAAIA,OAAO,KAAK,IAAI,EAAE,OAAO,SAAS;EACtC,IAAIA,OAAO,KAAK,MAAM,EAAE,OAAO,MAAM;EACrC,IAAIA,OAAO,KAAK,IAAI,IAAIA,OAAO,KAAK,IAAI,EAAE,OAAO,MAAM;EACvD,OAAO,WAAW;AACtB,CAAC;AAED,eAAe;EACX1L,gBAAgB;EAChBmB,mBAAmB;EACnBqE,UAAU;EACV2B,aAAa;EACbnN,iBAAiB;EACjBiE,gBAAgB;EAChB/B,iBAAiB;EACjBU,iBAAiB;EACjB0B,WAAW;EACXa,aAAa;EACbU,oBAAoB;EACpBmD,iBAAiB;EACjBY,mBAAmB;EACnBE,iBAAiB;EACjBE,sBAAsB;EACtBmG,iBAAiB;EACjBc,kBAAkB;EAClBjB,iBAAiB;EACjB5F,uBAAuB;EACvBC,mBAAmB;EACnBI,wBAAwB;EACxBC,uBAAuB;EACvBkJ,eAAe;EACf9C;AACJ,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}