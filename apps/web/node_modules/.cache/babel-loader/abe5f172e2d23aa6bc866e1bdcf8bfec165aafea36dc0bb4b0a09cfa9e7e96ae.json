{"ast":null,"code":"var _s = $RefreshSig$();\n// src/components/CozeChat.js\n\nimport React, { useEffect, useRef } from 'react';\n\n// --- Hằng số ---\nconst COZE_BOT_ID = '7564406577911463952';\nconst YOUR_COZE_PAT_TOKEN = 'pat_FrrZbPVDVnwl97NleYEMsc9RxKvggAuykeygC0NCI9nSB1ltKbRQD3kGzve6vjgq';\nconst COZE_SCRIPT_ID = 'coze-web-sdk-script'; // Đặt ID cho thẻ script để dễ kiểm tra\n\nconst CozeChat = () => {\n  _s();\n  // Dùng useRef để lưu lại instance của chat client, nó sẽ không bị reset giữa các lần render\n  const clientRef = useRef(null);\n  useEffect(() => {\n    // --- Hàm này sẽ khởi tạo chat client ---\n    const initializeChat = () => {\n      // Chỉ khởi tạo nếu window.CozeWebSDK đã tồn tại và chưa có client nào được tạo\n      if (window.CozeWebSDK && !clientRef.current) {\n        clientRef.current = new window.CozeWebSDK.WebChatClient({\n          config: {\n            bot_id: COZE_BOT_ID\n          },\n          componentProps: {\n            title: 'LandingHub Assistant',\n            description: 'Trợ lý AI của bạn'\n          },\n          auth: {\n            type: 'token',\n            token: YOUR_COZE_PAT_TOKEN\n            // onRefreshToken không cần thiết nếu token của bạn không hết hạn\n          }\n        });\n      }\n    };\n\n    // --- Hàm này chịu trách nhiệm tải script từ bên ngoài ---\n    const loadScript = () => {\n      // Nếu script đã được tải rồi thì chỉ cần khởi tạo chat thôi, không cần tải lại\n      if (document.getElementById(COZE_SCRIPT_ID)) {\n        initializeChat();\n        return;\n      }\n      const script = document.createElement('script');\n      script.id = COZE_SCRIPT_ID;\n      script.src = \"https://sf-cdn.coze.com/obj/unpkg-va/flow-platform/chat-app-sdk/1.2.0-beta.6/libs/oversea/index.js\";\n      script.async = true;\n      script.onload = initializeChat; // Sau khi tải script thành công, gọi hàm khởi tạo chat\n\n      document.body.appendChild(script);\n    };\n    loadScript();\n\n    // --- Đây là hàm DỌN DẸP, nó sẽ chạy khi component bị \"unmount\" (ví dụ: khi bạn chuyển trang) ---\n    return () => {\n      // Kiểm tra xem client đã được tạo và có phương thức destroy không\n      if (clientRef.current && typeof clientRef.current.destroy === 'function') {\n        clientRef.current.destroy(); // Gọi hàm hủy của SDK để dọn dẹp triệt để\n      }\n\n      // Xóa DOM element cho chắc chắn\n      const chatWidget = document.querySelector('.web-chat-sdk-container');\n      if (chatWidget) {\n        chatWidget.parentElement.removeChild(chatWidget);\n      }\n      clientRef.current = null; // Reset ref để lần sau có thể tạo mới\n    };\n  }, []); // Dependency rỗng [] đảm bảo logic này chỉ chạy khi component mount và unmount\n\n  return null; // Component này không render ra gì cả, nó chỉ quản lý widget\n};\n_s(CozeChat, \"PMID0r5nDf9+pnMAo/w74pBuAKA=\");\n_c = CozeChat;\nexport default CozeChat;\nvar _c;\n$RefreshReg$(_c, \"CozeChat\");","map":{"version":3,"names":["React","useEffect","useRef","COZE_BOT_ID","YOUR_COZE_PAT_TOKEN","COZE_SCRIPT_ID","CozeChat","_s","clientRef","initializeChat","window","CozeWebSDK","current","WebChatClient","config","bot_id","componentProps","title","description","auth","type","token","loadScript","document","getElementById","script","createElement","id","src","async","onload","body","appendChild","destroy","chatWidget","querySelector","parentElement","removeChild","_c","$RefreshReg$"],"sources":["D:/landing-hub/apps/web/src/components/CozeChat.js"],"sourcesContent":["// src/components/CozeChat.js\r\n\r\nimport React, { useEffect, useRef } from 'react';\r\n\r\n// --- Hằng số ---\r\nconst COZE_BOT_ID = '7564406577911463952';\r\nconst YOUR_COZE_PAT_TOKEN = 'pat_FrrZbPVDVnwl97NleYEMsc9RxKvggAuykeygC0NCI9nSB1ltKbRQD3kGzve6vjgq';\r\nconst COZE_SCRIPT_ID = 'coze-web-sdk-script'; // Đặt ID cho thẻ script để dễ kiểm tra\r\n\r\nconst CozeChat = () => {\r\n    // Dùng useRef để lưu lại instance của chat client, nó sẽ không bị reset giữa các lần render\r\n    const clientRef = useRef(null);\r\n\r\n    useEffect(() => {\r\n        // --- Hàm này sẽ khởi tạo chat client ---\r\n        const initializeChat = () => {\r\n            // Chỉ khởi tạo nếu window.CozeWebSDK đã tồn tại và chưa có client nào được tạo\r\n            if (window.CozeWebSDK && !clientRef.current) {\r\n                clientRef.current = new window.CozeWebSDK.WebChatClient({\r\n                    config: {\r\n                        bot_id: COZE_BOT_ID,\r\n                    },\r\n                    componentProps: {\r\n                        title: 'LandingHub Assistant',\r\n                        description: 'Trợ lý AI của bạn',\r\n                    },\r\n                    auth: {\r\n                        type: 'token',\r\n                        token: YOUR_COZE_PAT_TOKEN,\r\n                        // onRefreshToken không cần thiết nếu token của bạn không hết hạn\r\n                    }\r\n                });\r\n            }\r\n        };\r\n\r\n        // --- Hàm này chịu trách nhiệm tải script từ bên ngoài ---\r\n        const loadScript = () => {\r\n            // Nếu script đã được tải rồi thì chỉ cần khởi tạo chat thôi, không cần tải lại\r\n            if (document.getElementById(COZE_SCRIPT_ID)) {\r\n                initializeChat();\r\n                return;\r\n            }\r\n\r\n            const script = document.createElement('script');\r\n            script.id = COZE_SCRIPT_ID;\r\n            script.src = \"https://sf-cdn.coze.com/obj/unpkg-va/flow-platform/chat-app-sdk/1.2.0-beta.6/libs/oversea/index.js\";\r\n            script.async = true;\r\n            script.onload = initializeChat; // Sau khi tải script thành công, gọi hàm khởi tạo chat\r\n\r\n            document.body.appendChild(script);\r\n        };\r\n\r\n        loadScript();\r\n\r\n        // --- Đây là hàm DỌN DẸP, nó sẽ chạy khi component bị \"unmount\" (ví dụ: khi bạn chuyển trang) ---\r\n        return () => {\r\n            // Kiểm tra xem client đã được tạo và có phương thức destroy không\r\n            if (clientRef.current && typeof clientRef.current.destroy === 'function') {\r\n                clientRef.current.destroy(); // Gọi hàm hủy của SDK để dọn dẹp triệt để\r\n            }\r\n\r\n            // Xóa DOM element cho chắc chắn\r\n            const chatWidget = document.querySelector('.web-chat-sdk-container');\r\n            if (chatWidget) {\r\n                chatWidget.parentElement.removeChild(chatWidget);\r\n            }\r\n\r\n            clientRef.current = null; // Reset ref để lần sau có thể tạo mới\r\n        };\r\n    }, []); // Dependency rỗng [] đảm bảo logic này chỉ chạy khi component mount và unmount\r\n\r\n    return null; // Component này không render ra gì cả, nó chỉ quản lý widget\r\n};\r\n\r\nexport default CozeChat;"],"mappings":";AAAA;;AAEA,OAAOA,KAAK,IAAIC,SAAS,EAAEC,MAAM,QAAQ,OAAO;;AAEhD;AACA,MAAMC,WAAW,GAAG,qBAAqB;AACzC,MAAMC,mBAAmB,GAAG,sEAAsE;AAClG,MAAMC,cAAc,GAAG,qBAAqB,CAAC,CAAC;;AAE9C,MAAMC,QAAQ,GAAGA,CAAA,KAAM;EAAAC,EAAA;EACnB;EACA,MAAMC,SAAS,GAAGN,MAAM,CAAC,IAAI,CAAC;EAE9BD,SAAS,CAAC,MAAM;IACZ;IACA,MAAMQ,cAAc,GAAGA,CAAA,KAAM;MACzB;MACA,IAAIC,MAAM,CAACC,UAAU,IAAI,CAACH,SAAS,CAACI,OAAO,EAAE;QACzCJ,SAAS,CAACI,OAAO,GAAG,IAAIF,MAAM,CAACC,UAAU,CAACE,aAAa,CAAC;UACpDC,MAAM,EAAE;YACJC,MAAM,EAAEZ;UACZ,CAAC;UACDa,cAAc,EAAE;YACZC,KAAK,EAAE,sBAAsB;YAC7BC,WAAW,EAAE;UACjB,CAAC;UACDC,IAAI,EAAE;YACFC,IAAI,EAAE,OAAO;YACbC,KAAK,EAAEjB;YACP;UACJ;QACJ,CAAC,CAAC;MACN;IACJ,CAAC;;IAED;IACA,MAAMkB,UAAU,GAAGA,CAAA,KAAM;MACrB;MACA,IAAIC,QAAQ,CAACC,cAAc,CAACnB,cAAc,CAAC,EAAE;QACzCI,cAAc,CAAC,CAAC;QAChB;MACJ;MAEA,MAAMgB,MAAM,GAAGF,QAAQ,CAACG,aAAa,CAAC,QAAQ,CAAC;MAC/CD,MAAM,CAACE,EAAE,GAAGtB,cAAc;MAC1BoB,MAAM,CAACG,GAAG,GAAG,oGAAoG;MACjHH,MAAM,CAACI,KAAK,GAAG,IAAI;MACnBJ,MAAM,CAACK,MAAM,GAAGrB,cAAc,CAAC,CAAC;;MAEhCc,QAAQ,CAACQ,IAAI,CAACC,WAAW,CAACP,MAAM,CAAC;IACrC,CAAC;IAEDH,UAAU,CAAC,CAAC;;IAEZ;IACA,OAAO,MAAM;MACT;MACA,IAAId,SAAS,CAACI,OAAO,IAAI,OAAOJ,SAAS,CAACI,OAAO,CAACqB,OAAO,KAAK,UAAU,EAAE;QACtEzB,SAAS,CAACI,OAAO,CAACqB,OAAO,CAAC,CAAC,CAAC,CAAC;MACjC;;MAEA;MACA,MAAMC,UAAU,GAAGX,QAAQ,CAACY,aAAa,CAAC,yBAAyB,CAAC;MACpE,IAAID,UAAU,EAAE;QACZA,UAAU,CAACE,aAAa,CAACC,WAAW,CAACH,UAAU,CAAC;MACpD;MAEA1B,SAAS,CAACI,OAAO,GAAG,IAAI,CAAC,CAAC;IAC9B,CAAC;EACL,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC;;EAER,OAAO,IAAI,CAAC,CAAC;AACjB,CAAC;AAACL,EAAA,CA/DID,QAAQ;AAAAgC,EAAA,GAARhC,QAAQ;AAiEd,eAAeA,QAAQ;AAAC,IAAAgC,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}